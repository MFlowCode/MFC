<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_data_output.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__data__output_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_data_output.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__data__output_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespacem__data__output.html">   41</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__data__output.html">m_data_output</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">!  Dependencies ============================================================</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a>            !&lt; message passing interface (mpi) module proxy</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a> !&lt; state variables type conversion procedures</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__compile__specific.html">m_compile_specific</a></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a>  , &amp;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                       <a class="code" href="namespacem__data__output.html#a050b4b01f11c1d352f55b46b6514634d">s_open_run_time_information_file</a> , &amp;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                       <a class="code" href="namespacem__data__output.html#a36714d4cf746d5beb2736752fdd6d747">s_open_com_files</a>                 , &amp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                       <a class="code" href="namespacem__data__output.html#a411af1336ca1bc899d3b7352d9383a81">s_open_cb_files</a>                  , &amp;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                       <a class="code" href="namespacem__data__output.html#af469c3d867d96eb1ca255832e586ec97">s_open_probe_files</a>               , &amp;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                       <a class="code" href="namespacem__data__output.html#a33a72559ec5cfdedf7162a8269d41201">s_write_run_time_information</a>     , &amp;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                       <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a>               , &amp;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                       <a class="code" href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">s_write_serial_data_files</a>        , &amp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                       <a class="code" href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75">s_write_parallel_data_files</a>      , &amp;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                       <a class="code" href="namespacem__data__output.html#a6be3381410dd028014de2c1d02b05139">s_write_com_files</a>                , &amp;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                       <a class="code" href="namespacem__data__output.html#a40724c992117a24479573d9fbcdfa21b">s_write_cb_files</a>                 , &amp;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                       <a class="code" href="namespacem__data__output.html#a29f34883bc8e9d895dbb4232493397a1">s_write_probe_files</a>              , &amp;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                       <a class="code" href="namespacem__data__output.html#a390239a7390ec5d07e31298573bf09bf">s_close_run_time_information_file</a>, &amp;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                       <a class="code" href="namespacem__data__output.html#a5646b1076ff72b2260ebefa3f44d4754">s_close_com_files</a>                , &amp;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                       <a class="code" href="namespacem__data__output.html#aa0eb8be31f69888d750e18df197c6011">s_close_cb_files</a>                 , &amp;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                       <a class="code" href="namespacem__data__output.html#a4036cc239adda35d59422a3e61bb657e">s_close_probe_files</a>              , &amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                       <a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    abstract <span class="keyword">INTERFACE</span> <span class="comment">! ===================================================</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="interfacem__data__output_1_1s__write__abstract__data__files.html">   82</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a>(q_cons_vf, t_step)</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="interfacem__data__output_1_1s__write__abstract__data__files.html#a8fac1f3a38f748b6cb921332855ce9c7">   83</a></span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordtype">IMPORT </span>:: <a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a> <span class="comment">! -------------------</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">    END INTERFACE </span><span class="comment">! ========================================================</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">   96</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">   97</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">   98</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">   99</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> ::   <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    </div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">  103</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">icfl_max</a></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">  104</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">vcfl_max</a></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">  105</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">ccfl_max</a></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">  106</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> ::   <a class="code" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">rc_min</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">! @name Generic storage for flow variable(s) that are to be written to CoM data file</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a1ccababc9891f8a719df1c52b49e969a">  111</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>  :: <a class="code" href="namespacem__data__output.html#a1ccababc9891f8a719df1c52b49e969a">accel_mag</a> </div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#ac5b476661d64159fdcd7364715495f30">  112</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>    :: <a class="code" href="namespacem__data__output.html#ac5b476661d64159fdcd7364715495f30">q_com</a></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#abd8505e33c0dce0f0aba7e27ae53bef5">  113</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>  :: <a class="code" href="namespacem__data__output.html#abd8505e33c0dce0f0aba7e27ae53bef5">moments</a></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a775b8128a9261b4d095f9132508d309f">  114</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>    :: <a class="code" href="namespacem__data__output.html#a775b8128a9261b4d095f9132508d309f">cb_mass</a></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a1e7a93a0d32bbc7c691381689771b6f9">  115</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>  :: <a class="code" href="namespacem__data__output.html#a1e7a93a0d32bbc7c691381689771b6f9">bounds</a></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a4f2a6c0ed44fb82d337013e700479ce5">  116</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>    :: <a class="code" href="namespacem__data__output.html#a4f2a6c0ed44fb82d337013e700479ce5">cntrline</a></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#aef4cabc25090173d5817782631af2781">  117</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">PUBLIC</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>  :: <a class="code" href="namespacem__data__output.html#ac465283e56b508af6500bea1ad4c745c">x_accel</a>, <a class="code" href="namespacem__data__output.html#a9170ca95f1f4493fd30a48052ed214a7">y_accel</a>, <a class="code" href="namespacem__data__output.html#aef4cabc25090173d5817782631af2781">z_accel</a></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">  118</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>           :: <a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>,<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>,<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>,<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>,<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">  119</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>  :: <a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">  123</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__data__output_1_1s__write__abstract__data__files.html">s_write_abstract_data_files</a>), <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; null()</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a050b4b01f11c1d352f55b46b6514634d">s_open_run_time_information_file</a>() <span class="comment">! ------------------------</span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a050b4b01f11c1d352f55b46b6514634d">  136</a></span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">CHARACTER(LEN = name_len)</span> :: dir_name</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordtype">CHARACTER(LEN = name_len)</span> :: file_name = <span class="stringliteral">&#39;run_time.inf&#39;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len + name_len)</span> :: file_path</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordtype">CHARACTER(LEN = 8)</span> :: file_date</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordtype">LOGICAL</span> :: file_exist</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="comment">! Opening the run-time information file</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/&#39;</span> // trim(file_name)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keyword">INQUIRE</span>(file = trim(file_path), exist = file_exist)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keyword">OPEN</span>(1, file     = trim(file_path), &amp;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    form     = <span class="stringliteral">&#39;formatted&#39;</span>    , &amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    position = <span class="stringliteral">&#39;append&#39;</span>       , &amp;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    status   = <span class="stringliteral">&#39;unknown&#39;</span>        )</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">! Generating file header for a new run-time information file</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">IF</span>(file_exist .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;basename `pwd` &gt; dir_name&#39;</span>)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                </div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/dir_name&#39;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keyword">OPEN</span>(2, file   = trim(file_path), &amp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        form   = <span class="stringliteral">&#39;formatted&#39;</span>    , &amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        status = <span class="stringliteral">&#39;old&#39;</span>            )</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keyword">READ</span>(2,<span class="stringliteral">&#39;(A)&#39;</span>) dir_name; <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;rm -f dir_name&#39;</span>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;MFC - Case - &#39;</span> // trim( dir_name) // &amp;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                                <span class="stringliteral">&#39;: &#39;</span> // trim(file_name)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>)     <span class="stringliteral">&#39;Description: Stability information at &#39;</span> // &amp;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                   <span class="stringliteral">&#39;each time-step of the simulation. This&#39;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,A)&#39;</span>) <span class="stringliteral">&#39;data is composed of the inviscid &#39;</span>      // &amp;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                   <span class="stringliteral">&#39;Courant–Friedrichs–Lewy (ICFL)&#39;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,A)&#39;</span>) <span class="stringliteral">&#39;number, the viscous CFL (VCFL) number, &#39;</span>// &amp;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                   <span class="stringliteral">&#39;the capillary CFL (CCFL)&#39;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,A)&#39;</span>) <span class="stringliteral">&#39;number and the cell Reynolds (Rc) &#39;</span>     // &amp;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                   <span class="stringliteral">&#39;number. Please note that only&#39;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,A)&#39;</span>) <span class="stringliteral">&#39;those stability conditions pertinent &#39;</span>  // &amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                   <span class="stringliteral">&#39;to the physics included in&#39;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,A)&#39;</span>) <span class="stringliteral">&#39;the current computation are displayed.&#39;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keyword">CALL </span>date_and_time(date = file_date)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Date: &#39;</span> // file_date(5:6) // <span class="stringliteral">&#39;/&#39;</span> // &amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                           file_date(7:8) // <span class="stringliteral">&#39;/&#39;</span> // &amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                           file_date(3:4)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            </div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;&#39;</span>; <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="comment">! Generating table header for the stability criteria to be outputted</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .AND. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;== Time-steps ==== Time ===== ICFL Max == &#39;</span> // &amp;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                               <span class="stringliteral">&#39;VCFL Max == CCFL Max ==== Rc Min =====&#39;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">ELSEIF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;==== Time-steps ====== Time ======= ICFL &#39;</span>  // &amp;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                               <span class="stringliteral">&#39;Max ==== VCFL Max ====== Rc Min =======&#39;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;======= Time-steps ========= Time &#39;</span>         // &amp;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                               <span class="stringliteral">&#39;========== ICFL Max ======= CCFL &#39;</span>          // &amp;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                               <span class="stringliteral">&#39;Max =========&#39;</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=========== Time-steps ============== Time &#39;</span>// &amp;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                               <span class="stringliteral">&#39;============== ICFL Max =============&#39;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a050b4b01f11c1d352f55b46b6514634d">s_open_run_time_information_file</a> <span class="comment">! ----------------------</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a36714d4cf746d5beb2736752fdd6d747">s_open_com_files</a>() <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a36714d4cf746d5beb2736752fdd6d747">  227</a></span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len  + 3*name_len)</span> :: file_path</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>(i)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <span class="comment">! Generating the relative path to the CoM data file</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;/fluid&#39;</span>,i,<span class="stringliteral">&#39;_com.dat&#39;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(file_path)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <span class="comment">! Creating the formatted data file and setting up its</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <span class="comment">! structure</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <span class="keyword">OPEN</span>(i+10, file = trim(file_path), &amp;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                        form = <span class="stringliteral">&#39;formatted&#39;</span>, &amp;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        position = <span class="stringliteral">&#39;append&#39;</span>, &amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                        status   = <span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel &#39;</span> // &amp;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                     <span class="stringliteral">&#39;=== Higher Moments ===&#39;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel ===&#39;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                     <span class="stringliteral">&#39;=== y-loc &#39;</span> // &amp;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                     <span class="stringliteral">&#39;=== y-vel &#39;</span> // &amp;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel &#39;</span> // &amp;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                     <span class="stringliteral">&#39;=== y-accel &#39;</span> // &amp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                     <span class="stringliteral">&#39;=== Higher Moments ===&#39;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                     <span class="stringliteral">&#39;=== y-loc &#39;</span> // &amp;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                     <span class="stringliteral">&#39;=== y-vel &#39;</span> // &amp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel &#39;</span> // &amp;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                     <span class="stringliteral">&#39;=== y-accel ===&#39;</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                     <span class="stringliteral">&#39;=== y-loc &#39;</span> // &amp;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                     <span class="stringliteral">&#39;=== z-loc &#39;</span> // &amp;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                     <span class="stringliteral">&#39;=== y-vel &#39;</span> // &amp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                     <span class="stringliteral">&#39;=== z-vel &#39;</span> // &amp;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel &#39;</span> // &amp;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                     <span class="stringliteral">&#39;=== y-accel &#39;</span> // &amp;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                     <span class="stringliteral">&#39;=== z-accel &#39;</span> // &amp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                     <span class="stringliteral">&#39;=== Higher Moments ===&#39;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            <span class="keyword">WRITE</span>(i+10,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                     <span class="stringliteral">&#39;=== Total Mass &#39;</span> // &amp;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                     <span class="stringliteral">&#39;=== x-loc &#39;</span> // &amp;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                     <span class="stringliteral">&#39;=== y-loc &#39;</span> // &amp;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                     <span class="stringliteral">&#39;=== z-loc &#39;</span> // &amp;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                     <span class="stringliteral">&#39;=== x-vel &#39;</span> // &amp;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                     <span class="stringliteral">&#39;=== y-vel &#39;</span> // &amp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                     <span class="stringliteral">&#39;=== z-vel &#39;</span> // &amp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                     <span class="stringliteral">&#39;=== x-accel &#39;</span> // &amp;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                     <span class="stringliteral">&#39;=== y-accel &#39;</span> // &amp;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                     <span class="stringliteral">&#39;=== z-accel ===&#39;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a36714d4cf746d5beb2736752fdd6d747">s_open_com_files</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a411af1336ca1bc899d3b7352d9383a81">s_open_cb_files</a>() <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a411af1336ca1bc899d3b7352d9383a81">  324</a></span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len  + 3*name_len)</span> :: file_path</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">cb_wrt</a>(i)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    <span class="comment">! Generating the relative path to the cb data file</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;/fluid&#39;</span>,i,<span class="stringliteral">&#39;_cb.dat&#39;</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(file_path)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    <span class="comment">! Creating the formatted data file and setting up its</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    <span class="comment">! structure</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    <span class="keyword">OPEN</span>(i+20, file = trim(file_path), &amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        form = <span class="stringliteral">&#39;formatted&#39;</span>, &amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        position = <span class="stringliteral">&#39;append&#39;</span>, &amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        status   = <span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;=== Non-Dimensional Time &#39;</span> // &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                     <span class="stringliteral">&#39;=== Coherent Body Mass &#39;</span> // &amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                     <span class="stringliteral">&#39;=== Coherent Body Area &#39;</span> // &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                     <span class="stringliteral">&#39;=== Bounds &#39;</span> // &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                     <span class="stringliteral">&#39;=== Centerline ===&#39;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a411af1336ca1bc899d3b7352d9383a81">s_open_cb_files</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#af469c3d867d96eb1ca255832e586ec97">s_open_probe_files</a>() <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#af469c3d867d96eb1ca255832e586ec97">  362</a></span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len + 3*name_len)</span> :: file_path</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aa4e0d015d4064b37e132c5088089394d">num_probes</a></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="comment">! Generating the relative path to the data file</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;/D/probe&#39;</span>,i,<span class="stringliteral">&#39;_prim.dat&#39;</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(file_path)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="comment">! Creating the formatted data file and setting up its</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="comment">! structure</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="keyword">OPEN</span>(i+30, file = trim(file_path), &amp;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    form = <span class="stringliteral">&#39;formatted&#39;</span>, &amp;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    position = <span class="stringliteral">&#39;append&#39;</span>, &amp;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    status   = <span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="comment">!WRITE(i+30,&#39;(A,I0,A)&#39;) &#39;Probe &#39;,i, &#39; located at:&#39;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="comment">!WRITE(i+30,&#39;(A,F10.6)&#39;) &#39;x = &#39;,probe(i)%x</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="comment">!WRITE(i+30,&#39;(A,F10.6)&#39;) &#39;y = &#39;,probe(i)%y</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="comment">!WRITE(i+30,&#39;(A,F10.6)&#39;) &#39;z = &#39;,probe(i)%z</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="comment">!WRITE(i+30, *)</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="comment">!WRITE(i+30,&#39;(A)&#39;) &#39;=== Non-Dimensional Time &#39; // &amp;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="comment">!                &#39;=== Density &#39; // &amp;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="comment">!                &#39;=== Velocity &#39; // &amp;</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="comment">!                &#39;=== Pressure &#39; // &amp;</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="comment">!                &#39;=== Gamma &#39; // &amp;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="comment">!                &#39;=== Stiffness &#39; // &amp;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="comment">!                &#39;=== Sound Speed &#39; // &amp;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="comment">!                &#39;=== Acceleration ===&#39;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a530bdd6416ce213046d14488fb48dbc2">integral_wrt</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a7a86e6e9d4c8b59d28b7404d836fdee8">num_integrals</a></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;/D/integral&#39;</span>,i,<span class="stringliteral">&#39;_prim.dat&#39;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                file_path = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // trim(file_path)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keyword">OPEN</span>(i+70, file = trim(file_path), &amp;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    form = <span class="stringliteral">&#39;formatted&#39;</span>, &amp;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    position = <span class="stringliteral">&#39;append&#39;</span>, &amp;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    status   = <span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">            end IF</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#af469c3d867d96eb1ca255832e586ec97">s_open_probe_files</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a33a72559ec5cfdedf7162a8269d41201">s_write_run_time_information</a>(q_prim_vf, t_step) <span class="comment">! -----------</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a33a72559ec5cfdedf7162a8269d41201">  421</a></span>&#160;           </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            </div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(cont_idx%end)</span>          :: alpha_rho</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: rho</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>              :: vel</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: pres</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            :: alpha</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: gamma</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: pi_inf</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: c</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                     :: Re</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> :: We</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="comment">! ICFL, VCFL, CCFL and Rc stability criteria extrema for the current</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">! time-step and located on both the local (loc) and the global (glb)</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="comment">! computational domains</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: icfl_max_loc, icfl_max_glb</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: vcfl_max_loc, vcfl_max_glb</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: ccfl_max_loc, ccfl_max_glb</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> ::   Rc_min_loc,   Rc_min_glb</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: blkmod1, blkmod2</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">INTEGER</span> :: Nfq</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: fltr_dtheta</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="comment">! Computing Stability Criteria at Current Time-step ================</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;               <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                  <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                     </div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        alpha_rho(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i)) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k,l)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                     </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_prim_vf, rho, &amp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                                          gamma, pi_inf,  &amp;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                          re, we, j,k,l   )</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                     </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        vel(i) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,l)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                     </div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                     pres = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                     </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                     <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                     <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                         <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                             alpha(i) = q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j,k,l)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">                         END DO</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                         blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                             <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                         blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                             <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                         c = (1d0/(rho*(alpha(1)/blkmod1 + alpha(2)/blkmod2)))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                     <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        c = 0d0</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                            c = c + q_prim_vf(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(j,k,l) * (1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) * &amp;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                (pres + <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0))</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        c = c/rho</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                         <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                             alpha(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))= q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(j,k,l)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordflow">                         END DO</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                         c = (((gamma + 1d0)*pres + pi_inf)/(gamma*rho))</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                     <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. c &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                         c = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                         c = sqrt(c)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                     <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        <span class="keywordflow">IF</span> (k == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                            fltr_dtheta = 2d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>*<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(0)/3d0</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        <span class="keywordflow">ELSEIF</span> (k &lt;= <a class="code" href="namespacem__global__parameters.html#aadeb708160fdfee48fe55e83e41b5064">fourier_rings</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                            nfq = min(floor(2d0*<span class="keywordtype">REAL</span>(k,kind(0d0))*pi),(p+1)/2+1)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                            fltr_dtheta = 2d0*pi*<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k-1)/<span class="keywordtype">REAL</span>(nfq,kind(0d0))</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                            fltr_dtheta = <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k-1)*<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                     <span class="keywordflow">IF</span>(p &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        <span class="comment">!3D</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                            <a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a> / min(       <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)/(abs(vel(1))+c), &amp;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                             <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)/(abs(vel(2))+c), &amp;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                       fltr_dtheta/(abs(vel(3))+c)  )</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                            <a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a> / min( <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)/(abs(vel(1))+c), &amp;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)/(abs(vel(2))+c), &amp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                                       <a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l)/(abs(vel(3))+c)  )</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                           </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                               <a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>(j,k,l) = maxval(<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>/re) &amp;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                              / min(<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k),fltr_dtheta)**2d0</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                               </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                 <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>(j,k,l) = min(       <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)*(abs(vel(1))+c),   &amp;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                                           <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)*(abs(vel(2))+c),   &amp;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                     fltr_dtheta*(abs(vel(3))+c)  ) &amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                              / maxval(1d0/re)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                               <a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>(j,k,l) = maxval(<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>/re) &amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                              / min(<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k),<a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l))**2d0</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                               </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                 <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>(j,k,l) = min( <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)*(abs(vel(1))+c),   &amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                     <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)*(abs(vel(2))+c),   &amp;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                                     <a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l)*(abs(vel(3))+c)  ) &amp;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                              / maxval(1d0/re)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                           </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                           </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                           <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = 0d0</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                           </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                           <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                              <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = max( <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) , &amp;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                 1d0 / we(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                      ( max(alpha_rho(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                              0d0) / &amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                           max( alpha(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)   &amp;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                      + max(alpha_rho(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                              0d0) / &amp;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                           max( alpha(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                           </div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                           <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                               <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = sqrt( pi*<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>**2d0 &amp;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                                           / min(       <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),        &amp;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                                                        <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k),        &amp;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                                                  fltr_dtheta  )**3d0 )</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                           <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                               <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = sqrt( pi*<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>**2d0 &amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                           / min( <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),        &amp;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k),        &amp;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                                                  <a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(l)  )**3d0 )</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">                           END IF</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                           </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                        </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                     <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                        <span class="comment">!2D</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                        <a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a> / min( <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)/(abs(vel(1))+c), &amp;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)/(abs(vel(2))+c)  )</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                           </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                           <a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>(j,k,l) = maxval(<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>/re)/min(<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k))**2d0</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                           </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                             <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>(j,k,l) = min( <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)*(abs(vel(1))+c),   &amp;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                                 <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k)*(abs(vel(2))+c)  ) &amp;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                          / maxval(1d0/re)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                           </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                           </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                           <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = 0d0</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                           </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                           <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                              <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = max( <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) , &amp;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                 1d0 / we(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) / &amp;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                      ( max(alpha_rho(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                                              0d0) / &amp;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                           max( alpha(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,1)) , &amp;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>)   &amp;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                      + max(alpha_rho(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                                              0d0) / &amp;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                           max( alpha(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(i,2)) , &amp;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                                          <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) ) )</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                           </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                           <a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l) = sqrt( pi*<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(j,k,l)*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>**2d0 &amp;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                                    / min(<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j),<a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(k))**3d0 )</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                           </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <span class="comment">!1D </span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                        <a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>(j,k,l) = (<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j))*(abs(vel(1))+c)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                           </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                           <a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>(j,k,l) = maxval(<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>/re)/<a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)**2d0</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                           </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                             <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>(j,k,l) = <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(j)*(abs(vel(1))+c)/maxval(1d0/re)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                           </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                     </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="comment">! END: Computing Stability Criteria at Current Time-step ===========</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">! Determining local stability criteria extrema at current time-step</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                 icfl_max_loc = maxval(<a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) vcfl_max_loc = maxval(<a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">IF</span>(    <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 ) ccfl_max_loc = maxval(<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>)</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0))   rc_min_loc = minval(  <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="comment">! Determining global stability criteria extrema at current time-step</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a340a2c9b1688582ee485dd5d9bbcc864">s_mpi_reduce_stability_criteria_extrema</a>( icfl_max_loc, &amp;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                                              vcfl_max_loc, &amp;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                                              ccfl_max_loc, &amp;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                                                rc_min_loc, &amp;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                              icfl_max_glb, &amp;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                                              vcfl_max_glb, &amp;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                                              ccfl_max_glb, &amp;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                                                rc_min_glb  )</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                     icfl_max_glb = icfl_max_loc</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) vcfl_max_glb = vcfl_max_loc</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">IF</span>(    <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 ) ccfl_max_glb = ccfl_max_loc</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0))   rc_min_glb =   rc_min_loc</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="comment">! Determining the stability criteria extrema over all the time-steps</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">IF</span>(icfl_max_glb &gt; <a class="code" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">icfl_max</a>) <a class="code" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">icfl_max</a> = icfl_max_glb</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keywordflow">IF</span>(vcfl_max_glb &gt; <a class="code" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">vcfl_max</a>) <a class="code" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">vcfl_max</a> = vcfl_max_glb</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keywordflow">IF</span>(  rc_min_glb &lt;   <a class="code" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">rc_min</a>)   <a class="code" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">rc_min</a> =   rc_min_glb</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordflow">IF</span>(ccfl_max_glb &gt; <a class="code" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">ccfl_max</a>) <a class="code" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">ccfl_max</a> = ccfl_max_glb</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">! Outputting global stability criteria extrema at current time-step</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0) .AND. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(4X,I8,4X,F10.6,4X,F9.6,4X,F9.6,4X,F9.6,4X,F10.6)&#39;</span>) &amp;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                                t_step, t_step*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>, icfl_max_glb, &amp;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                                   vcfl_max_glb, &amp;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                                   ccfl_max_glb, &amp;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                                     rc_min_glb</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keywordflow">ELSEIF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(6X,I8,6X,F10.6,6X,F9.6,6X,F9.6,6X,F10.6)&#39;</span>) &amp;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                        t_step, t_step*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>, icfl_max_glb, &amp;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                                           vcfl_max_glb, &amp;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                                             rc_min_glb</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(9X,I8,9X,F10.6,9X,F9.6,9X,F9.6)&#39;</span>) &amp;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                               t_step, t_step*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>, icfl_max_glb, &amp;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                                  ccfl_max_glb</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(13X,I8,14X,F10.6,13X,F9.6)&#39;</span>) &amp;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                          t_step, t_step*<a class="code" href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">dt</a>, icfl_max_glb</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="keywordflow">IF</span> (icfl_max_glb /= icfl_max_glb) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;ICFL is NaN. Exiting ...&#39;</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">ELSEIF</span> (icfl_max_glb &gt; 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;ICFL is greater than 1.0. Exiting ...&#39;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a>()</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a33a72559ec5cfdedf7162a8269d41201">s_write_run_time_information</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">s_write_serial_data_files</a>(q_cons_vf, t_step) <span class="comment">! ---------------------</span></div><div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">  720</a></span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len + 2*name_len)</span> :: t_step_dir</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordtype">CHARACTER(LEN = path_len + 3*name_len)</span> :: file_path</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordtype">LOGICAL</span> :: file_exist</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordtype">CHARACTER(LEN=15)</span> :: FMT</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordtype">INTEGER</span> :: i, j, k, l, ii</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(nb)</span> :: nRtmp</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nbub</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma, lit_gamma, pi_inf</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>                   :: Re</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>    :: We</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="comment">! Creating or overwriting the time-step root directory</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keyword">WRITE</span>(t_step_dir,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/p_all&#39;</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="comment">! Creating or overwriting the current time-step directory</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keyword">WRITE</span>(t_step_dir,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/p_all/p&#39;</span>, &amp;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;/&#39;</span>, t_step</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/.&#39;</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__compile__specific.html#aa7f14da74305c1d061ce326b16a3263e">my_inquire</a>(file_path,file_exist)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">IF</span>(file_exist) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;rm -rf &#39;</span> // trim(t_step_dir))</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(t_step_dir))</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">! Writing the grid data file in the x-direction</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/x_cb.dat&#39;</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keyword">OPEN</span>(2, file   = trim(file_path), &amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    form   = <span class="stringliteral">&#39;unformatted&#39;</span>  , &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    status = <span class="stringliteral">&#39;new&#39;</span>            )</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keyword">WRITE</span>(2) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(-1:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>); <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="comment">! Writing the grid data files in the y- and z-directions</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/y_cb.dat&#39;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keyword">OPEN</span>(2, file   = trim(file_path), &amp;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                        form   = <span class="stringliteral">&#39;unformatted&#39;</span>  , &amp;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                        status = <span class="stringliteral">&#39;new&#39;</span>            )</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keyword">WRITE</span>(2) <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(-1:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>); <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/z_cb.dat&#39;</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <span class="keyword">OPEN</span>(2, file   = trim(file_path), &amp;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                            form   = <span class="stringliteral">&#39;unformatted&#39;</span>  , &amp;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                            status = <span class="stringliteral">&#39;new&#39;</span>            )</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="keyword">WRITE</span>(2) <a class="code" href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">z_cb</a>(-1:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>); <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="comment">! Writing the conservative variables data files</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/q_cons_vf&#39;</span>, &amp;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                            i, <span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    <span class="keyword">OPEN</span>(2, file   = trim(file_path), &amp;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        form   = <span class="stringliteral">&#39;unformatted&#39;</span>  , &amp;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                        status = <span class="stringliteral">&#39;new&#39;</span>            )</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <span class="keywordflow">IF</span> (i == <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a> .AND. <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. (<a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a> .OR. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">s_remove_capillary_potential_energy</a>(q_cons_vf)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        <span class="keyword">WRITE</span>(2) <a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>); <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="keyword">WRITE</span>(2) q_cons_vf(i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>); <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keywordflow">                    END IF</span>  </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            gamma = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            lit_gamma = 1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1d0</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            pi_inf = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">precision</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                fmt=<span class="stringliteral">&quot;(2F30.7)&quot;</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                fmt=<span class="stringliteral">&quot;(2F40.14)&quot;</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="comment">!1D</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>==0 .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                <span class="comment">! writting an output directory</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                <span class="keyword">WRITE</span>(t_step_dir,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/D&#39;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/.&#39;</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            </div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <span class="keyword">INQUIRE</span>( file = trim(file_path), exist = file_exist       )</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordflow">IF</span>(.NOT.file_exist) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(t_step_dir))</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a>==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/prim.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        <span class="keyword">OPEN</span>(2,file= trim(file_path) )</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                            <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, gamma, pi_inf, re, we, j,0,0)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                lit_gamma = 1d0/gamma + 1d0</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                                <span class="keywordflow">IF</span> ( ((i.ge.<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%beg) .AND. (i.le.<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end))    &amp;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                                          .OR.                          &amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                     ((i.ge.<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)  .AND. (i.le.<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end))     &amp;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                                         ) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i.eq.<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg) <span class="keywordflow">THEN</span> <span class="comment">!u</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,0,0)/rho</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i.eq.<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>) <span class="keywordflow">THEN</span> <span class="comment">!p</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                        <span class="comment">!Tait pressure from density</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j), &amp;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a> + pi_inf) * (                     &amp;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                            ( q_cons_vf(1)%sf(j,0,0)/               &amp;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.d0-q_cons_vf(4)%sf(j,0,0)))  &amp; </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                            ) ** lit_gamma )                        &amp;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                            - pi_inf</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j), &amp;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,0,0)  -            &amp;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                            0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,0,0)**2.d0)/rho - &amp;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j), &amp;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                            (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,0,0)  -            &amp;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                            0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,0,0)**2.d0)/rho) / &amp;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                            (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,0,0)) - &amp;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ((i .GT. <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                    <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                        nrtmp(k) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(k))%sf(j,0,0)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,0,0), nrtmp, nbub) </div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                    </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)/nbub</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>    </div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_path) )</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),q_cons_vf(i)%sf(j,0,0)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">!2D</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> ==0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keyword">WRITE</span>(t_step_dir,<span class="stringliteral">&#39;(A,I0,A,I0)&#39;</span>) trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/D&#39;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                file_path = trim(t_step_dir) // <span class="stringliteral">&#39;/.&#39;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keyword">INQUIRE</span>( file      = trim(file_path), exist     = file_exist       )</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="keywordflow">IF</span>(.NOT.file_exist) <span class="keyword">CALL </span>system(<span class="stringliteral">&#39;mkdir -p &#39;</span> // trim(t_step_dir))</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a>==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/prim.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                        <span class="keyword">OPEN</span>(2,file=trim(file_path) )</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                            <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>; <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, gamma, pi_inf, re, we, j,k,0)</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                lit_gamma = 1d0/gamma + 1d0</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                <span class="keywordflow">IF</span> (i==1 .OR. i==5) <span class="keywordflow">THEN</span> </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i==2 .OR. i==3) <span class="keywordflow">THEN</span> <span class="comment">!u</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)/rho</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (i==4) <span class="keywordflow">THEN</span> <span class="comment">!p</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k), &amp;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>+<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf) *                     &amp;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                            ((                                               &amp; </div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                            q_cons_vf(1)%sf(j,k,0)/                          &amp;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.-q_cons_vf(4)%sf(j,k,0)))             &amp; </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                            ) ** (1./<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1.)) - <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k), &amp;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                            q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,0)  -            &amp;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                            0.5d0*(q_cons_vf(2)%sf(j,k,0)**2.d0)/rho - &amp;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                        <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                        <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k), &amp;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                            (                                       &amp; </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                            (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,0)  -            &amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                            0.5d0*( q_cons_vf(2)%sf(j,k,0)**2.d0 + q_cons_vf(3)%sf(j,k,0)**2.d0 ) &amp;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                            / rho) / &amp;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                            (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,0)) - &amp;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                            pi_inf &amp;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                            ) / gamma</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( (i .GT. <a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>) .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                    <span class="keywordflow">DO</span> l = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                        nrtmp(l) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(l))%sf(j,k,0)</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                    <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,0), nrtmp, nbub)  </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                    </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                    <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j), <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k), q_cons_vf(i)%sf(j,k,0)/nbub</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keywordflow">                               END IF</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                            <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_path) )</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                        <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k),q_cons_vf(i)%sf(j,k,0)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="comment">! 3D</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    <span class="keyword">WRITE</span>(file_path,<span class="stringliteral">&#39;(A,I0,A,I2.2,A,I6.6,A)&#39;</span>) trim(t_step_dir) // <span class="stringliteral">&#39;/cons.&#39;</span>, i, <span class="stringliteral">&#39;.&#39;</span>, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, <span class="stringliteral">&#39;.&#39;</span>, t_step,<span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <span class="keyword">OPEN</span>(2,file= trim(file_path) )</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        <span class="keywordflow">DO</span> j=0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        <span class="keywordflow">DO</span> k=0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        <span class="keywordflow">DO</span> l=0,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                            <span class="keyword">WRITE</span>(2,fmt) <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j),<a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k),<a class="code" href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">z_cb</a>(l), q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                        <span class="keyword">WRITE</span>(2,*)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <span class="keyword">CLOSE</span>(2)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">s_write_serial_data_files</a> <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        </div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">s_remove_capillary_potential_energy</a>(v_vf)</div><div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">  995</a></span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: v_vf</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: E_We</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: ix,iy,iz</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: iz1</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="comment">! Placeholders (_ph) for variables </span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho_ph, gamma_ph, pi_inf_ph</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: Re_ph</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,num_fluids)</span> :: We_ph</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            ix%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%beg = 0; iz%beg = 0</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) iy%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) iz%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            ix%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - ix%beg; iy%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - iy%beg; iz%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - iz%beg</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <span class="keyword">ALLOCATE</span>(e_we(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                iz1%beg = iz%beg; iz1%end = iz%end</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                iz1%beg = -1; iz1%end = 1</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="comment">! Compute volume fraction gradient magnitude for all fluids</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">s_compute_lsq_gradient_curvature</a>(v_vf,<a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>,<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>,<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>,<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>,<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a>)</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">DO</span> k = iz1%beg+1, iz1%end-1</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                <span class="keywordflow">DO</span> j = iy%beg+1, iy%end-1</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <span class="keywordflow">DO</span> i = ix%beg+1, ix%end-1</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        e_we(i,j,k) = 0d0</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                        </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>(v_vf, rho_ph, gamma_ph, &amp;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                                            pi_inf_ph, re_ph, we_ph, i,j,k)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        <span class="comment">! Compute capillary potential energy</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                            e_we(i,j,k) = e_we(i,j,k) + &amp;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                    v_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,1))%sf(i,j,k) * &amp;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                    <a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,2))%sf(i,j,k) / we_ph(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,2)) + &amp;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                    v_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,2))%sf(i,j,k) * &amp;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                    <a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,1))%sf(i,j,k) / we_ph(<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,1),<a class="code" href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">we_idx</a>(l,2))</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="comment">! Remove capillary potential energy from conservative variable</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a>(:,:,:) = v_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(:,:,:) - e_we(:,:,:)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">s_remove_capillary_potential_energy</a></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        </div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75">s_write_parallel_data_files</a>(q_cons_vf, t_step) <span class="comment">! --</span></div><div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75"> 1054</a></span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordtype">INTEGER</span> :: ifile, ierr, data_size</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(MPI_STATUS_SIZE)</span> :: status</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: disp</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: m_MOK, n_MOK, p_MOK</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: WP_MOK, var_MOK, str_MOK</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: NVARS_MOK</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keywordtype">INTEGER(KIND=MPI_OFFSET_KIND)</span> :: MOK</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordtype">CHARACTER(LEN=path_len + 2*name_len)</span> :: file_loc </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordtype">LOGICAL</span> :: file_exist</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="comment">! Initialize MPI data I/O</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a>(q_cons_vf)</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. (<a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a> .OR. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">s_remove_capillary_potential_energy</a>(q_cons_vf)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf =&gt; <a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="comment">! Open the file to write all flow variables</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keyword">WRITE</span>(file_loc, <span class="stringliteral">&#39;(I0,A)&#39;</span>) t_step, <span class="stringliteral">&#39;.dat&#39;</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            file_loc = trim(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>) // <span class="stringliteral">&#39;/restart_data&#39;</span> // trim(<a class="code" href="namespacem__global__parameters.html#ad4713c1e89eaa8fac3bb2181ba87b192">mpiiofs</a>) // trim(file_loc)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keyword">INQUIRE</span>(file = trim(file_loc),exist = file_exist)</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">IF</span> (file_exist .AND. <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <span class="keyword">CALL </span>mpi_file_delete(file_loc,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="keyword">CALL </span>mpi_file_open(mpi_comm_world,file_loc,ior(mpi_mode_wronly,mpi_mode_create),&amp;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ifile,ierr)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="comment">! Size of local arrays</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            data_size = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="comment">! Resize some integers so MPI can write even the biggest files</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            m_mok     = int(<a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>+1,     mpi_offset_kind)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            n_mok     = int(<a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>+1,     mpi_offset_kind)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            p_mok     = int(<a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>+1,     mpi_offset_kind)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            wp_mok    = int(8d0,      mpi_offset_kind)</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            mok       = int(1d0,      mpi_offset_kind)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            str_mok   = int(<a class="code" href="namespacem__global__parameters.html#ac8252b115e717c6f1c8595be6f897df7">name_len</a>, mpi_offset_kind)</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            nvars_mok = int(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>, mpi_offset_kind)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="comment">! Write the data for each variable</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    var_mok = int(i, mpi_offset_kind)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    <span class="comment">! Initial displacement to skip at beginning of file</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    disp = m_mok*max(mok,n_mok)*max(mok,p_mok)*wp_mok*(var_mok-1)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    <span class="keyword">CALL </span>mpi_file_set_view(ifile,disp,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i), &amp;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                <span class="stringliteral">&#39;native&#39;</span>,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    <span class="keyword">CALL </span>mpi_file_write_all(ifile,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf,data_size, &amp;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                mpi_double_precision,status,ierr)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    var_mok = int(i, mpi_offset_kind)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    <span class="comment">! Initial displacement to skip at beginning of file</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    disp = m_mok*max(mok,n_mok)*max(mok,p_mok)*wp_mok*(var_mok-1)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    <span class="keyword">CALL </span>mpi_file_set_view(ifile,disp,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i), &amp;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                <span class="stringliteral">&#39;native&#39;</span>,<a class="code" href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">mpi_info_int</a>,ierr)</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    <span class="keyword">CALL </span>mpi_file_write_all(ifile,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf,data_size, &amp;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                mpi_double_precision,status,ierr)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="keyword">CALL </span>mpi_file_close(ifile,ierr)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75">s_write_parallel_data_files</a> <span class="comment">! ---------------------------</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a6be3381410dd028014de2c1d02b05139">s_write_com_files</a>(t_step,q_com,moments) <span class="comment">! -------------------</span></div><div class="line"><a name="l01142"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a6be3381410dd028014de2c1d02b05139"> 1142</a></span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,10)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_com</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,2,5)</span>, <span class="keywordtype">INTENT(IN)</span> :: moments</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nondim_time</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="comment">! Non-dimensional time calculation</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step + <a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a>,kind(0d0))*dt</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step,kind(0d0))*dt</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 1D simulation</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> <span class="comment">! Loop through fluids</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>(i)) <span class="keywordflow">THEN</span> <span class="comment">! Writing out CoM data</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                            <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                q_com(i,1), &amp;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                q_com(i,2), &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                q_com(i,5), &amp;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                q_com(i,8)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 2D simulation</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> <span class="comment">! Loop through fluids</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>(i)) <span class="keywordflow">THEN</span> <span class="comment">! Writing out CoM data</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(1) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                    q_com(i,9)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(2) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,E24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                    moments(i,1,1)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(3) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,E24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                             <span class="stringliteral">&#39;E24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                    moments(i,1,2)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(4) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,E24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                             <span class="stringliteral">&#39;E24.8,E24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                    moments(i,1,3)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(5) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,E24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                             <span class="stringliteral">&#39;E24.8,E24.8,E24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                    moments(i,1,3), &amp;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                    moments(i,1,4)</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,E24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                             <span class="stringliteral">&#39;E24.8,E24.8,E24.8,E24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                    moments(i,1,3), &amp;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                    moments(i,1,4), &amp;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                                    moments(i,1,5)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">ELSE</span> <span class="comment">! 3D simulation</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> <span class="comment">! Loop through fluids</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>(i)) <span class="keywordflow">THEN</span> <span class="comment">! Writing out CoM data</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(1) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                    q_com(i,10)</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(2) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                    q_com(i,10), &amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                    moments(i,2,1)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(3) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                    q_com(i,10), &amp;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                    moments(i,2,1), &amp;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                                    moments(i,2,2)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(4) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                    q_com(i,10), &amp;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                    moments(i,1,3), &amp;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                    moments(i,2,1), &amp;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                    moments(i,2,2), &amp;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                    moments(i,2,3)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">moment_order</a>(5) == <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                    q_com(i,10), &amp;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                    moments(i,1,3), &amp;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                    moments(i,1,4), &amp;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                    moments(i,2,1), &amp;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                    moments(i,2,2), &amp;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                    moments(i,2,3), &amp;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                    moments(i,2,4)</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                <span class="keyword">WRITE</span>(i+10, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                             <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                    q_com(i,1), &amp;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                    q_com(i,2), &amp;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                    q_com(i,3), &amp;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                    q_com(i,4), &amp;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                    q_com(i,5), &amp;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                    q_com(i,6), &amp;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                    q_com(i,7), &amp;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                    q_com(i,8), &amp;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                    q_com(i,9), &amp;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                    q_com(i,10), &amp;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                    moments(i,1,1), &amp;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                    moments(i,1,2), &amp;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                    moments(i,1,3), &amp;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                    moments(i,1,4), &amp;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                    moments(i,1,5), &amp;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                    moments(i,2,1), &amp;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                    moments(i,2,2), &amp;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                    moments(i,2,3), &amp;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                    moments(i,2,4), &amp;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                    moments(i,2,5)</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a6be3381410dd028014de2c1d02b05139">s_write_com_files</a> <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a40724c992117a24479573d9fbcdfa21b">s_write_cb_files</a>(t_step,cb_mass,bounds,cntrline) <span class="comment">! ----------</span></div><div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a40724c992117a24479573d9fbcdfa21b"> 1412</a></span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,10)</span>, <span class="keywordtype">INTENT(IN)</span> :: cb_mass</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,5,6)</span>, <span class="keywordtype">INTENT(IN)</span> :: bounds</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids,5)</span>, <span class="keywordtype">INTENT(IN)</span> :: cntrline</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nondim_time</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="comment">! Non-dimensional time calculation</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step + <a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a>,kind(0d0))*dt</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step,kind(0d0))*dt</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> <span class="comment">! Loop through fluids</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">cb_wrt</a>(i)) <span class="keywordflow">THEN</span> <span class="comment">! Writing out CoM data</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 1D simulation</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(2) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                                    bounds(i,1,2)</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(3) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                    bounds(i,2,2)</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(4) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                    bounds(i,3,2)</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(5) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                                    bounds(i,4,2)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                    cb_mass(i,5), &amp;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                    cb_mass(i,10), &amp;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                    bounds(i,5,1), &amp;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                    bounds(i,4,2), &amp;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                    bounds(i,5,2)</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 2D simulation</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(2) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                    cntrline(i,1)</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(3) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                    cntrline(i,2)</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(4) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                                <span class="stringliteral">&#39;F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                    cntrline(i,3)</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(5) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                                    bounds(i,4,2), &amp;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                    bounds(i,4,3), &amp;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                    bounds(i,4,4), &amp;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                    cntrline(i,3), &amp;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                    cntrline(i,4)</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                                    cb_mass(i,5), &amp;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                    cb_mass(i,10), &amp;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                    bounds(i,5,1), &amp;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                                    bounds(i,4,2), &amp;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                                    bounds(i,5,2), &amp;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                                    bounds(i,4,3), &amp;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                    bounds(i,5,3), &amp;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                    bounds(i,4,4), &amp;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                                    bounds(i,5,4), &amp;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                                    cntrline(i,3), &amp;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                    cntrline(i,4), &amp;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                                    cntrline(i,5)</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="comment">! 3D simulation</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(2) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                                <span class="stringliteral">&#39;F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                                    bounds(i,1,5), &amp;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                                    bounds(i,1,6), &amp;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                    cntrline(i,1)</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(3) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                                    bounds(i,1,5), &amp;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                                    bounds(i,2,5), &amp;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                    bounds(i,1,6), &amp;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                                    bounds(i,2,6), &amp;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                                    cntrline(i,2)</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(4) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                    bounds(i,1,5), &amp;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                    bounds(i,2,5), &amp;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                    bounds(i,3,5), &amp;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                    bounds(i,1,6), &amp;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                    bounds(i,2,6), &amp;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                    bounds(i,3,6), &amp;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                    cntrline(i,3)</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">threshold_mf</a>(5) == <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                                    bounds(i,4,2), &amp;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                                    bounds(i,4,3), &amp;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                                    bounds(i,4,4), &amp;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                                    bounds(i,1,5), &amp;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                    bounds(i,2,5), &amp;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                    bounds(i,3,5), &amp;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                    bounds(i,4,5), &amp;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                    bounds(i,1,6), &amp;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                    bounds(i,2,6), &amp;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                                    bounds(i,3,6), &amp;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                    bounds(i,4,6), &amp;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                    cntrline(i,3), &amp;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                                    cntrline(i,4)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                <span class="keyword">WRITE</span>(i+20, <span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                                                <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                                <span class="stringliteral">&#39;F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                    nondim_time, &amp;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                    cb_mass(i,1), &amp;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                    cb_mass(i,2), &amp;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                    cb_mass(i,3), &amp;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                    cb_mass(i,4), &amp;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                    cb_mass(i,5), &amp;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                                    cb_mass(i,6), &amp;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                                    cb_mass(i,7), &amp;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                                    cb_mass(i,8), &amp;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                                    cb_mass(i,9), &amp;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                                    cb_mass(i,10), &amp;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                    bounds(i,1,1), &amp;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                                    bounds(i,2,1), &amp;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                                    bounds(i,3,1), &amp;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                    bounds(i,4,1), &amp;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                                    bounds(i,5,1), &amp;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                    bounds(i,1,2), &amp;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                    bounds(i,2,2), &amp;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                                    bounds(i,3,2), &amp;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                                    bounds(i,4,2), &amp;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                                    bounds(i,5,2), &amp;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                                    bounds(i,1,3), &amp;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                                    bounds(i,2,3), &amp;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                                    bounds(i,3,3), &amp;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                    bounds(i,4,3), &amp;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                                    bounds(i,5,3), &amp;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                                    bounds(i,1,4), &amp;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                                    bounds(i,2,4), &amp;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                    bounds(i,3,4), &amp;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                                    bounds(i,4,4), &amp;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                                    bounds(i,5,4), &amp;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                    bounds(i,1,5), &amp;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                                    bounds(i,2,5), &amp;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                                    bounds(i,3,5), &amp;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                                    bounds(i,4,5), &amp;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                                    bounds(i,5,5), &amp;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                                    bounds(i,1,6), &amp;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                                    bounds(i,2,6), &amp;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                                    bounds(i,3,6), &amp;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                                    bounds(i,4,6), &amp;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                                    bounds(i,5,6), &amp;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                    cntrline(i,1), &amp;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                    cntrline(i,2), &amp;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                                    cntrline(i,3), &amp;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                                    cntrline(i,4), &amp;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                                    cntrline(i,5)</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a40724c992117a24479573d9fbcdfa21b">s_write_cb_files</a> <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a29f34883bc8e9d895dbb4232493397a1">s_write_probe_files</a>(t_step,q_cons_vf,accel_mag) <span class="comment">! -----------</span></div><div class="line"><a name="l01860"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a29f34883bc8e9d895dbb4232493397a1"> 1860</a></span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: t_step</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">DIMENSION(sys_size)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:m,0:n,0:p)</span>, <span class="keywordtype">INTENT(IN)</span> :: accel_mag</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(-1:m)</span> :: distx</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(-1:n)</span> :: disty</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(-1:p)</span> :: distz</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            <span class="comment">! The cell-averaged partial densities, density, velocity, pressure,</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            <span class="comment">! volume fractions, specific heat ratio function, liquid stiffness</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            <span class="comment">! function, and sound speed.</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: lit_gamma, nbub</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: rho</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>              :: vel</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: pres</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: ptilde</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: ptot</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: alf</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: alfgr</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_fluids)</span>            :: alpha</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: gamma</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: pi_inf</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: c</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(Nb)</span>                    :: nR, R, nRdot, Rdot</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: accel</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: int_pres</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                                   :: max_pres</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>             :: Re</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span>      :: We</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            </div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,s</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: nondim_time</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tmp</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: blkmod1, blkmod2</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <span class="keywordtype">INTEGER</span> :: npts</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rad, thickness</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <span class="keywordtype">LOGICAL</span> :: trigger</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            <span class="comment">! Non-dimensional time calculation</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a> /= <a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step + <a class="code" href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">t_step_old</a>,kind(0d0))*dt</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                nondim_time = <span class="keywordtype">REAL</span>(t_step,kind(0d0))*dt <span class="comment">!*1.d-5/10.0761131451d0</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aa4e0d015d4064b37e132c5088089394d">num_probes</a></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                <span class="comment">! Zeroing out flow variables for all processors</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                rho = 0d0</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                    vel(s) = 0d0</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                pres = 0d0</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                gamma = 0d0</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                pi_inf = 0d0</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                c = 0d0</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                accel = 0d0</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                <span class="comment">! Find probe location in terms of indices on a</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                <span class="comment">! specific processor</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 1D simulation</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                    <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &gt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &lt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                        <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                            distx(s) = <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                            <span class="keywordflow">IF</span> (distx(s) &lt; 0d0) distx(s) = 1000d0</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                        j = minloc(distx,1)</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                        <span class="keywordflow">IF</span> (j == 1) j = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                        k = 0</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                        l = 0</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                        <span class="comment">! Computing/Sharing necessary state variables</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, &amp;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                                             gamma, pi_inf, &amp;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                                             re, we, j-2,k,l)</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                        <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                            vel(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+s)%sf(j-2,k,l)/rho</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                            lit_gamma = 1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1d0</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                            </div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                            <span class="comment">!Tait pressure from density</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                            pres = (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a> + pi_inf) * (                     &amp;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                ( q_cons_vf(1)%sf(j-2,k,l)/               &amp;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.d0-q_cons_vf(4)%sf(j-2,k,l)))  &amp; </div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                                ) ** lit_gamma )                        &amp;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                                - pi_inf</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                            <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                            pres = (                                       &amp; </div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                                q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j-2,k,l)  -            &amp;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                0.5d0*(q_cons_vf(2)%sf(j-2,k,l)**2.d0)/q_cons_vf(1)%sf(j-2,k,l) - &amp;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                pi_inf &amp;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                ) / gamma</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                            <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                            pres = (                                       &amp; </div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                                (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j-2,k,l)  -            &amp;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                                0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j-2,k,l)**2.d0)/rho) / &amp;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                                (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k,l)) - &amp;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                pi_inf &amp;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                ) / gamma</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                            alf = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k,l)</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                                alfgr = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>-1)%sf(j-2,k,l)</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="keywordflow">                            end IF</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                            <span class="keywordflow">DO</span> s = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                                nr(s)   = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(s))%sf(j-2,k,l)</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                nrdot(s)= q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(s))%sf(j-2,k,l)</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k,l), nr, nbub)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                                </div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                            r(:) = nr(:)/nbub                        </div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                            rdot(:) = nrdot(:)/nbub                        </div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                        </div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                            ptilde = <a class="code" href="namespacem__global__parameters.html#ac6ff480000eaa7af51481d0f17b78423">ptil</a>(j-2,k,l)</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                            ptot = pres - ptilde</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                        <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                            <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                                alpha(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+s)%sf(j-2,k,l)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                            blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                            blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                            c = (1d0/(rho*(alpha(1)/blkmod1 + alpha(2)/blkmod2)))</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                            c = (((gamma + 1d0)*pres + pi_inf)/(gamma*rho))</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. c &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                            c = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                            c = sqrt(c)</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                        accel = accel_mag(j-2,k,l)</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 2D simulation</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                    <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &gt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &lt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y &gt;= <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y &lt;= <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                            <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                                distx(s) = <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                <span class="keywordflow">IF</span> (distx(s) &lt; 0d0) distx(s) = 1000d0</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                            <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                disty(s) = <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                <span class="keywordflow">IF</span> (disty(s) &lt; 0d0) disty(s) = 1000d0</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                            j = minloc(distx,1)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                            k = minloc(disty,1)</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                            <span class="keywordflow">IF</span> (j == 1) j = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                            <span class="keywordflow">IF</span> (k == 1) k = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                            l = 0</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                            <span class="comment">! Computing/Sharing necessary state variables</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, &amp;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                                                 gamma, pi_inf, &amp;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                                                 re, we, j-2,k-2,l)</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                            <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                vel(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+s)%sf(j-2,k-2,l)/rho</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                                lit_gamma = 1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma + 1d0</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                            </div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                                <span class="comment">!Tait pressure from density</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                                pres = (<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a> + pi_inf) * (                     &amp;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                                    ( q_cons_vf(1)%sf(j-2,k-2,l)/               &amp;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                                    (<a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1.d0-q_cons_vf(4)%sf(j-2,k-2,l)))  &amp; </div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                                    ) ** lit_gamma )                        &amp;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                                    - pi_inf</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 2 .AND. (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                                <span class="comment">!Stiffened gas pressure from energy</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                                pres = (                                       &amp; </div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                                    q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j-2,k-2,l)  -            &amp;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                    0.5d0*( (q_cons_vf(2)%sf(j-2,k-2,l)**2.d0 + &amp;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                    q_cons_vf(3)%sf(j-2,k-2,l)**2.d0)/q_cons_vf(1)%sf(j-2,k-2,l)) - &amp;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                    pi_inf &amp;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                    ) / gamma</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                <span class="comment">!Stiffened gas pressure from energy with bubbles</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                                pres = (                                       &amp; </div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                                    (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j-2,k-2,l)  -            &amp;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                                    0.5d0*(q_cons_vf(2)%sf(j-2,k-2,l)**2.d0 + q_cons_vf(3)%sf(j-2,k-2,l)**2.d0 ) &amp;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                                    / q_cons_vf(1)%sf(j-2,k-2,l)) / &amp;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                                    (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k-2,l)) - &amp;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                                    pi_inf &amp;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                                    ) / gamma</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="keywordflow">                            end IF</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                                alf = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k-2,0)</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                                <span class="keywordflow">DO</span> s = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                    nr(s)   = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(s))%sf(j-2,k-2,l)</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                                    nrdot(s)= q_cons_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(s))%sf(j-2,k-2,l)</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">s_comp_n_from_cons</a>( q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j-2,k-2,l), nr, nbub)</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                </div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                r(:) = nr(:)/nbub                        </div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                                rdot(:) = nrdot(:)/nbub                        </div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="keywordflow">                            end IF</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                            <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                                    alpha(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+s)%sf(j-2,k-2,l)</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                                blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                                c = (1d0/(rho*(alpha(1)/blkmod1 + alpha(2)/blkmod2)))</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                c = (((gamma + 1d0)*pres + pi_inf)/(gamma*rho))</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. c &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                                c = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                                c = sqrt(c)</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                            accel = accel_mag(j-2,k-2,l)</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                <span class="keywordflow">ELSE</span> <span class="comment">! 3D simulation</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                    <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &gt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x &lt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y &gt;= <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y &lt;= <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                            <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%z &gt;= <a class="code" href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">z_cb</a>(-1)) .AND. (<a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%z &lt;= <a class="code" href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">z_cb</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                                    distx(s) = <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%x</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                                    <span class="keywordflow">IF</span> (distx(s) &lt; 0d0) distx(s) = 1000d0</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                                <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                                    disty(s) = <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%y</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                                    <span class="keywordflow">IF</span> (disty(s) &lt; 0d0) disty(s) = 1000d0</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                                <span class="keywordflow">DO</span> s = -1, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                    distz(s) = <a class="code" href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">z_cb</a>(s) - <a class="code" href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">probe</a>(i)%z</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                                    <span class="keywordflow">IF</span> (distz(s) &lt; 0d0) distz(s) = 1000d0</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                j = minloc(distx,1)</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                                k = minloc(disty,1)</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                                l = minloc(distz,1)</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                                <span class="keywordflow">IF</span> (j == 1) j = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                                <span class="keywordflow">IF</span> (k == 1) k = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                                <span class="keywordflow">IF</span> (l == 1) l = 2 <span class="comment">! Pick first point if probe is at edge</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        </div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                                <span class="comment">! Computing/Sharing necessary state variables</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, &amp;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                                     gamma, pi_inf, &amp;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                                                     re, we, j-2,k-2,l-2)</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                                <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                    vel(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+s)%sf(j-2,k-2,l-2)/rho</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                pres = (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j-2,k-2,l-2) - 0.5d0*rho*dot_product(vel,vel)-pi_inf)/gamma</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                                    <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                                        alpha(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+s)%sf(j-2,k-2,l-2)</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                                    blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                    blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma +1d0)*pres + &amp;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                                    c = (1d0/(rho*(alpha(1)/blkmod1 + alpha(2)/blkmod2)))</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                                    c = (((gamma + 1d0)*pres + pi_inf)/(gamma*rho))</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a> .AND. c &lt; 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                                    c = <a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                    c = sqrt(c)</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                                accel = accel_mag(j-2,k-2,l-2)</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                    tmp = rho</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,rho)</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                    <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                        tmp = vel(s)</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,vel(s))</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                    tmp = pres</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,pres)</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                    tmp = gamma</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,gamma)</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                    tmp = pi_inf</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,pi_inf)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                    tmp = c</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,c)</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                    tmp = accel</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,accel)</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    tmp = alf</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,alf)</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                    tmp = alfgr</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,alfgr)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                    tmp = nr(1)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,nr(1))</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                    tmp = nrdot(1)</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,nrdot(1))</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                    tmp = r(1)</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,r(1))</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                    tmp = rdot(1)</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,rdot(1))</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                        tmp = ptilde</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,ptilde)</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                        tmp = ptot</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,ptot)</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keywordflow">                    end IF</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &lt;= 2)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                            <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6x,f12.6,f24.8,f24.8,f24.8,f24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                                           <span class="stringliteral">&#39;f24.8,f24.8,f24.8,f24.8,f24.8, f24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                                rho, &amp;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                                vel(1), &amp;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                                pres, &amp;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                                alf, &amp;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                                nr(1), &amp;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                                nrdot(1), &amp;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                r(1), &amp;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                rdot(1), &amp;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                                ptilde, &amp;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                ptot</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> ==3)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                            <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6x,f12.6,f24.8,f24.8,f24.8,f24.8,f24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                           <span class="stringliteral">&#39;f24.8,f24.8,f24.8,f24.8,f24.8, f24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                                rho, &amp;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                                vel(1), &amp;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                                pres, &amp;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                                alf, &amp;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                                alfgr, &amp;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                                nr(1), &amp;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                                nrdot(1), &amp;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                                r(1), &amp;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                                rdot(1), &amp;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                                ptilde, &amp;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                                ptot</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> ==4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                             <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6x,f12.6,f24.8,f24.8,f24.8,f24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                                           <span class="stringliteral">&#39;f24.8,f24.8,f24.8,f24.8,f24.8,f24.8,f24.8,f24.8,f24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                                q_cons_vf(1)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                                q_cons_vf(2)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                                q_cons_vf(3)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                                q_cons_vf(4)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                                q_cons_vf(5)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                                q_cons_vf(6)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                                q_cons_vf(7)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                                q_cons_vf(8)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                q_cons_vf(9)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                                q_cons_vf(10)%sf(j-2,0,0), &amp;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                                nbub,&amp;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                                r(1),&amp;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                                rdot(1)</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                            <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                                rho, &amp;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                                vel(1), &amp;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                                pres</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                        <span class="comment">!WRITE(i+30,&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39; // &amp;</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                        <span class="comment">!                   &#39;F24.8,F24.8,F24.8)&#39;) &amp;</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                        <span class="comment">!    nondim_time, &amp;</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                        <span class="comment">!    rho, &amp;</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                        <span class="comment">!    vel(1), &amp;</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                        <span class="comment">!    pres, &amp;</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                        <span class="comment">!    gamma, &amp;</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                        <span class="comment">!    pi_inf, &amp;</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                        <span class="comment">!    c, &amp;</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                        <span class="comment">!    accel</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                    <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                            <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                                           <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                                rho, &amp;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                                vel(1), &amp;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                                vel(2), &amp;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                                pres, &amp;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                                alf, &amp;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                                nr(1), &amp;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                                nrdot(1), &amp;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                                r(1), &amp;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                                rdot(1)</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                            <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                                nondim_time, &amp;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                                rho, &amp;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                                vel(1), &amp;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                                pres</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                        <span class="keyword">WRITE</span>(i+30,<span class="stringliteral">&#39;(6X,F12.6,F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                                           <span class="stringliteral">&#39;F24.8,F24.8,F24.8,F24.8,&#39;</span> // &amp;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                           <span class="stringliteral">&#39;F24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                            nondim_time, &amp;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                            rho, &amp;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                            vel(1), &amp;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                            vel(2), &amp;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                            vel(3), &amp;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                            pres, &amp;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                            gamma, &amp;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                            pi_inf, &amp;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                            c, &amp;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                            accel</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a530bdd6416ce213046d14488fb48dbc2">integral_wrt</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span> <span class="comment">! 1D simulation</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a7a86e6e9d4c8b59d28b7404d836fdee8">num_integrals</a></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                    int_pres = 0d0</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                    max_pres = 0d0</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                    k = 0; l = 0</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                    npts = 0</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                    <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                        pres = 0d0</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                        <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                            vel(s) = 0d0</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                        rho = 0d0</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                        pres = 0d0</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                        gamma = 0d0</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                        pi_inf = 0d0</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#ac1d4fc341c170b243af0d776ad7ede02">integral</a>(i)%xmin &lt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)) .AND. (<a class="code" href="namespacem__global__parameters.html#ac1d4fc341c170b243af0d776ad7ede02">integral</a>(i)%xmax &gt;= <a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                            npts = npts + 1</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, &amp;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                                             gamma, pi_inf, &amp;</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                                             re, we, j,k,l)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                            <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                                vel(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+s)%sf(j,k,l)/rho</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                            pres = (                                       &amp; </div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                                (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)  -            &amp;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                                0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l)**2.d0)/rho) / &amp;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                                (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) - &amp;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                                pi_inf &amp;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                                ) / gamma</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                            int_pres = int_pres + (pres-1.d0)**2.d0</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                    int_pres = dsqrt(int_pres / (1.d0*npts))</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    </div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                        tmp = int_pres</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,int_pres)</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &lt;= 2)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                            <span class="keyword">WRITE</span>(i+70,<span class="stringliteral">&#39;(6x,f12.6,f24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                                nondim_time, int_pres</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a7a86e6e9d4c8b59d28b7404d836fdee8">num_integrals</a> .NE. 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Incorrect number of integrals&#39;</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>()</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                rad = <a class="code" href="namespacem__global__parameters.html#ac1d4fc341c170b243af0d776ad7ede02">integral</a>(1)%xmax</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                thickness = <a class="code" href="namespacem__global__parameters.html#ac1d4fc341c170b243af0d776ad7ede02">integral</a>(1)%xmin</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#a7a86e6e9d4c8b59d28b7404d836fdee8">num_integrals</a></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                    int_pres = 0d0</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                    max_pres = 0d0 </div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                    l = 0</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                    npts = 0</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                    <span class="keywordflow">DO</span> j = 1,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                        <span class="keywordflow">DO</span> k = 1,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                            trigger = .false.</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                            <span class="keywordflow">IF</span> (i==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                <span class="comment">!inner portion</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                <span class="keywordflow">IF</span> ( dsqrt(<a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)**2.d0 + <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k)**2.d0) &lt; (rad - 0.5d0*thickness) ) &amp;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                                    trigger = .true.</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                            <span class="keywordflow">ELSEIF</span> (i==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                                <span class="comment">!net region</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                                <span class="keywordflow">IF</span> ( dsqrt(<a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)**2.d0 + <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k)**2.d0) &gt; (rad - 0.5d0*thickness) .AND. &amp;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                                     dsqrt(<a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)**2.d0 + <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k)**2.d0) &lt; (rad + 0.5d0*thickness) ) &amp;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                                    trigger = .true.</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                            <span class="keywordflow">ELSEIF</span> (i==3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                                <span class="comment">!everything else</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                                <span class="keywordflow">IF</span> ( dsqrt(<a class="code" href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">x_cb</a>(j)**2.d0 + <a class="code" href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">y_cb</a>(k)**2.d0) &gt; (rad + 0.5d0*thickness) ) &amp;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                                    trigger = .true.</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                            pres = 0d0</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                            <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                                vel(s) = 0d0</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                            rho = 0d0</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                            pres = 0d0</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                            gamma = 0d0</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                            pi_inf = 0d0</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                            <span class="keywordflow">IF</span> (trigger) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                                npts = npts + 1</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( q_cons_vf, rho, &amp;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                                    gamma, pi_inf, &amp;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                                    re, we, j,k,l)</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                                <span class="keywordflow">DO</span> s = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                                    vel(s) = q_cons_vf(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+s)%sf(j,k,l)/rho</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                                pres = (                                       &amp; </div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                                    (q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)  -            &amp;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                                    0.5d0*(q_cons_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,l)**2.d0)/rho) / &amp;</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                                    (1.d0 - q_cons_vf(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l)) - &amp;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                                    pi_inf &amp;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                                    ) / gamma</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                                int_pres = int_pres + abs(pres-1.d0)</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                                max_pres = max(max_pres,abs(pres-1.d0))</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="keywordflow">                       END DO</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                    <span class="keywordflow">IF</span> (npts &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                        int_pres = int_pres/(1.d0*npts)</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                        int_pres = 0.d0</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="keywordflow">                    end IF</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                    </div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                        tmp = int_pres</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">s_mpi_allreduce_sum</a>(tmp,int_pres)</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                        tmp = max_pres</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__mpi__proxy.html#aff7286de058c49b2a5d7a84be1983e8f">s_mpi_allreduce_max</a>(tmp,max_pres)</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a> &lt;= 2)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                            <span class="keyword">WRITE</span>(i+70,<span class="stringliteral">&#39;(6x,f12.6,f24.8,f24.8)&#39;</span>) &amp;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                                nondim_time, int_pres, max_pres</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="keywordflow">                        end IF</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a29f34883bc8e9d895dbb4232493397a1">s_write_probe_files</a> <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a390239a7390ec5d07e31298573bf09bf">s_close_run_time_information_file</a>() <span class="comment">! -----------------------</span></div><div class="line"><a name="l02449"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a390239a7390ec5d07e31298573bf09bf"> 2449</a></span>&#160;           </div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            </div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: run_time</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            </div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            </div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            <span class="comment">! Writing the footer of and closing the run-time information file</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;----------------------------------------&#39;</span> // &amp;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                           <span class="stringliteral">&#39;----------------------------------------&#39;</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            </div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                                 <span class="keyword">WRITE</span>(1, <span class="stringliteral">&#39;(A,F9.6)&#39;</span>) <span class="stringliteral">&#39;ICFL Max: &#39;</span>, <a class="code" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">icfl_max</a></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">WRITE</span>(1, <span class="stringliteral">&#39;(A,F9.6)&#39;</span>) <span class="stringliteral">&#39;VCFL Max: &#39;</span>, <a class="code" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">vcfl_max</a></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="keywordflow">IF</span>(    <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 ) <span class="keyword">WRITE</span>(1, <span class="stringliteral">&#39;(A,F9.6)&#39;</span>) <span class="stringliteral">&#39;CCFL Max: &#39;</span>, <a class="code" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">ccfl_max</a></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A,F10.6)&#39;</span>)   <span class="stringliteral">&#39;Rc Min: &#39;</span>,   <a class="code" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">rc_min</a></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;            </div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            <span class="keyword">CALL </span>cpu_time(run_time)</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            </div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A,I0,A)&#39;</span>) <span class="stringliteral">&#39;Run-time: &#39;</span>, int(anint(run_time)), <span class="stringliteral">&#39;s&#39;</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            <span class="keyword">WRITE</span>(1,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;========================================&#39;</span> // &amp;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                           <span class="stringliteral">&#39;========================================&#39;</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;            <span class="keyword">CLOSE</span>(1)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;            </div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            </div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a390239a7390ec5d07e31298573bf09bf">s_close_run_time_information_file</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        </div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        </div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        </div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        </div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a5646b1076ff72b2260ebefa3f44d4754">s_close_com_files</a>() <span class="comment">! ---------------------------------------</span></div><div class="line"><a name="l02480"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a5646b1076ff72b2260ebefa3f44d4754"> 2480</a></span>&#160;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>(i)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                    <span class="keyword">CLOSE</span>(i+10)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a5646b1076ff72b2260ebefa3f44d4754">s_close_com_files</a> <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#aa0eb8be31f69888d750e18df197c6011">s_close_cb_files</a>() <span class="comment">! ---------------------------------------</span></div><div class="line"><a name="l02496"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#aa0eb8be31f69888d750e18df197c6011"> 2496</a></span>&#160;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">cb_wrt</a>(i)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    <span class="keyword">CLOSE</span>(i+20)</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#aa0eb8be31f69888d750e18df197c6011">s_close_cb_files</a> <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a4036cc239adda35d59422a3e61bb657e">s_close_probe_files</a>() <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l02512"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a4036cc239adda35d59422a3e61bb657e"> 2512</a></span>&#160;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aa4e0d015d4064b37e132c5088089394d">num_probes</a></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                <span class="keyword">CLOSE</span>(i+30)</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a4036cc239adda35d59422a3e61bb657e">s_close_probe_files</a> <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a>() <span class="comment">! -------------------------</span></div><div class="line"><a name="l02529"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6"> 2529</a></span>&#160;           </div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: ix, iy, iz</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            </div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;            <span class="comment">! Allocating/initializing ICFL, VCFL, CCFL and Rc stability criteria</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                                 <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)); <a class="code" href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">icfl_max</a> = 0d0</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)); <a class="code" href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">vcfl_max</a> = 0d0</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            <span class="keywordflow">IF</span>(    <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 ) <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)); <a class="code" href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">ccfl_max</a> = 0d0</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">ALLOCATE</span>(  <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>));   <a class="code" href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">rc_min</a> = 1d3</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            </div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            </div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="comment">! Associating the procedural pointer to the appropriate subroutine</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <span class="comment">! that will be utilized in the conversion to the mixture variables</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;           </div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span>           <span class="comment">! Volume fraction for bubbles</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;            <span class="comment">! Allocating the generic storage for the flow variable(s) that are</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;            <span class="comment">! going to be written to the CoM data files</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                <span class="comment">! num_fluids, mass, x-loc, y-loc, z-loc, x-vel, y-vel, z-vel, x-acc, y-acc, z-acc</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac5b476661d64159fdcd7364715495f30">q_com</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,10))</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                <span class="comment">! num_fluids, 2 lateral directions, 5 higher moment orders</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#abd8505e33c0dce0f0aba7e27ae53bef5">moments</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,2,5))</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">cb_wrt</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                <span class="comment">! num_fluids, mass for 5 threshold mass fractions, area for 5 threshold mass fractions</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a775b8128a9261b4d095f9132508d309f">cb_mass</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,10))</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                <span class="comment">! num_fluids, 5 threshold mass fractions, xmin, xmax, ymin, ymax, zmin, zmax</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1e7a93a0d32bbc7c691381689771b6f9">bounds</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,5,6))</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                <span class="comment">! num_fluids, centerline dimension for 5 threshold mass fractions</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a4f2a6c0ed44fb82d337013e700479ce5">cntrline</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,5))</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2de4a56202a6e2f47ce657fcda4ecdb4">probe_wrt</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1ccababc9891f8a719df1c52b49e969a">accel_mag</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac465283e56b508af6500bea1ad4c745c">x_accel</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a9170ca95f1f4493fd30a48052ed214a7">y_accel</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#aef4cabc25090173d5817782631af2781">z_accel</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. (<a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a> .OR. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                ix%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; iy%beg = 0; iz%beg = 0</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) iy%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) iz%beg = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                ix%end = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> - ix%beg; iy%end = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> - iy%beg; iz%end = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> - iz%beg</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>(<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(ix%beg:ix%end, &amp;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                                                            iy%beg:iy%end, &amp;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                                            iz%beg:iz%end ))</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(ix%beg:ix%end, &amp;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                                                            iy%beg:iy%end, &amp;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                                                            iz%beg:iz%end ))</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(ix%beg:ix%end, &amp;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                                                            iy%beg:iy%end, &amp;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                                                            iz%beg:iz%end ))</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(ix%beg:ix%end, &amp;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                                                    iy%beg:iy%end, &amp;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                                                    iz%beg:iz%end ))</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf(ix%beg:ix%end, &amp;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                                                     iy%beg:iy%end, &amp;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                                                     iz%beg:iz%end ))</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a>(ix%beg:ix%end,iy%beg:iy%end,iz%beg:iz%end))</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; <a class="code" href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">s_write_serial_data_files</a></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; <a class="code" href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75">s_write_parallel_data_files</a></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            </div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">s_initialize_data_output_module</a> <span class="comment">! -----------------------</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        </div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        </div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        </div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        </div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        </div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a>() <span class="comment">! ---------------------------</span></div><div class="line"><a name="l02630"></a><span class="lineno"><a class="line" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e"> 2630</a></span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;            </div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            <span class="comment">! Deallocating the ICFL, VCFL, CCFL, and Rc stability criteria</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                                 <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">icfl_sf</a>)</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">vcfl_sf</a>)</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            <span class="keywordflow">IF</span>(    <a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 ) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">ccfl_sf</a>)</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            <span class="keywordflow">IF</span>(any(<a class="code" href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">re_size</a> &gt; 0)) <span class="keyword">DEALLOCATE</span>(  <a class="code" href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">rc_sf</a>)</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            </div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;            <span class="comment">! Deallocating the storage employed for the flow variables that</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="comment">! were written to CoM and probe files</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">com_wrt</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac5b476661d64159fdcd7364715495f30">q_com</a>)</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#abd8505e33c0dce0f0aba7e27ae53bef5">moments</a>)</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <span class="keywordflow">IF</span> (any(<a class="code" href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">cb_wrt</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a775b8128a9261b4d095f9132508d309f">cb_mass</a>)</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1e7a93a0d32bbc7c691381689771b6f9">bounds</a>)</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a4f2a6c0ed44fb82d337013e700479ce5">cntrline</a>)</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a2de4a56202a6e2f47ce657fcda4ecdb4">probe_wrt</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1ccababc9891f8a719df1c52b49e969a">accel_mag</a>)</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac465283e56b508af6500bea1ad4c745c">x_accel</a>)</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a9170ca95f1f4493fd30a48052ed214a7">y_accel</a>)</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                        <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#aef4cabc25090173d5817782631af2781">z_accel</a>)</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">we_size</a> &gt; 0 .AND. (<a class="code" href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">we_riemann_flux</a> .OR. <a class="code" href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">we_rhs_flux</a>)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">crv_size</a></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                    <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">crv_idx</a>(i))%sf)</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">grad_x_vf</a>,<a class="code" href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">grad_y_vf</a>,<a class="code" href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">grad_z_vf</a>)</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">norm_vf</a>,<a class="code" href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">kappa_vf</a>)</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">energy</a>)</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="comment">! Disassociating the pointer to the procedure that was utilized to</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="comment">! to convert mixture or species variables to the mixture variables</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; null()</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            <a class="code" href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">s_write_data_files</a> =&gt; null()</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            </div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">s_finalize_data_output_module</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        </div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        </div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        </div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        </div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        </div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__data__output.html">m_data_output</a></div><div class="ttc" id="namespacem__data__output_html_ac21a93203a6e7e5bc4ffb8c1082440ae"><div class="ttname"><a href="namespacem__data__output.html#ac21a93203a6e7e5bc4ffb8c1082440ae">m_data_output::grad_y_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable grad_y_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00118">m_data_output.f90:118</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1e7a93a0d32bbc7c691381689771b6f9"><div class="ttname"><a href="namespacem__data__output.html#a1e7a93a0d32bbc7c691381689771b6f9">m_data_output::bounds</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public bounds</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00115">m_data_output.f90:115</a></div></div>
<div class="ttc" id="namespacem__data__output_html_aef4cabc25090173d5817782631af2781"><div class="ttname"><a href="namespacem__data__output.html#aef4cabc25090173d5817782631af2781">m_data_output::z_accel</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public z_accel</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00117">m_data_output.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d0554c4fef91acf46f683e8bcd29133"><div class="ttname"><a href="namespacem__global__parameters.html#a5d0554c4fef91acf46f683e8bcd29133">m_global_parameters::t_step_old</a></div><div class="ttdeci">integer t_step_old</div><div class="ttdoc">Existing IC/grid folder. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00065">m_global_parameters.f90:65</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_aff7286de058c49b2a5d7a84be1983e8f"><div class="ttname"><a href="namespacem__mpi__proxy.html#aff7286de058c49b2a5d7a84be1983e8f">m_mpi_proxy::s_mpi_allreduce_max</a></div><div class="ttdeci">subroutine s_mpi_allreduce_max(var_loc, var_glb)</div><div class="ttdoc">The following subroutine takes the input local variable from all processors and reduces to the maximu...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01162">m_mpi_proxy.f90:1162</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a6be3381410dd028014de2c1d02b05139"><div class="ttname"><a href="namespacem__data__output.html#a6be3381410dd028014de2c1d02b05139">m_data_output::s_write_com_files</a></div><div class="ttdeci">subroutine, public s_write_com_files(t_step, q_com, moments)</div><div class="ttdoc">This writes a formatted data file where the root processor can write out the CoM information. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l01142">m_data_output.f90:1142</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a629c072bc28e09fe890b966f8adb5f55"><div class="ttname"><a href="namespacem__data__output.html#a629c072bc28e09fe890b966f8adb5f55">m_data_output::vcfl_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable vcfl_sf</div><div class="ttdoc">VCFL stability criterion. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00097">m_data_output.f90:97</a></div></div>
<div class="ttc" id="namespacem__data__output_html"><div class="ttname"><a href="namespacem__data__output.html">m_data_output</a></div><div class="ttdoc">The primary purpose of this module is to output the grid and the conservative variables data at the c...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00041">m_data_output.f90:41</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a29f34883bc8e9d895dbb4232493397a1"><div class="ttname"><a href="namespacem__data__output.html#a29f34883bc8e9d895dbb4232493397a1">m_data_output::s_write_probe_files</a></div><div class="ttdeci">subroutine, public s_write_probe_files(t_step, q_cons_vf, accel_mag)</div><div class="ttdoc">This writes a formatted data file for the flow probe information. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l01860">m_data_output.f90:1860</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00189">m_global_parameters.f90:189</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_abfbc42cea69273bc9fa4a2d78f636eb1"><div class="ttname"><a href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">m_mpi_proxy::s_mpi_barrier</a></div><div class="ttdeci">subroutine s_mpi_barrier()</div><div class="ttdoc">Halts all processes until all have reached barrier. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00154">m_mpi_proxy.f90:154</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1ccababc9891f8a719df1c52b49e969a"><div class="ttname"><a href="namespacem__data__output.html#a1ccababc9891f8a719df1c52b49e969a">m_data_output::accel_mag</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public accel_mag</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00111">m_data_output.f90:111</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ae17a432fc2e0bc9f3a0c0614ea1cd6f8"><div class="ttname"><a href="namespacem__data__output.html#ae17a432fc2e0bc9f3a0c0614ea1cd6f8">m_data_output::norm_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable norm_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00118">m_data_output.f90:118</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a530bdd6416ce213046d14488fb48dbc2"><div class="ttname"><a href="namespacem__global__parameters.html#a530bdd6416ce213046d14488fb48dbc2">m_global_parameters::integral_wrt</a></div><div class="ttdeci">logical integral_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00267">m_global_parameters.f90:267</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ada9b22b5a158b2ce980f43cec00a1ac6"><div class="ttname"><a href="namespacem__data__output.html#ada9b22b5a158b2ce980f43cec00a1ac6">m_data_output::vcfl_max</a></div><div class="ttdeci">real(kind(0d0)) vcfl_max</div><div class="ttdoc">VCFL criterion maximum. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00104">m_data_output.f90:104</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adab11dab474410541d4c37725bea01e1"><div class="ttname"><a href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">m_global_parameters::n_glb</a></div><div class="ttdeci">integer n_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a8ef7ff0b857e6a25f92ddfba6ffdc731"><div class="ttname"><a href="namespacem__data__output.html#a8ef7ff0b857e6a25f92ddfba6ffdc731">m_data_output::energy</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, target energy</div><div class="ttdoc">Energy: Used to write out correct E and p when We_size &gt; 0. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00119">m_data_output.f90:119</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2663d07998d11d25e223cd7ad0bbd748"><div class="ttname"><a href="namespacem__global__parameters.html#a2663d07998d11d25e223cd7ad0bbd748">m_global_parameters::mpi_info_int</a></div><div class="ttdeci">integer mpi_info_int</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00177">m_global_parameters.f90:177</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa75fcd53fdc4fb58ca0fbc2cc9678673"><div class="ttname"><a href="namespacem__global__parameters.html#aa75fcd53fdc4fb58ca0fbc2cc9678673">m_global_parameters::z_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target z_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00092">m_global_parameters.f90:92</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa4e0d015d4064b37e132c5088089394d"><div class="ttname"><a href="namespacem__global__parameters.html#aa4e0d015d4064b37e132c5088089394d">m_global_parameters::num_probes</a></div><div class="ttdeci">integer num_probes</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00268">m_global_parameters.f90:268</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1ca202582d46c282b83b5510e6b6d626"><div class="ttname"><a href="namespacem__data__output.html#a1ca202582d46c282b83b5510e6b6d626">m_data_output::icfl_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable icfl_sf</div><div class="ttdoc">ICFL stability criterion. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00096">m_data_output.f90:96</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1b71fe1b222b55aa5315838816902b33"><div class="ttname"><a href="namespacem__data__output.html#a1b71fe1b222b55aa5315838816902b33">m_data_output::kappa_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable kappa_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00118">m_data_output.f90:118</a></div></div>
<div class="ttc" id="namespacem__data__output_html_af469c3d867d96eb1ca255832e586ec97"><div class="ttname"><a href="namespacem__data__output.html#af469c3d867d96eb1ca255832e586ec97">m_data_output::s_open_probe_files</a></div><div class="ttdeci">subroutine, public s_open_probe_files()</div><div class="ttdoc">This opens a formatted data file where the root processor can write out flow probe information...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00362">m_data_output.f90:362</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc2bc27e809a773b7f5a6a65edac3b89"><div class="ttname"><a href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">m_global_parameters::dy</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dy</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdoc">Number of eq. bubble sizes. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00282">m_global_parameters.f90:282</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00277">m_global_parameters.f90:277</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00186">m_global_parameters.f90:186</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a800c19cad11fe2774ac137b12ec89e33"><div class="ttname"><a href="namespacem__global__parameters.html#a800c19cad11fe2774ac137b12ec89e33">m_global_parameters::x_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target x_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00092">m_global_parameters.f90:92</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ac465283e56b508af6500bea1ad4c745c"><div class="ttname"><a href="namespacem__data__output.html#ac465283e56b508af6500bea1ad4c745c">m_data_output::x_accel</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public x_accel</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00117">m_data_output.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af7508eba0a53c9a35913a502d58dfb54"><div class="ttname"><a href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">m_global_parameters::dx</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ab65b312ef83adb104cafafada9c998b6"><div class="ttname"><a href="namespacem__data__output.html#ab65b312ef83adb104cafafada9c998b6">m_data_output::s_initialize_data_output_module</a></div><div class="ttdeci">subroutine, public s_initialize_data_output_module()</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02529">m_data_output.f90:2529</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a40724c992117a24479573d9fbcdfa21b"><div class="ttname"><a href="namespacem__data__output.html#a40724c992117a24479573d9fbcdfa21b">m_data_output::s_write_cb_files</a></div><div class="ttdeci">subroutine, public s_write_cb_files(t_step, cb_mass, bounds, cntrline)</div><div class="ttdoc">The goal of this subroutine is to output coherent body information. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l01412">m_data_output.f90:1412</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a5646b1076ff72b2260ebefa3f44d4754"><div class="ttname"><a href="namespacem__data__output.html#a5646b1076ff72b2260ebefa3f44d4754">m_data_output::s_close_com_files</a></div><div class="ttdeci">subroutine, public s_close_com_files()</div><div class="ttdoc">Closes communication files. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02480">m_data_output.f90:2480</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99557d578d538a853b5fd9e445ad6303"><div class="ttname"><a href="namespacem__global__parameters.html#a99557d578d538a853b5fd9e445ad6303">m_global_parameters::we_riemann_flux</a></div><div class="ttdeci">logical we_riemann_flux</div><div class="ttdoc">Account for capillary effects in the Riemann solver. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a028c7e09aaa23dc9ee8844febffed3af"><div class="ttname"><a href="namespacem__global__parameters.html#a028c7e09aaa23dc9ee8844febffed3af">m_global_parameters::probe</a></div><div class="ttdeci">type(probe_parameters), dimension(num_probes_max) probe</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00270">m_global_parameters.f90:270</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a36714d4cf746d5beb2736752fdd6d747"><div class="ttname"><a href="namespacem__data__output.html#a36714d4cf746d5beb2736752fdd6d747">m_data_output::s_open_com_files</a></div><div class="ttdeci">subroutine, public s_open_com_files()</div><div class="ttdoc">This opens a formatted data file where the root processor can write out the CoM information. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00227">m_data_output.f90:227</a></div></div>
<div class="ttc" id="namespacem__compile__specific_html"><div class="ttname"><a href="namespacem__compile__specific.html">m_compile_specific</a></div><div class="ttdoc">This module contains subroutines that are compiler specific. </div><div class="ttdef"><b>Definition:</b> <a href="m__compile__specific_8f90_source.html#l00035">m_compile_specific.f90:35</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a873520062481f3dabcfa77f9bd7728d3"><div class="ttname"><a href="namespacem__mpi__proxy.html#a873520062481f3dabcfa77f9bd7728d3">m_mpi_proxy::s_mpi_allreduce_sum</a></div><div class="ttdeci">subroutine s_mpi_allreduce_sum(var_loc, var_glb)</div><div class="ttdoc">The following subroutine takes the input local variable from all processors and reduces to the sum of...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01122">m_mpi_proxy.f90:1122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1072f221ca8e41b0ea3240b33374cc1e"><div class="ttname"><a href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">m_global_parameters::p_glb</a></div><div class="ttdeci">integer p_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac60a57ea5298dde379e24b6b77762101"><div class="ttname"><a href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">m_global_parameters::regularization</a></div><div class="ttdeci">logical regularization</div><div class="ttdoc">Regularization terms of Tiwari (2013) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0d20192b0175dc677ba88b14bf0d5104"><div class="ttname"><a href="namespacem__global__parameters.html#a0d20192b0175dc677ba88b14bf0d5104">m_global_parameters::we_idx</a></div><div class="ttdeci">integer, dimension(:,:), allocatable we_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac1d4fc341c170b243af0d776ad7ede02"><div class="ttname"><a href="namespacem__global__parameters.html#ac1d4fc341c170b243af0d776ad7ede02">m_global_parameters::integral</a></div><div class="ttdeci">type(integral_parameters), dimension(num_probes_max) integral</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00271">m_global_parameters.f90:271</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a411af1336ca1bc899d3b7352d9383a81"><div class="ttname"><a href="namespacem__data__output.html#a411af1336ca1bc899d3b7352d9383a81">m_data_output::s_open_cb_files</a></div><div class="ttdeci">subroutine, public s_open_cb_files()</div><div class="ttdoc">This opens a formatted data file where the root processor can write out the coherent body (cb) inform...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00324">m_data_output.f90:324</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99ba7e33a1870ac89386d376e0d20526"><div class="ttname"><a href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">m_global_parameters::dflt_real</a></div><div class="ttdeci">real(kind(0d0)), parameter dflt_real</div><div class="ttdoc">Default real value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__data__output_html_aa0eb8be31f69888d750e18df197c6011"><div class="ttname"><a href="namespacem__data__output.html#aa0eb8be31f69888d750e18df197c6011">m_data_output::s_close_cb_files</a></div><div class="ttdeci">subroutine, public s_close_cb_files()</div><div class="ttdoc">Closes coherent body files. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02496">m_data_output.f90:2496</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">The number of cells that are necessary to be able to store enough boundary conditions data to march t...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a33a72559ec5cfdedf7162a8269d41201"><div class="ttname"><a href="namespacem__data__output.html#a33a72559ec5cfdedf7162a8269d41201">m_data_output::s_write_run_time_information</a></div><div class="ttdeci">subroutine, public s_write_run_time_information(q_prim_vf, t_step)</div><div class="ttdoc">The goal of the procedure is to output to the run-time information file the stability criteria extrem...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00421">m_data_output.f90:421</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a613c09e8438e535e8c13f15282493793"><div class="ttname"><a href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_mixture_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00188">m_variables_conversion.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acfd358e345eac06daf89ca40651ba2c8"><div class="ttname"><a href="namespacem__global__parameters.html#acfd358e345eac06daf89ca40651ba2c8">m_global_parameters::we_rhs_flux</a></div><div class="ttdeci">logical we_rhs_flux</div><div class="ttdoc">Account for capillary effects using the conservative formulation in RHS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00149">m_global_parameters.f90:149</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a02f2b04a434c1f0ebf9156147d0f976e"><div class="ttname"><a href="namespacem__data__output.html#a02f2b04a434c1f0ebf9156147d0f976e">m_data_output::s_finalize_data_output_module</a></div><div class="ttdeci">subroutine, public s_finalize_data_output_module()</div><div class="ttdoc">Module deallocation and/or disassociation procedures. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02630">m_data_output.f90:2630</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0a67704d4c227871a155d6c26590f685"><div class="ttname"><a href="namespacem__global__parameters.html#a0a67704d4c227871a155d6c26590f685">m_global_parameters::re_size</a></div><div class="ttdeci">integer, dimension(2) re_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in system of eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af329319354912b90787e0dff7cdc8a37"><div class="ttname"><a href="namespacem__global__parameters.html#af329319354912b90787e0dff7cdc8a37">m_global_parameters::we_size</a></div><div class="ttdeci">integer we_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00209">m_global_parameters.f90:209</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00187">m_global_parameters.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a5b33b9c60a91e08f0e67da2de15e7d6d"><div class="ttname"><a href="namespacem__data__output.html#a5b33b9c60a91e08f0e67da2de15e7d6d">m_data_output::grad_z_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable grad_z_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00118">m_data_output.f90:118</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ff480000eaa7af51481d0f17b78423"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ff480000eaa7af51481d0f17b78423">m_global_parameters::ptil</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable ptil</div><div class="ttdoc">Pressure modification. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00295">m_global_parameters.f90:295</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00191">m_global_parameters.f90:191</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4ddb20fdeec324ed6100359e83111a7c"><div class="ttname"><a href="namespacem__global__parameters.html#a4ddb20fdeec324ed6100359e83111a7c">m_global_parameters::moment_order</a></div><div class="ttdeci">integer, dimension(5) moment_order</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00273">m_global_parameters.f90:273</a></div></div>
<div class="ttc" id="namespacem__data__output_html_ac5b476661d64159fdcd7364715495f30"><div class="ttname"><a href="namespacem__data__output.html#ac5b476661d64159fdcd7364715495f30">m_data_output::q_com</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public q_com</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00112">m_data_output.f90:112</a></div></div>
<div class="ttc" id="namespacem__data__output_html_adb7a215382fddf4e405b97cd2f1ddf0d"><div class="ttname"><a href="namespacem__data__output.html#adb7a215382fddf4e405b97cd2f1ddf0d">m_data_output::rc_min</a></div><div class="ttdeci">real(kind(0d0)) rc_min</div><div class="ttdoc">Rc criterion maximum. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00106">m_data_output.f90:106</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a38317a39628eb007769f26f29b70c958"><div class="ttname"><a href="namespacem__global__parameters.html#a38317a39628eb007769f26f29b70c958">m_global_parameters::threshold_mf</a></div><div class="ttdeci">real(kind(0d0)), dimension(5) threshold_mf</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00272">m_global_parameters.f90:272</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4bb8b661a170fc6ccd9fa3cc4b32c960"><div class="ttname"><a href="namespacem__global__parameters.html#a4bb8b661a170fc6ccd9fa3cc4b32c960">m_global_parameters::y_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00092">m_global_parameters.f90:92</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6ed5e5561c16f30a4010f6612877029d"><div class="ttname"><a href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">m_global_parameters::precision</a></div><div class="ttdeci">integer precision</div><div class="ttdoc">Precision of output files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00163">m_global_parameters.f90:163</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad80f68aac31aa898ab2d7729f60e375f"><div class="ttname"><a href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">m_global_parameters::mpi_io_data</a></div><div class="ttdeci">type(mpi_io_var), public mpi_io_data</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00172">m_global_parameters.f90:172</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a40d8d6be32c01d80e224dcae55f6ee50"><div class="ttname"><a href="namespacem__data__output.html#a40d8d6be32c01d80e224dcae55f6ee50">m_data_output::grad_x_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable grad_x_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00118">m_data_output.f90:118</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a04c6b0f01b8561e248a740b017fc4f7d"><div class="ttname"><a href="namespacem__data__output.html#a04c6b0f01b8561e248a740b017fc4f7d">m_data_output::s_write_serial_data_files</a></div><div class="ttdeci">subroutine, public s_write_serial_data_files(q_cons_vf, t_step)</div><div class="ttdoc">The goal of this subroutine is to output the grid and conservative variables data files for given tim...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00720">m_data_output.f90:720</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f2d413d9739928f8e1a98f0a5783ab9"><div class="ttname"><a href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">m_global_parameters::grid_geometry</a></div><div class="ttdeci">integer grid_geometry</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00087">m_global_parameters.f90:87</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a4f2a6c0ed44fb82d337013e700479ce5"><div class="ttname"><a href="namespacem__data__output.html#a4f2a6c0ed44fb82d337013e700479ce5">m_data_output::cntrline</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public cntrline</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00116">m_data_output.f90:116</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a9170ca95f1f4493fd30a48052ed214a7"><div class="ttname"><a href="namespacem__data__output.html#a9170ca95f1f4493fd30a48052ed214a7">m_data_output::y_accel</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public y_accel</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00117">m_data_output.f90:117</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0b91e533fe3b3e112c42af4024014544"><div class="ttname"><a href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">m_global_parameters::case_dir</a></div><div class="ttdeci">character(len=path_len) case_dir</div><div class="ttdoc">Case folder location. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00063">m_global_parameters.f90:63</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a660d600ba9338118f6992a0d76bd6a68"><div class="ttname"><a href="namespacem__data__output.html#a660d600ba9338118f6992a0d76bd6a68">m_data_output::ccfl_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable ccfl_sf</div><div class="ttdoc">CCFL stability criterion. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00098">m_data_output.f90:98</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a30e6fe4c4ff6a8cfefa1bf882dc2e90e"><div class="ttname"><a href="namespacem__global__parameters.html#a30e6fe4c4ff6a8cfefa1bf882dc2e90e">m_global_parameters::crv_size</a></div><div class="ttdeci">integer crv_size</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00217">m_global_parameters.f90:217</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abe0d038aac3b3f0166c1a0c93c497e33"><div class="ttname"><a href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables_bubbles(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00226">m_variables_conversion.f90:226</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate mixture sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00139">m_global_parameters.f90:139</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4713c1e89eaa8fac3bb2181ba87b192"><div class="ttname"><a href="namespacem__global__parameters.html#ad4713c1e89eaa8fac3bb2181ba87b192">m_global_parameters::mpiiofs</a></div><div class="ttdeci">character(len=name_len) mpiiofs</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00176">m_global_parameters.f90:176</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a700c4b4763b7c2c1479fc05a658fa28d"><div class="ttname"><a href="namespacem__data__output.html#a700c4b4763b7c2c1479fc05a658fa28d">m_data_output::rc_sf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable rc_sf</div><div class="ttdoc">Rc stability criterion. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00099">m_data_output.f90:99</a></div></div>
<div class="ttc" id="interfacem__data__output_1_1s__write__abstract__data__files_html"><div class="ttname"><a href="interfacem__data__output_1_1s__write__abstract__data__files.html">m_data_output::s_write_abstract_data_files</a></div><div class="ttdoc">Write data files. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00082">m_data_output.f90:82</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00277">m_global_parameters.f90:277</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a9c1271b2c588c1ae3275791d41550f75"><div class="ttname"><a href="namespacem__data__output.html#a9c1271b2c588c1ae3275791d41550f75">m_data_output::s_write_parallel_data_files</a></div><div class="ttdeci">subroutine, public s_write_parallel_data_files(q_cons_vf, t_step)</div><div class="ttdoc">The goal of this subroutine is to output the grid and conservative variables data files for given tim...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l01054">m_data_output.f90:1054</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7fa880b937b54214312469a34268b883"><div class="ttname"><a href="namespacem__global__parameters.html#a7fa880b937b54214312469a34268b883">m_global_parameters::dt</a></div><div class="ttdeci">real(kind(0d0)) dt</div><div class="ttdoc">Size of the time-step. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00106">m_global_parameters.f90:106</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aafb65952c33f1c363d1040bde29734ea"><div class="ttname"><a href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">m_global_parameters::num_procs</a></div><div class="ttdeci">integer num_procs</div><div class="ttdoc">Number of processors. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00054">m_global_parameters.f90:54</a></div></div>
<div class="ttc" id="namespacem__data__output_html_abd8505e33c0dce0f0aba7e27ae53bef5"><div class="ttname"><a href="namespacem__data__output.html#abd8505e33c0dce0f0aba7e27ae53bef5">m_data_output::moments</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, public moments</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00113">m_data_output.f90:113</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7b7945c133bf17eb1f25468a6d1a6925"><div class="ttname"><a href="namespacem__global__parameters.html#a7b7945c133bf17eb1f25468a6d1a6925">m_global_parameters::crv_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable crv_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00218">m_global_parameters.f90:218</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a178b41597f79f2c0a42c0d6e65275b71"><div class="ttname"><a href="namespacem__data__output.html#a178b41597f79f2c0a42c0d6e65275b71">m_data_output::s_remove_capillary_potential_energy</a></div><div class="ttdeci">subroutine s_remove_capillary_potential_energy(v_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00995">m_data_output.f90:995</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2ed9e718df8c2a250e5d8cce2e04cbb7"><div class="ttname"><a href="namespacem__global__parameters.html#a2ed9e718df8c2a250e5d8cce2e04cbb7">m_global_parameters::cb_wrt</a></div><div class="ttdeci">logical, dimension(num_fluids_max) cb_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00265">m_global_parameters.f90:265</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a4036cc239adda35d59422a3e61bb657e"><div class="ttname"><a href="namespacem__data__output.html#a4036cc239adda35d59422a3e61bb657e">m_data_output::s_close_probe_files</a></div><div class="ttdeci">subroutine, public s_close_probe_files()</div><div class="ttdoc">Closes probe files. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02512">m_data_output.f90:2512</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2de4a56202a6e2f47ce657fcda4ecdb4"><div class="ttname"><a href="namespacem__global__parameters.html#a2de4a56202a6e2f47ce657fcda4ecdb4">m_global_parameters::probe_wrt</a></div><div class="ttdeci">logical probe_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00266">m_global_parameters.f90:266</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a340a2c9b1688582ee485dd5d9bbcc864"><div class="ttname"><a href="namespacem__mpi__proxy.html#a340a2c9b1688582ee485dd5d9bbcc864">m_mpi_proxy::s_mpi_reduce_stability_criteria_extrema</a></div><div class="ttdeci">subroutine s_mpi_reduce_stability_criteria_extrema(icfl_max_loc, vcfl_max_loc, ccfl_max_loc, Rc_min_loc, icfl_max_glb, vcfl_max_glb, ccfl_max_glb, Rc_min_glb)</div><div class="ttdoc">The goal of this subroutine is to determine the global extrema of the stability criteria in the compu...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01076">m_mpi_proxy.f90:1076</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a08a5f85ca151336658398a0eccc93cb4"><div class="ttname"><a href="namespacem__data__output.html#a08a5f85ca151336658398a0eccc93cb4">m_data_output::icfl_max</a></div><div class="ttdeci">real(kind(0d0)) icfl_max</div><div class="ttdoc">ICFL criterion maximum. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00103">m_data_output.f90:103</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0670171466cd1ce584495face34cc4de"><div class="ttname"><a href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, k, l, r)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00306">m_variables_conversion.f90:306</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4e160df8d0de7ea1801a1ca29f8e9b0"><div class="ttname"><a href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_global_parameters::m_glb</a></div><div class="ttdeci">integer m_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a775b8128a9261b4d095f9132508d309f"><div class="ttname"><a href="namespacem__data__output.html#a775b8128a9261b4d095f9132508d309f">m_data_output::cb_mass</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, public cb_mass</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00114">m_data_output.f90:114</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a050b4b01f11c1d352f55b46b6514634d"><div class="ttname"><a href="namespacem__data__output.html#a050b4b01f11c1d352f55b46b6514634d">m_data_output::s_open_run_time_information_file</a></div><div class="ttdeci">subroutine, public s_open_run_time_information_file()</div><div class="ttdoc">The purpose of this subroutine is to open a new or pre- existing run-time information file and append...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00136">m_data_output.f90:136</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aadeb708160fdfee48fe55e83e41b5064"><div class="ttname"><a href="namespacem__global__parameters.html#aadeb708160fdfee48fe55e83e41b5064">m_global_parameters::fourier_rings</a></div><div class="ttdeci">integer, parameter fourier_rings</div><div class="ttdoc">Fourier filter ring limit. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00062">m_global_parameters.f90:62</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a390239a7390ec5d07e31298573bf09bf"><div class="ttname"><a href="namespacem__data__output.html#a390239a7390ec5d07e31298573bf09bf">m_data_output::s_close_run_time_information_file</a></div><div class="ttdeci">subroutine, public s_close_run_time_information_file()</div><div class="ttdoc">The goal of this subroutine is to write to the run-time information file basic footer information app...</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l02449">m_data_output.f90:2449</a></div></div>
<div class="ttc" id="namespacem__compile__specific_html_aa7f14da74305c1d061ce326b16a3263e"><div class="ttname"><a href="namespacem__compile__specific.html#aa7f14da74305c1d061ce326b16a3263e">m_compile_specific::my_inquire</a></div><div class="ttdeci">subroutine my_inquire(fileloc, dircheck)</div><div class="ttdoc">Inquires on the existence of a directory. </div><div class="ttdef"><b>Definition:</b> <a href="m__compile__specific_8f90_source.html#l00045">m_compile_specific.f90:45</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a36d8d56515556bc34bc0c88da60f6b62"><div class="ttname"><a href="namespacem__global__parameters.html#a36d8d56515556bc34bc0c88da60f6b62">m_global_parameters::com_wrt</a></div><div class="ttdeci">logical, dimension(num_fluids_max) com_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00265">m_global_parameters.f90:265</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a04ac565bad2b22dc045a5eeb4f516e2e"><div class="ttname"><a href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">m_mpi_proxy::s_mpi_abort</a></div><div class="ttdeci">subroutine s_mpi_abort()</div><div class="ttdoc">The subroutine terminates the MPI execution environment. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00104">m_mpi_proxy.f90:104</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a04878814b8097100a179152ba853262a"><div class="ttname"><a href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">m_global_parameters::dz</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dz</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a2ff35ede51e90c483969e44c31303415"><div class="ttname"><a href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">m_mpi_proxy::s_initialize_mpi_data</a></div><div class="ttdeci">subroutine s_initialize_mpi_data(q_cons_vf)</div><div class="ttdoc">The subroutine that initializes MPI data structures. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00116">m_mpi_proxy.f90:116</a></div></div>
<div class="ttc" id="namespacem__data__output_html_afc429263f629a2ba4b5655dec5fd2509"><div class="ttname"><a href="namespacem__data__output.html#afc429263f629a2ba4b5655dec5fd2509">m_data_output::ccfl_max</a></div><div class="ttdeci">real(kind(0d0)) ccfl_max</div><div class="ttdoc">CCFL criterion maximum. </div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00105">m_data_output.f90:105</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7a86e6e9d4c8b59d28b7404d836fdee8"><div class="ttname"><a href="namespacem__global__parameters.html#a7a86e6e9d4c8b59d28b7404d836fdee8">m_global_parameters::num_integrals</a></div><div class="ttdeci">integer num_integrals</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00269">m_global_parameters.f90:269</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac127ac2a9036e1cdb7e6c41159cacdfb"><div class="ttname"><a href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">m_global_parameters::parallel_io</a></div><div class="ttdeci">logical parallel_io</div><div class="ttdoc">Format of the data files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00162">m_global_parameters.f90:162</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aac1a5a73b1eae759c913983b38047167"><div class="ttname"><a href="namespacem__global__parameters.html#aac1a5a73b1eae759c913983b38047167">m_global_parameters::s_comp_n_from_cons</a></div><div class="ttdeci">subroutine s_comp_n_from_cons(vftmp, nRtmp, ntmp)</div><div class="ttdoc">Computes the bubble number density n from the conservative variables . </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l01051">m_global_parameters.f90:1051</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__data__output_html_a1ba4e8126b198fb2147d4d9b60f74e44"><div class="ttname"><a href="namespacem__data__output.html#a1ba4e8126b198fb2147d4d9b60f74e44">m_data_output::s_write_data_files</a></div><div class="ttdeci">procedure(s_write_abstract_data_files), pointer, public s_write_data_files</div><div class="ttdef"><b>Definition:</b> <a href="m__data__output_8f90_source.html#l00123">m_data_output.f90:123</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a953abb55b23caddc730076fa837a8063"><div class="ttname"><a href="namespacem__variables__conversion.html#a953abb55b23caddc730076fa837a8063">m_variables_conversion::s_compute_lsq_gradient_curvature</a></div><div class="ttdeci">subroutine, public s_compute_lsq_gradient_curvature(v_vf, grad_x_vf, grad_y_vf, grad_z_vf, norm_vf, kappa_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l01328">m_variables_conversion.f90:1328</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac8252b115e717c6f1c8595be6f897df7"><div class="ttname"><a href="namespacem__global__parameters.html#ac8252b115e717c6f1c8595be6f897df7">m_global_parameters::name_len</a></div><div class="ttdeci">integer, parameter name_len</div><div class="ttdoc">Maximum name length. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00057">m_global_parameters.f90:57</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4e4e3806190a62a77cf6542f6d07dbbd"><div class="ttname"><a href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">m_global_parameters::dflt_int</a></div><div class="ttdeci">integer, parameter dflt_int</div><div class="ttdoc">Default integer value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00060">m_global_parameters.f90:60</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a21765a90c01d221524670d1344b126cd"><div class="ttname"><a href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">m_global_parameters::pi</a></div><div class="ttdeci">real(kind(0d0)), parameter pi</div><div class="ttdoc">Pi. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00320">m_global_parameters.f90:320</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type annexing beginning and ending bounds information. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00064">m_derived_types.f90:64</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a383c6ff025d4ea09ddd4e2356042d86b"><div class="ttname"><a href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">m_global_parameters::proc_rank</a></div><div class="ttdeci">integer proc_rank</div><div class="ttdoc">Rank of the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00072">m_global_parameters.f90:72</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">The module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00061">m_global_parameters.f90:61</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3981c7e6886ba3cde245ce4dcc6ca664"><div class="ttname"><a href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">m_global_parameters::mixture_err</a></div><div class="ttdeci">logical mixture_err</div><div class="ttdoc">Mixture properties correction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00143">m_global_parameters.f90:143</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdoc">Bubbles on/off. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00290">m_global_parameters.f90:290</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__data__output_8f90.html">m_data_output.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
