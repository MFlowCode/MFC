<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Simulation: m_cbc.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Simulation
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__cbc_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_cbc.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__cbc_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespacem__cbc.html">   49</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__cbc.html">m_cbc</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>        !&lt; definitions of the derived types</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>    !&lt; definitions of the global parameters</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a> !&lt; state variables type conversion procedures</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    </div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">PRIVATE</span>; <span class="keywordtype">PUBLIC</span> :: <a class="code" href="namespacem__cbc.html#a0afb287e68b0d1d970fd073849525c36">s_initialize_cbc_module</a>, <a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>, <a class="code" href="namespacem__cbc.html#a76b737dff5c827677888ffde0aff9cf1">s_finalize_cbc_module</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    abstract <span class="keyword">INTERFACE</span> <span class="comment">! =======================================================</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        </div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="interfacem__cbc_1_1s__compute__abstract___l.html">   79</a></span>&#160;<span class="keyword">        SUBROUTINE </span>s_compute_abstract_l(dflt_int)</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="interfacem__cbc_1_1s__compute__abstract___l.html#a0da994a6412d8725ee77753ebfcdbd86">   80</a></span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">        END SUBROUTINE </span>s_compute_abstract_l</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">    END INTERFACE </span><span class="comment">! ============================================================</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">   88</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">   93</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>, <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">   97</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>, <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">  103</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">alpha_rho</a></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">  104</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">  105</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">  106</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a4e9565add4d8b423cbcecb0da55e232c">  107</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#a4e9565add4d8b423cbcecb0da55e232c">e</a></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#afef2a31e21e4f17b6852005a08ee86ce">  108</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#afef2a31e21e4f17b6852005a08ee86ce">h</a></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">  109</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">  110</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span>   :: <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">  111</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">gamma</a></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a2187e55d648bf7c40be489b5a2b75ca7">  112</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#a2187e55d648bf7c40be489b5a2b75ca7">pi_inf</a></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">  113</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                              :: <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#af36bd73bae305dd791c6da0a37d2f6f8">  114</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>,              <span class="keywordtype">DIMENSION(2)</span>   :: <a class="code" href="namespacem__cbc.html#af36bd73bae305dd791c6da0a37d2f6f8">re</a></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">  115</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">we</a></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">  117</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">  118</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> ::       <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">  119</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>                            ::      <a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">  120</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> ::       <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">  125</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>,              <span class="keywordtype">DIMENSION(3)</span> :: <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">  126</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">  129</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">! CBC Coefficients =========================================================</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">  133</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">  134</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">  135</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">  140</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">POINTER</span>, <span class="keywordtype">DIMENSION(:,:)</span> :: <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a> =&gt; null()</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    </div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">  142</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">  143</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">  144</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">TARGET</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">  149</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">POINTER</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a> =&gt; null()</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">  154</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(s_compute_abstract_l), <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; null() </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">  158</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>,<a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>,<a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a0afb287e68b0d1d970fd073849525c36">s_initialize_cbc_module</a>() <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a0afb287e68b0d1d970fd073849525c36">  167</a></span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">IF</span>(              all((/<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg,<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end/) &gt; -5)  &amp;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                    .AND.                     &amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. all((/<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg,<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end/) &gt; -5)) &amp;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                    .AND.                     &amp;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0 .AND. all((/<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg,<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end/) &gt; -5)) ) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">! Allocating the cell-average primitive variables</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">! Allocating the cell-average and cell-boundary-average fluxes</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keyword">ALLOCATE</span>(   <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>),    <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>), <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">! Allocating the cell-average partial densities, the velocity, the</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">! advected variables, the mass fractions, as well as Weber numbers</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">alpha_rho</a>(1: <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end ))</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keyword">ALLOCATE</span>(      <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(1:   <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>   ))</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keyword">ALLOCATE</span>(      <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>(1:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keyword">ALLOCATE</span>(       <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(1: <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end ))</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">we</a>(1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>,1:<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            </div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="comment">! Allocating the first-order spatial derivatives in the s-direction</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">! of the partial densities, the velocity and the advected variables</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(1: <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end ))</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keyword">ALLOCATE</span>(      <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(1:  <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>    ))</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keyword">ALLOCATE</span>(      <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(1:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>))</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">! Allocating L, see Thompson (1987, 1990)</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end))</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">! Allocating the cell-width distribution in the s-direction</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="comment">! Allocating/Computing CBC Coefficients in x-direction =============</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">IF</span>(all((/<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg,<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1: 1))</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1: 1))</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(1,-1)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(1, 1)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1:-1))</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1:-1))</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(1,-1)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, 1: 1))</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3, 1: 1))</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(1, 1)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">! Allocating/Computing CBC Coefficients in y-direction =============</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">IF</span>(all((/<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg,<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1: 1))</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    </div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1: 1))</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(2,-1)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(2, 1)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1:-1))</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1:-1))</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(2,-1)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, 1: 1))</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3, 1: 1))</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(2, 1)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">! Allocating/Computing CBC Coefficients in z-direction =============</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">IF</span>(all((/<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg,<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1: 1))</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1: 1))</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(3,-1)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(3, 1)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,-1:-1))</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    </div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3,-1:-1))</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(3,-1)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end &lt;= -5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, 1: 1))</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a>(0:<a class="code" href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">weno_polyn</a>-1,0:<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>-3, 1: 1))</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(3, 1)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    </div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            </div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">! Associating the procedural pointer to the appropriate subroutine</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="comment">! that will be utilized in the conversion to the mixture variables</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">s_convert_mixture_to_mixture_variables</a></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">s_convert_species_to_mixture_variables_bubbles</a>    </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">ELSE</span>                            <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; &amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                             <a class="code" href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">s_convert_species_to_mixture_variables</a></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a0afb287e68b0d1d970fd073849525c36">s_initialize_cbc_module</a> <span class="comment">! -------------------------------</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a>(cbc_dir, cbc_loc) <span class="comment">! --------------</span></div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">  344</a></span>&#160;        <span class="comment">! Description: The purpose of this subroutine is to compute the grid</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">!              dependent FD and PI coefficients, or CBC coefficients,</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">!              provided the CBC coordinate direction and location.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            </div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">! CBC coordinate direction and location</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cbc_dir, cbc_loc</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="comment">! Cell-boundary locations in the s-direction</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(0:buff_size+1)</span> :: s_cb</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">! Generic loop iterator</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">! Associating CBC coefficients pointers</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">s_associate_cbc_coefficients_pointers</a>(cbc_dir, cbc_loc)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            </div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="comment">! Determining the cell-boundary locations in the s-direction</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            s_cb(0) = 0d0</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            </div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                s_cb(i+1) = s_cb(i) + <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="comment">! Computing CBC1 Coefficients ======================================</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                </div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(:,cbc_loc) =  0d0</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc) = -2d0/(<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)+<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(1))</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(1,cbc_loc) = -<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            </div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="comment">! Computing CBC2 Coefficients ======================================</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(:,cbc_loc) =  0d0</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc) = -6d0/(3d0*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)+2d0*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(1)-<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(2))</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(1,cbc_loc) = -4d0*<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/3d0</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(2,cbc_loc) =      <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/3d0</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,0,cbc_loc) = (s_cb(0)-s_cb(1))/(s_cb(0)-s_cb(2))</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                </div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">! Computing CBC4 Coefficients ======================================</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(:,cbc_loc) =  0d0</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc) = -50d0/(25d0*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)+2d0*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(1) &amp;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                           - 1d1*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(2)+1d1*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(3) &amp;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                           - 3d0*<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(4)           )</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(1,cbc_loc) = -48d0*<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/25d0</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(2,cbc_loc) =  36d0*<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/25d0</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(3,cbc_loc) = -16d0*<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/25d0</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(4,cbc_loc) =   3d0*<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(0,cbc_loc)/25d0</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,0,cbc_loc) = &amp;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            ((s_cb(0)-s_cb(1))*(s_cb(1)-s_cb(2))  * &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            (s_cb(1)-s_cb(3)))/((s_cb(1)-s_cb(4)) * &amp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            (s_cb(4)-s_cb(0))*(s_cb(4)-s_cb(2)))</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,1,cbc_loc) = &amp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                            ((s_cb(1)-s_cb(0))*(s_cb(1)-s_cb(2))  * &amp;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                            ((s_cb(1)-s_cb(3))*(s_cb(1)-s_cb(3))  - &amp;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                            (s_cb(0)-s_cb(4))*((s_cb(3)-s_cb(1))  + &amp;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                            (s_cb(4)-s_cb(1)))))                  / &amp;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                            ((s_cb(0)-s_cb(3))*(s_cb(1)-s_cb(3))  * &amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            (s_cb(0)-s_cb(4))*(s_cb(1)-s_cb(4)))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,2,cbc_loc) = &amp;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            (s_cb(1)-s_cb(0))*((s_cb(1)-s_cb(2))  * &amp;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                            (s_cb(1)-s_cb(3))+((s_cb(0)-s_cb(2))  + &amp;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            (s_cb(1)-s_cb(3)))*(s_cb(0)-s_cb(4))) / &amp;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            ((s_cb(2)-s_cb(0))*(s_cb(0)-s_cb(3))  * &amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                            (s_cb(0)-s_cb(4)))</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(1,0,cbc_loc) = &amp;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                            ((s_cb(0)-s_cb(2))*(s_cb(2)-s_cb(1))  * &amp;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                            (s_cb(2)-s_cb(3)))/((s_cb(2)-s_cb(4)) * &amp;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            (s_cb(4)-s_cb(0))*(s_cb(4)-s_cb(1)))</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(1,1,cbc_loc) = &amp;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            ((s_cb(0)-s_cb(2))*(s_cb(1)-s_cb(2))  * &amp;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            ((s_cb(1)-s_cb(3))*(s_cb(2)-s_cb(3))  + &amp;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                            (s_cb(0)-s_cb(4))*((s_cb(1)-s_cb(3))  + &amp;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                            (s_cb(2)-s_cb(4)))))                  / &amp;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                            ((s_cb(0)-s_cb(3))*(s_cb(1)-s_cb(3))  * &amp;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                            (s_cb(0)-s_cb(4))*(s_cb(1)-s_cb(4)))</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(1,2,cbc_loc) = &amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            ((s_cb(1)-s_cb(2))*(s_cb(2)-s_cb(3))  * &amp;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                            (s_cb(2)-s_cb(4)))/((s_cb(0)-s_cb(2)) * &amp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                            (s_cb(0)-s_cb(3))*(s_cb(0)-s_cb(4)))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="comment">! END: Computing CBC4 Coefficients =================================</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="comment">! Nullifying CBC coefficients</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>, <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">s_compute_cbc_coefficients</a> <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        </div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">!!  The goal of the procedure is to associate the FD and PI</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">!!      coefficients, or CBC coefficients, with the appropriate</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">!!      targets, based on the coordinate direction and location</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">!!      of the CBC.</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">!!  @param cbc_dir CBC coordinate direction</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">!!  @param cbc_loc CBC coordinate location</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">s_associate_cbc_coefficients_pointers</a>(cbc_dir, cbc_loc) <span class="comment">! ---</span></div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">  458</a></span>&#160;            </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cbc_dir, cbc_loc</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="comment">! Associating CBC Coefficients in x-direction ======================</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">IF</span>(cbc_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                </div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <span class="keywordflow">IF</span>(cbc_loc == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>( i )</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">dx</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-i)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="comment">! Associating CBC Coefficients in y-direction ======================</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordflow">ELSEIF</span>(cbc_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">IF</span>(cbc_loc == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>( i )</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">dy</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-i)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="comment">! Associating CBC Coefficients in z-direction ======================</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a>; <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a> =&gt; <a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">IF</span>(cbc_loc == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>( i )</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(i) = <a class="code" href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">dz</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-i)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            </div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">s_associate_cbc_coefficients_pointers</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        </div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a>( q_prim_vf, flux_vf, flux_src_vf, &amp; ! -----------------</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                         cbc_dir, cbc_loc, &amp;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                 ix,iy,iz  )</div><div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">  539</a></span>&#160;           </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cbc_dir, cbc_loc</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="comment">! First-order time derivatives of the partial densities, density,</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="comment">! velocity, pressure, advection variables, and the specific heat</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="comment">! ratio and liquid stiffness functions</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(cont_idx%end)</span>   :: dalpha_rho_dt</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                            ::       drho_dt</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(num_dims)</span>       ::       dvel_dt</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                            ::      dpres_dt</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(adv_idx%end-E_idx)</span> ::       dadv_dt</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                            ::     dgamma_dt</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                            ::    dpi_inf_dt</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,r</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: blkmod1, blkmod2</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            </div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            </div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="comment">! Reshaping of inputted data and association of the FD and PI</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">! coefficients, or CBC coefficients, respectively, hinging on</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">! selected CBC coordinate direction</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a50fed863b4ee14bf81590ed80154b539">s_initialize_cbc</a>( q_prim_vf, flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                                  cbc_dir, cbc_loc, &amp;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                          ix,iy,iz  )</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            </div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">s_associate_cbc_coefficients_pointers</a>(cbc_dir, cbc_loc)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">! PI2 of flux_rs_vf and flux_src_rs_vf at j = 1/2 ==================</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;               </div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;               <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">s_convert_primitive_to_flux_variables</a>( <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                                                <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>, &amp;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                                            <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>, &amp;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                                            <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>,<a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>,<a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>  )</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;               </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                  <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(0,:,:) = <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(0,:,:)   &amp;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                          + <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,0,cbc_loc) * &amp;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                          ( <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(1,:,:) - &amp;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                            <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(0,:,:) )</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;               </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(0,:,:) = <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(0,:,:) + &amp;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                              ( <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(1,:,:) - &amp;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                                <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(0,:,:) ) &amp;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                              * <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(0,0,cbc_loc)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">! PI4 of flux_rs_vf and flux_src_rs_vf at j = 1/2, 3/2 =============</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> == 5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;               </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;               <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">s_convert_primitive_to_flux_variables</a>( <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                                                <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>, &amp;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                                            <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>, &amp;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                                            <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>,<a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>,<a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>  )</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;               </div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                  <span class="keywordflow">DO</span> j = 0,1</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                     <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,:,:) = <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(j,:,:)   &amp;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                             + <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,0,cbc_loc) * &amp;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                             ( <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(3,:,:) - &amp;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                               <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(2,:,:) ) &amp;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                             + <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,1,cbc_loc) * &amp;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                             ( <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(2,:,:) - &amp;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                               <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(1,:,:) ) &amp;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                             + <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,2,cbc_loc) * &amp;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                             ( <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(1,:,:) - &amp;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                               <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(0,:,:) )</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;               </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                  <span class="keywordflow">DO</span> j = 0,1</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                     <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,:,:) = <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(j,:,:) + &amp;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                                 ( <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(3,:,:) - &amp;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                                   <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(2,:,:) ) &amp;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                                 * <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,0,cbc_loc)     + &amp;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                                 ( <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(2,:,:) - &amp;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                                   <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(1,:,:) ) &amp;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                                 * <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,1,cbc_loc)     + &amp;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                                 ( <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(1,:,:) - &amp;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                   <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(0,:,:) ) &amp;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                                 * <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>(j,2,cbc_loc)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;               </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="comment">! FD2 or FD4 of RHS at j = 0 =======================================</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">DO</span> r = <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg, <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;               <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg, <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                  </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                  <span class="comment">! Transferring the Primitive Variables =======================</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                     <a class="code" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">alpha_rho</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(0,k,r)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                  </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                     <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(0,k,r)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                  </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                  <a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a> = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(0,k,r)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                  </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a>( <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>, &amp;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                                         <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>, <a class="code" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">gamma</a>, &amp;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                                         <a class="code" href="namespacem__cbc.html#a2187e55d648bf7c40be489b5a2b75ca7">pi_inf</a>, <a class="code" href="namespacem__cbc.html#af36bd73bae305dd791c6da0a37d2f6f8">re</a>, &amp;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                                          <a class="code" href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">we</a>, 0,k,r  )</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                  </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                  <a class="code" href="namespacem__cbc.html#a4e9565add4d8b423cbcecb0da55e232c">e</a> = <a class="code" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">gamma</a>*<a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a> + <a class="code" href="namespacem__cbc.html#a2187e55d648bf7c40be489b5a2b75ca7">pi_inf</a> + 5d-1*<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*sum(<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>**2d0)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                  </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                  <a class="code" href="namespacem__cbc.html#afef2a31e21e4f17b6852005a08ee86ce">h</a> = (<a class="code" href="namespacem__cbc.html#a4e9565add4d8b423cbcecb0da55e232c">e</a> + <a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a>)/<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                  </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                     <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(0,k,r)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                  </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                  <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a> = <a class="code" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">alpha_rho</a>/<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                  </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                  <span class="comment">! Compute mixture sound speed</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a> .OR. <a class="code" href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">regularization</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                      blkmod1 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma +1d0)*<a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a> + &amp;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                          <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                      blkmod2 = ((<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma +1d0)*<a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a> + &amp;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                          <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%pi_inf)/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(2)%gamma</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                      <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = (1d0/(<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*(<a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>(1)/blkmod1 + <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>(2)/blkmod2)))</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                      <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = 0d0</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                      <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                          <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> + <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg-1)%sf(0,k,r) * (1d0/<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0) * &amp;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                              (<a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a> + <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf/(<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma+1d0))</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordflow">                      END DO</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                      <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>/<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                      <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = ((<a class="code" href="namespacem__cbc.html#afef2a31e21e4f17b6852005a08ee86ce">h</a> - 5d-1*sum(<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>**2d0))/<a class="code" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">gamma</a>)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">                  END IF</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                  <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a> = sqrt(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">!                  IF (mixture_err .AND. c &lt; 0d0) THEN</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">!                    c = sgm_eps</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">!                  ELSE</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">!                    c = SQRT(c)</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">!                  END IF</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                  <span class="comment">! ============================================================</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                  </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                  <span class="comment">! First-Order Spatial Derivatives of Primitive Variables =====</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                  <a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a> = 0d0</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                  <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>       = 0d0</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                  <a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>      = 0d0</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                  <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>       = 0d0</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                  </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                  <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                     </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                                  <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(j,cbc_loc) + &amp;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                                    <a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                     </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                        <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end+i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                                         <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(j,cbc_loc) + &amp;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                                                 <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(i)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                     </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                     <a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,r) * &amp;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                           <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(j,cbc_loc) + &amp;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                                     <a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                     </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i) = <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                                  <a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>(j,cbc_loc) + &amp;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                                          <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                     </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  <span class="comment">! ============================================================</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                  </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  <span class="comment">! First-Order Temporal Derivatives of Primitive Variables ====</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                  <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1) = <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) - <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                  <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2) = <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                  <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(3) = <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) + <a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                  </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a>(<a class="code" href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">dflt_int</a>)</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                  </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                  <span class="comment">! Be careful about the cylindrical coordinate!</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                  <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a> .AND. cbc_dir == 2 .AND. cbc_loc == 1 ) <span class="keywordflow">THEN</span>  </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                      dpres_dt = -5d-1*(<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) + <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1)) + <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                 / <a class="code" href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">y_cc</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                      dpres_dt = -5d-1*(<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) + <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1))</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keywordflow">                  END IF</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                      dalpha_rho_dt(i) = &amp;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                          -(<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i+1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i)*dpres_dt)/(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                  </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                     dvel_dt(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) = <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) * &amp;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                              (<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) - <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end))/(2d0*<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>) + &amp;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                   (<a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i)) - 1d0) * &amp;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                              <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+i)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                  </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                  <span class="comment">! The treatment of void fraction source is unclear</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                  <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a> .AND. cbc_dir == 2 .AND. cbc_loc == 1 ) <span class="keywordflow">THEN</span>  </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                      <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                         dadv_dt(i) = -<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end+i) <span class="comment">!+ adv(i) * vel(dir_idx(1))/y_cc(n)</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">                      END DO</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                      <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                         dadv_dt(i) = -<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end+i)</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordflow">                      END DO</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="keywordflow">                  END IF</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                  </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                  drho_dt = 0d0; dgamma_dt = 0d0; dpi_inf_dt = 0d0</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                  </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                  <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                     drho_dt    = dalpha_rho_dt(1)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                     dgamma_dt  = dadv_dt(1)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                     dpi_inf_dt = dadv_dt(2)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                     <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        drho_dt    = drho_dt    + dalpha_rho_dt(i)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        dgamma_dt  = dgamma_dt  + dadv_dt(i)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        dpi_inf_dt = dpi_inf_dt + dadv_dt(i)*<a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">                  END IF</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                  <span class="comment">! ============================================================</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                  </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  <span class="comment">! flux_rs_vf and flux_src_rs_vf at j = -1/2 ==================</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                     <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(-1,k,r) = <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(0,k,r) &amp;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                               + <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)*dalpha_rho_dt(i)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                  </div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                     <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(-1,k,r) = <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(0,k,r) &amp;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                  + <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)*( <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)*drho_dt &amp;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                          + <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*dvel_dt(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end) )</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                  </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                  <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(-1,k,r) = <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(0,k,r) &amp;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                        + <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)*( <a class="code" href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">pres</a>*dgamma_dt             &amp;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                + <a class="code" href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">gamma</a>*dpres_dt             &amp;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                + dpi_inf_dt                 &amp;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                                + <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*sum(<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>*dvel_dt)       &amp;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                                + 5d-1*drho_dt*sum(<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>**2d0) )</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                  </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                  <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                     </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                     <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(-1,k,r) = 0d0</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                     </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                     <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(-1,k,r) = &amp;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                1d0/max(abs(<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))),<a class="code" href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">sgm_eps</a>) &amp;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                      *     sign(1d0,<a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))) &amp;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                      * (     <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(0,k,r) &amp;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                        +             <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)) &amp;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                        * <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(0,k,r) &amp;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                        +      <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)*dadv_dt(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>) )</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                     </div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                     </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                     <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(-1,k,r) = <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(0,k,r) - &amp;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                  <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)*<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(0,k,r) + &amp;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                                    <a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>(0)*dadv_dt(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                     </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                     <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(-1,k,r) = 0d0</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                     </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">                  END IF</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                  <span class="comment">! END: flux_rs_vf and flux_src_rs_vf at j = -1/2 =============</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                  </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="comment">! END: FD2 or FD4 of RHS at j = 0 ==================================</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="comment">! The reshaping of outputted data and disssociation of the FD and PI</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="comment">! coefficients, or CBC coefficients, respectively, based on selected</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="comment">! CBC coordinate direction.</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__cbc.html#a3fcf7cde1a04a7ee72ced4aa62cf53d0">s_finalize_cbc</a>( flux_vf, flux_src_vf, &amp;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                     cbc_dir, cbc_loc, &amp;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                             ix,iy,iz  )</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">fd_coef</a>, <a class="code" href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">pi_coef</a>)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">s_cbc</a> <span class="comment">! -------------------------------------------------</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#ad51ac21554842928259732d09a7eaf51">s_compute_slip_wall_l</a>(dflt_int) <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l00864"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ad51ac21554842928259732d09a7eaf51">  864</a></span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(2:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1) = 0d0</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            </div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            </div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#ad51ac21554842928259732d09a7eaf51">s_compute_slip_wall_l</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        </div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a39d803573d65c9c8ba7cc8b44b8053e1">s_compute_nonreflecting_subsonic_buffer_l</a>(dflt_int) <span class="comment">! ---------------</span></div><div class="line"><a name="l00886"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a39d803573d65c9c8ba7cc8b44b8053e1">  886</a></span>&#160;           </div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            </div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = (5d-1 - 5d-1*sign(1d0,<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)))*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1) &amp;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                 * (<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = (5d-1 - 5d-1*sign(1d0,<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)))*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2) &amp;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                     * (<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i-1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i-1)*<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = (5d-1 - 5d-1*sign(1d0,<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)))*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2) &amp;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                     * (<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)))</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = (5d-1 - 5d-1*sign(1d0,<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)))*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2) &amp;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                     * (<a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i-<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end))</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = (5d-1 - 5d-1*sign(1d0,<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(3)))*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(3) &amp;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        * (<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> + <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a39d803573d65c9c8ba7cc8b44b8053e1">s_compute_nonreflecting_subsonic_buffer_l</a> <span class="comment">! -------------</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        </div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aaaa6698b1ae1671a9124bb22617b4b8c">s_compute_nonreflecting_subsonic_inflow_l</a>(dflt_int) <span class="comment">! ---------------</span></div><div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#aaaa6698b1ae1671a9124bb22617b4b8c">  925</a></span>&#160;           </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(2:<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = 0d0</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            </div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aaaa6698b1ae1671a9124bb22617b4b8c">s_compute_nonreflecting_subsonic_inflow_l</a> <span class="comment">! -------------</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#af0664437857269683e572ec7b5e3b4b7">s_compute_nonreflecting_subsonic_outflow_l</a>(dflt_int) <span class="comment">! --------------</span></div><div class="line"><a name="l00944"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#af0664437857269683e572ec7b5e3b4b7">  944</a></span>&#160;           </div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            </div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i-1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i-1)*<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)))</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i-<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end))</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            </div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = 0d0</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#af0664437857269683e572ec7b5e3b4b7">s_compute_nonreflecting_subsonic_outflow_l</a> <span class="comment">! ------------</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        </div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#ab95f6f268802b6330f4aef16685ae498">s_compute_force_free_subsonic_outflow_l</a>(dflt_int) <span class="comment">! -----------------</span></div><div class="line"><a name="l00980"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#ab95f6f268802b6330f4aef16685ae498">  980</a></span>&#160;           </div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            </div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i-1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i-1)*<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)))</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i-<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end))</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) + 2d0*<a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1))</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            </div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#ab95f6f268802b6330f4aef16685ae498">s_compute_force_free_subsonic_outflow_l</a> <span class="comment">! ---------------</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#abbe02209311e19efb816f7678a8a9584">s_compute_constant_pressure_subsonic_outflow_l</a>(dflt_int) <span class="comment">! ----------</span></div><div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#abbe02209311e19efb816f7678a8a9584"> 1014</a></span>&#160;           </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            </div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            </div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i-1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i-1)*<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)))</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            </div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i-<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end))</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = -<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1)</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            </div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#abbe02209311e19efb816f7678a8a9584">s_compute_constant_pressure_subsonic_outflow_l</a> <span class="comment">! --------</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        </div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        </div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        </div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aef459892802977978a425cd85648c706">s_compute_supersonic_inflow_l</a>(dflt_int) <span class="comment">! ---------------------------</span></div><div class="line"><a name="l01050"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#aef459892802977978a425cd85648c706"> 1050</a></span>&#160;           </div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a> = 0d0</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            </div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#aef459892802977978a425cd85648c706">s_compute_supersonic_inflow_l</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a95f3cad9b9fec4f08b561da8f0db6584">s_compute_supersonic_outflow_l</a>(dflt_int) <span class="comment">! --------------------------</span></div><div class="line"><a name="l01066"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a95f3cad9b9fec4f08b561da8f0db6584"> 1066</a></span>&#160;           </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: dflt_int</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(1) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(1)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> - <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">DO</span> i = 2, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>(i-1) - <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>(i-1)*<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a>)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(i-<a class="code" href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">cont_idx</a>%end)))</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            </div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end-1</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(i) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(2)*(<a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>(i-<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end))</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            </div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end) = <a class="code" href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">lambda</a>(3)*(<a class="code" href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">dpres_ds</a> + <a class="code" href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">rho</a>*<a class="code" href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">c</a>*<a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>(<a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a>(1)))</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            </div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            </div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a95f3cad9b9fec4f08b561da8f0db6584">s_compute_supersonic_outflow_l</a> <span class="comment">! ------------------------</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a50fed863b4ee14bf81590ed80154b539">s_initialize_cbc</a>( q_prim_vf, flux_vf, flux_src_vf, &amp; ! ------</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                                    cbc_dir, cbc_loc, &amp;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                                            ix,iy,iz  )</div><div class="line"><a name="l01108"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a50fed863b4ee14bf81590ed80154b539"> 1108</a></span>&#160;           </div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_prim_vf</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            </div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: flux_vf, flux_src_vf</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cbc_dir, cbc_loc</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            </div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordtype">INTEGER</span> :: dj</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,r</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            </div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            </div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="comment">! Configuring the coordinate direction indexes and flags</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordflow">IF</span>(cbc_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;               <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%beg = 0; <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%end = <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a> = iy; <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a> = iz</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/1,2,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/1d0,0d0,0d0/)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">ELSEIF</span>(cbc_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;               <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%beg = 0; <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%end = <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a> = ix; <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a> = iz</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/2,1,3/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,1d0,0d0/)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;               <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%beg = 0; <a class="code" href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">is1</a>%end = <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>; <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a> = iy; <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a> = ix</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;               <a class="code" href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">dir_idx</a> = (/3,1,2/); <a class="code" href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">dir_flg</a> = (/0d0,0d0,1d0/)</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            </div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            </div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="comment">! Determining the indicial shift based on CBC location</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            dj = max(0,cbc_loc)</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            </div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="comment">! Allocation/Association of Primitive and Flux Variables ===========</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(    0    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                            <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                            <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            </div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;               </div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                  <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf(    0    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                          <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                          <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;               </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(    0    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                                     <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                                     <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;               </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                     <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf(    0    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                                 <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                                 <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                     <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf =&gt; <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;               </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            </div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;               <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(   -1    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                          <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                          <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            </div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(   -1    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                                     <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                                     <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                  <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(   -1    : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, &amp;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                                 <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%beg :  <a class="code" href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">is2</a>%end , &amp;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                                 <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%beg :  <a class="code" href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">is3</a>%end  ))</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                  <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf =&gt; <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="comment">! END: Allocation/Association of Primitive and Flux Variables ======</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            </div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="comment">! Reshaping Inputted Data in x-direction ===========================</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keywordflow">IF</span>(cbc_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;               </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                           <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                           q_prim_vf(i)%sf(dj*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-2*j)+j,k,r)</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;               </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                     <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                        <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(dj*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-2*j)+j,k,r) * &amp;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                        sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;               </div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                           flux_vf(i)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) * &amp;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;               </div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;               </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;               </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                     <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                              flux_src_vf(i)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) * &amp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="comment">! END: Reshaping Inputted Data in x-direction ======================</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            </div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            </div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="comment">! Reshaping Inputted Data in y-direction ===========================</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="keywordflow">ELSEIF</span>(cbc_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;               </div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                     <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                        <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                           <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                           q_prim_vf(i)%sf(k,dj*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-2*j)+j,r)</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;               </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                  <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                     <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                        <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                        q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(k,dj*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-2*j)+j,r) * &amp;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                        sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;               </div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                     <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                           flux_vf(i)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) * &amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;               </div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                  <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;               </div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                  <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r)</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;               </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                     <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                        <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                              flux_src_vf(i)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r)</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                     <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) * &amp;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="comment">! END: Reshaping Inputted Data in y-direction ======================</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            </div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">! Reshaping Inputted Data in z-direction ===========================</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;               </div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                  <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                        <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                           <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                           q_prim_vf(i)%sf(r,k,dj*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-2*j)+j)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;               </div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;               <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                     <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        <a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                        q_prim_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(r,k,dj*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-2*j)+j) * &amp;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                        sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;               </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                  <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                           flux_vf(i)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) * &amp;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;               </div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;               <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;               </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;               <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;               </div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                     <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                              flux_src_vf(i)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j)</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                  <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) = &amp;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) * &amp;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;               </div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="comment">! END: Reshaping Inputted Data in z-direction ======================</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            </div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            </div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="comment">! Association of the procedural pointer to the appropriate procedure</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="comment">! that will be utilized in the evaluation of L variables for the CBC</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            <span class="keywordflow">IF</span>(     (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -5)   &amp;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -5)   &amp;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -5)   &amp;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -5)   &amp;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -5)   &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -5) ) &amp;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;               </div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#ad51ac21554842928259732d09a7eaf51">s_compute_slip_wall_l</a></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;               </div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -6)   &amp;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -6)   &amp;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -6)   &amp;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -6)   &amp;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -6)   &amp;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -6) ) &amp;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;               </div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#a39d803573d65c9c8ba7cc8b44b8053e1">s_compute_nonreflecting_subsonic_buffer_l</a></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;               </div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -7)   &amp;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -7)   &amp;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -7)   &amp;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -7)   &amp;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -7)   &amp;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -7) ) &amp;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;               </div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#aaaa6698b1ae1671a9124bb22617b4b8c">s_compute_nonreflecting_subsonic_inflow_l</a></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;               </div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -8)   &amp;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -8)   &amp;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -8)   &amp;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -8)   &amp;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -8)   &amp;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -8) ) &amp;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;               </div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#af0664437857269683e572ec7b5e3b4b7">s_compute_nonreflecting_subsonic_outflow_l</a></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;               </div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -9)   &amp;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -9)   &amp;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -9)   &amp;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -9)   &amp;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -9)   &amp;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -9) ) &amp;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;               </div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#ab95f6f268802b6330f4aef16685ae498">s_compute_force_free_subsonic_outflow_l</a></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;               </div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg ==-10)   &amp;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end ==-10)   &amp;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg ==-10)   &amp;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end ==-10)   &amp;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg ==-10)   &amp;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end ==-10) ) &amp;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;               </div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#abbe02209311e19efb816f7678a8a9584">s_compute_constant_pressure_subsonic_outflow_l</a></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;               </div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">ELSEIF</span>( (cbc_dir == 1 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg ==-11)   &amp;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;               .OR. (cbc_dir == 1 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end ==-11)   &amp;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg ==-11)   &amp;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;               .OR. (cbc_dir == 2 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end ==-11)   &amp;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc == -1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg ==-11)   &amp;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;               .OR. (cbc_dir == 3 .AND. cbc_loc ==  1 .AND. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end ==-11) ) &amp;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                             <span class="keywordflow">THEN</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;               </div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#aef459892802977978a425cd85648c706">s_compute_supersonic_inflow_l</a></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;               </div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;               </div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;               <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; <a class="code" href="namespacem__cbc.html#a95f3cad9b9fec4f08b561da8f0db6584">s_compute_supersonic_outflow_l</a></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;               </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a50fed863b4ee14bf81590ed80154b539">s_initialize_cbc</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        </div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        </div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a3fcf7cde1a04a7ee72ced4aa62cf53d0">s_finalize_cbc</a>( flux_vf, flux_src_vf, &amp; ! -------------------</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                       cbc_dir, cbc_loc, &amp;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                               ix,iy,iz  )</div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a3fcf7cde1a04a7ee72ced4aa62cf53d0"> 1538</a></span>&#160;           </div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>),  &amp;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: flux_vf, flux_src_vf</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            </div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: cbc_dir, cbc_loc</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>), <span class="keywordtype">INTENT(IN)</span> :: ix,iy,iz</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            </div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="keywordtype">INTEGER</span> :: dj</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            </div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,r</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            </div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            </div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="comment">! Determining the indicial shift based on CBC location</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            dj = max(0,cbc_loc)</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            </div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            </div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            <span class="comment">! Reshaping Outputted Data in x-direction ==========================</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordflow">IF</span>(cbc_dir == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;               </div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                           flux_vf(i)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) = &amp;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;               </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) = &amp;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg)%sf(j,k,r)</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;               </div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) = &amp;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r)</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;               </div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                     <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                              flux_src_vf(i)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) = &amp;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r)</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(dj*((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)-2*j)+j,k,r) = &amp;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="comment">! END: Reshaping Outputted Data in x-direction =====================</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            </div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            </div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="comment">! Reshaping Outputted Data in y-direction ==========================</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">ELSEIF</span>(cbc_dir == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;               </div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                     <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                           flux_vf(i)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) = &amp;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;               </div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                  <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) = &amp;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%beg+1)%sf(j,k,r)</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;               </div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;               <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                  <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) = &amp;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;               </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                     <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                        <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                              flux_src_vf(i)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) = &amp;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r)</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                  <span class="keywordflow">DO</span> r = iz%beg, iz%end</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                     <span class="keywordflow">DO</span> k = ix%beg, ix%end</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(k,dj*((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1)-2*j)+j,r) = &amp;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="comment">! END: Reshaping Outputted Data in y-direction =====================</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            </div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            </div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            <span class="comment">! Reshaping Outputted Data in z-direction ==========================</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;               </div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                  <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                           flux_vf(i)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) = &amp;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                           <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;               </div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;               <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                        flux_vf(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) = &amp;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                        <a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">mom_idx</a>%end)%sf(j,k,r)</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;               </div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;               <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                  <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                     <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                        flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) = &amp;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                        <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r)</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;               </div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                     <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                        <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                           <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                              flux_src_vf(i)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) = &amp;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                              <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf(j,k,r)</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="keywordflow">                           END DO</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                  <span class="keywordflow">DO</span> r = ix%beg, ix%end</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                     <span class="keywordflow">DO</span> k = iy%beg, iy%end</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                        <span class="keywordflow">DO</span> j = -1, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                           flux_src_vf(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(r,k,dj*((<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)-2*j)+j) = &amp;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                           <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf(j,k,r) * &amp;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                           sign(1d0,-<span class="keywordtype">REAL</span>(cbc_loc,kind(0d0)))</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="keywordflow">                     END DO</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;               </div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <span class="comment">! END: Reshaping Outputted Data in z-direction =====================</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            </div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            </div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="comment">! Deallocation/Disassociation of Primitive and Flux Variables ======</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;               <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            </div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;               </div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;               <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                  <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;               </div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;               <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf)</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;               </div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;               <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                     <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;               <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                  <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                     <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="keywordflow">               END IF</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;               </div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            </div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;               <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            </div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(<a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg)%sf)</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            </div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">riemann_solver</a> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                  <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;               <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">adv_idx</a>%end</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                  <span class="keyword">NULLIFY</span>(<a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>(i)%sf)</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            </div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            </div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            <span class="comment">! Nullifying procedural pointer used in evaluation of L for the CBC</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            <a class="code" href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">s_compute_l</a> =&gt; null()</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            </div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a3fcf7cde1a04a7ee72ced4aa62cf53d0">s_finalize_cbc</a> <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        </div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        </div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        </div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        </div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        </div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a76b737dff5c827677888ffde0aff9cf1">s_finalize_cbc_module</a>() <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="namespacem__cbc.html#a76b737dff5c827677888ffde0aff9cf1"> 1788</a></span>&#160;            </div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            </div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            <span class="keywordflow">IF</span>(              all((/<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg,<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end/) &gt; -5)  &amp;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                    .AND.                     &amp;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. all((/<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg,<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end/) &gt; -5)) &amp;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                    .AND.                     &amp;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0 .AND. all((/<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg,<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end/) &gt; -5)) ) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            </div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            </div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            <span class="comment">! Deallocating the cell-average primitive variables</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">q_prim_rs_vf</a>)</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            </div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <span class="comment">! Deallocating the cell-average and cell-boundary-average fluxes</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            <span class="keyword">DEALLOCATE</span>(   <a class="code" href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">f_rs_vf</a>,    <a class="code" href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">f_src_rs_vf</a>)</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">flux_rs_vf</a>, <a class="code" href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">flux_src_rs_vf</a>)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            </div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            <span class="comment">! Deallocating the cell-average partial densities, the velocity, the</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            <span class="comment">! advection variables, the mass fractions and also the Weber numbers</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">alpha_rho</a>, <a class="code" href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">vel</a>, <a class="code" href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">adv</a>, <a class="code" href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">mf</a>, <a class="code" href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">we</a>)</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            </div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="comment">! Deallocating the first-order spatial derivatives, in s-direction,</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="comment">! of the partial densities, the velocity and the advected variables</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">dalpha_rho_ds</a>, <a class="code" href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">dvel_ds</a>, <a class="code" href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">dadv_ds</a>)</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            </div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <span class="comment">! Deallocating L, see Thompson (1987, 1990)</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">l</a>)</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="comment">! Deallocating the cell-width distribution in the s-direction</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">ds</a>)</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            </div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            </div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            <span class="comment">! Deallocating CBC Coefficients in x-direction =====================</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            <span class="keywordflow">IF</span>(any((/<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg,<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">fd_coef_x</a>); <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">pi_coef_x</a>)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            </div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            </div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            <span class="comment">! Deallocating CBC Coefficients in y-direction =====================</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0 .AND. any((/<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg,<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">fd_coef_y</a>); <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">pi_coef_y</a>)</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            </div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            </div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="comment">! Deallocating CBC Coefficients in z-direction =====================</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0 .AND. any((/<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg,<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end/) &lt;= -5)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">fd_coef_z</a>); <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> &gt; 1) <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">pi_coef_z</a>)</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            </div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="comment">! Disassociating the pointer to the procedure that was utilized to</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            <span class="comment">! to convert mixture or species variables to the mixture variables</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <a class="code" href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">s_convert_to_mixture_variables</a> =&gt; null()</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            </div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            </div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__cbc.html#a76b737dff5c827677888ffde0aff9cf1">s_finalize_cbc_module</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        </div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        </div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        </div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        </div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        </div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__cbc.html">m_cbc</a></div><div class="ttc" id="namespacem__global__parameters_html_a5c017ac8b7bf0d36b4b3b88efe5ffc5f"><div class="ttname"><a href="namespacem__global__parameters.html#a5c017ac8b7bf0d36b4b3b88efe5ffc5f">m_global_parameters::dir_idx</a></div><div class="ttdeci">integer, dimension(3) dir_idx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00226">m_global_parameters.f90:226</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a2187e55d648bf7c40be489b5a2b75ca7"><div class="ttname"><a href="namespacem__cbc.html#a2187e55d648bf7c40be489b5a2b75ca7">m_cbc::pi_inf</a></div><div class="ttdeci">real(kind(0d0)) pi_inf</div><div class="ttdoc">Cell averaged liquid stiffness. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00112">m_cbc.f90:112</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6b9c81f07f8444654924e3075e4edaf8"><div class="ttname"><a href="namespacem__global__parameters.html#a6b9c81f07f8444654924e3075e4edaf8">m_global_parameters::riemann_solver</a></div><div class="ttdeci">integer riemann_solver</div><div class="ttdoc">Riemann solver algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a5950f5d9fbc613591a42a3f9587f32f5"><div class="ttname"><a href="namespacem__cbc.html#a5950f5d9fbc613591a42a3f9587f32f5">m_cbc::fd_coef</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), pointer fd_coef</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00140">m_cbc.f90:140</a></div></div>
<div class="ttc" id="namespacem__cbc_html_aa657c2e47d8b48e2648c12a454ceec96"><div class="ttname"><a href="namespacem__cbc.html#aa657c2e47d8b48e2648c12a454ceec96">m_cbc::gamma</a></div><div class="ttdeci">real(kind(0d0)) gamma</div><div class="ttdoc">Cell averaged specific heat ratio. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00111">m_cbc.f90:111</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a906043af9a1ee38feda508ccb40c5402"><div class="ttname"><a href="namespacem__cbc.html#a906043af9a1ee38feda508ccb40c5402">m_cbc::pi_coef_x</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, target pi_coef_x</div><div class="ttdoc">Polynominal interpolant coefficients in x-dir. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00142">m_cbc.f90:142</a></div></div>
<div class="ttc" id="namespacem__cbc_html_aee8ead62642bc2783deb6403a961679d"><div class="ttname"><a href="namespacem__cbc.html#aee8ead62642bc2783deb6403a961679d">m_cbc::s_compute_cbc_coefficients</a></div><div class="ttdeci">subroutine s_compute_cbc_coefficients(cbc_dir, cbc_loc)</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00344">m_cbc.f90:344</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ae49e36ba93b9f5cb3adf9551c1cfb276"><div class="ttname"><a href="namespacem__cbc.html#ae49e36ba93b9f5cb3adf9551c1cfb276">m_cbc::ds</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable ds</div><div class="ttdoc">Cell-width distribution in the s-direction. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00129">m_cbc.f90:129</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae8e6c40b6ec73cb126b0cce7496e0057"><div class="ttname"><a href="namespacem__global__parameters.html#ae8e6c40b6ec73cb126b0cce7496e0057">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00189">m_global_parameters.f90:189</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a50fed863b4ee14bf81590ed80154b539"><div class="ttname"><a href="namespacem__cbc.html#a50fed863b4ee14bf81590ed80154b539">m_cbc::s_initialize_cbc</a></div><div class="ttdeci">subroutine s_initialize_cbc(q_prim_vf, flux_vf, flux_src_vf, cbc_dir, cbc_loc, ix, iy, iz)</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01108">m_cbc.f90:1108</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a2f790d774fdcc87779b89a71ae3f2674"><div class="ttname"><a href="namespacem__variables__conversion.html#a2f790d774fdcc87779b89a71ae3f2674">m_variables_conversion::s_convert_to_mixture_variables</a></div><div class="ttdeci">procedure(s_convert_abstract_to_mixture_variables), pointer, public s_convert_to_mixture_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00158">m_variables_conversion.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa46a7f3638e49fa9ec33ea859b9e6a5a"><div class="ttname"><a href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">m_global_parameters::bc_x</a></div><div class="ttdeci">type(bounds_info) bc_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00247">m_global_parameters.f90:247</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a54a6e22ead2511305b7370369f46af7a"><div class="ttname"><a href="namespacem__cbc.html#a54a6e22ead2511305b7370369f46af7a">m_cbc::pi_coef_y</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, target pi_coef_y</div><div class="ttdoc">Polynominal interpolant coefficients in y-dir. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00143">m_cbc.f90:143</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">The module contains all of the parameters describing the program logistics, the computational domain ...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00040">m_global_parameters.f90:40</a></div></div>
<div class="ttc" id="namespacem__cbc_html_abbb35cbd4d0951e9231865bd4120e682"><div class="ttname"><a href="namespacem__cbc.html#abbb35cbd4d0951e9231865bd4120e682">m_cbc::flux_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable flux_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00097">m_cbc.f90:97</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00048">m_derived_types.f90:48</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaa584e01b4153d246d84eef286482632"><div class="ttname"><a href="namespacem__global__parameters.html#aaa584e01b4153d246d84eef286482632">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00097">m_global_parameters.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc2bc27e809a773b7f5a6a65edac3b89"><div class="ttname"><a href="namespacem__global__parameters.html#adc2bc27e809a773b7f5a6a65edac3b89">m_global_parameters::dy</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dy</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a68eaaca2982b39252417b29ef5d0f9c3"><div class="ttname"><a href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">m_global_parameters::bc_y</a></div><div class="ttdeci">type(bounds_info) bc_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adefe3b78bf286d73a56aef49880dfb0d"><div class="ttname"><a href="namespacem__global__parameters.html#adefe3b78bf286d73a56aef49880dfb0d">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00186">m_global_parameters.f90:186</a></div></div>
<div class="ttc" id="namespacem__cbc_html_afef2a31e21e4f17b6852005a08ee86ce"><div class="ttname"><a href="namespacem__cbc.html#afef2a31e21e4f17b6852005a08ee86ce">m_cbc::h</a></div><div class="ttdeci">real(kind(0d0)) h</div><div class="ttdoc">Cell averaged enthalpy. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00108">m_cbc.f90:108</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a6f324c692d5e60e85314b1e21c81736b"><div class="ttname"><a href="namespacem__cbc.html#a6f324c692d5e60e85314b1e21c81736b">m_cbc::fd_coef_x</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, target fd_coef_x</div><div class="ttdoc">Finite diff. coefficients x-dir. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00133">m_cbc.f90:133</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a5075a07fe184dfe7d109f6b4e14f7302"><div class="ttname"><a href="namespacem__cbc.html#a5075a07fe184dfe7d109f6b4e14f7302">m_cbc::flux_src_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable flux_src_rs_vf</div><div class="ttdoc">The cell-boundary-average of the fluxes. They are initially determined by reshaping flux_vf and flux_...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00097">m_cbc.f90:97</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af7508eba0a53c9a35913a502d58dfb54"><div class="ttname"><a href="namespacem__global__parameters.html#af7508eba0a53c9a35913a502d58dfb54">m_global_parameters::dx</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dx</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__cbc_html_aaaa6698b1ae1671a9124bb22617b4b8c"><div class="ttname"><a href="namespacem__cbc.html#aaaa6698b1ae1671a9124bb22617b4b8c">m_cbc::s_compute_nonreflecting_subsonic_inflow_l</a></div><div class="ttdeci">subroutine s_compute_nonreflecting_subsonic_inflow_l(dflt_int)</div><div class="ttdoc">The L variables for the nonreflecting subsonic inflow CBC see pg. 455, Thompson (1990). This nonreflecting subsonic CBC assumes an incoming flow and reduces the amplitude of any reflections caused by outgoing waves. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00925">m_cbc.f90:925</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a7ff1c86cd167654a9c0765dea4a93ba5"><div class="ttname"><a href="namespacem__cbc.html#a7ff1c86cd167654a9c0765dea4a93ba5">m_cbc::lambda</a></div><div class="ttdeci">real(kind(0d0)), dimension(3) lambda</div><div class="ttdoc">Eigenvalues (see Thompson 1987,1990) </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00125">m_cbc.f90:125</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a5d23c9c92bd474ce0a0d5af3c1f37cb8"><div class="ttname"><a href="namespacem__cbc.html#a5d23c9c92bd474ce0a0d5af3c1f37cb8">m_cbc::dalpha_rho_ds</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dalpha_rho_ds</div><div class="ttdoc">Spatial derivatives in s-dir of partial density. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00117">m_cbc.f90:117</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a95f3cad9b9fec4f08b561da8f0db6584"><div class="ttname"><a href="namespacem__cbc.html#a95f3cad9b9fec4f08b561da8f0db6584">m_cbc::s_compute_supersonic_outflow_l</a></div><div class="ttdeci">subroutine s_compute_supersonic_outflow_l(dflt_int)</div><div class="ttdoc">L variables for the supersonic outflow CBC, see pg. 453 of Thompson (1990). For the supersonic outflo...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01066">m_cbc.f90:1066</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a2995ecb6263724a4421d1622f513103c"><div class="ttname"><a href="namespacem__cbc.html#a2995ecb6263724a4421d1622f513103c">m_cbc::is1</a></div><div class="ttdeci">type(bounds_info) is1</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00158">m_cbc.f90:158</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a44a30ad8ee6642f20f106e99fe3608f9"><div class="ttname"><a href="namespacem__cbc.html#a44a30ad8ee6642f20f106e99fe3608f9">m_cbc::l</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable l</div><div class="ttdoc">L matrix (see Thompson 1987,1990) </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00126">m_cbc.f90:126</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac60a57ea5298dde379e24b6b77762101"><div class="ttname"><a href="namespacem__global__parameters.html#ac60a57ea5298dde379e24b6b77762101">m_global_parameters::regularization</a></div><div class="ttdeci">logical regularization</div><div class="ttdoc">Regularization terms of Tiwari (2013) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00140">m_global_parameters.f90:140</a></div></div>
<div class="ttc" id="namespacem__cbc_html_acfe8efda790266c75260db5e3917d337"><div class="ttname"><a href="namespacem__cbc.html#acfe8efda790266c75260db5e3917d337">m_cbc::is2</a></div><div class="ttdeci">type(bounds_info) is2</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00158">m_cbc.f90:158</a></div></div>
<div class="ttc" id="namespacem__cbc_html_af0664437857269683e572ec7b5e3b4b7"><div class="ttname"><a href="namespacem__cbc.html#af0664437857269683e572ec7b5e3b4b7">m_cbc::s_compute_nonreflecting_subsonic_outflow_l</a></div><div class="ttdeci">subroutine s_compute_nonreflecting_subsonic_outflow_l(dflt_int)</div><div class="ttdoc">The L variables for the nonreflecting subsonic outflow CBC see pg. 454 of Thompson (1990)...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00944">m_cbc.f90:944</a></div></div>
<div class="ttc" id="namespacem__cbc_html"><div class="ttname"><a href="namespacem__cbc.html">m_cbc</a></div><div class="ttdoc">The module features a large database of characteristic boundary conditions (CBC) for the Euler system...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00049">m_cbc.f90:49</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ab95f6f268802b6330f4aef16685ae498"><div class="ttname"><a href="namespacem__cbc.html#ab95f6f268802b6330f4aef16685ae498">m_cbc::s_compute_force_free_subsonic_outflow_l</a></div><div class="ttdeci">subroutine s_compute_force_free_subsonic_outflow_l(dflt_int)</div><div class="ttdoc">The L variables for the force-free subsonic outflow CBC, see pg. 454 of Thompson (1990). The force-free subsonic outflow sets to zero the sum of all of the forces which are acting on a fluid element for the normal coordinate direction to the boundary. As a result, a fluid element at the boundary is simply advected outward at the fluid velocity. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00980">m_cbc.f90:980</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a9023ac4f88b32e7d88ca8fadb649b84f"><div class="ttname"><a href="namespacem__cbc.html#a9023ac4f88b32e7d88ca8fadb649b84f">m_cbc::f_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable f_rs_vf</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00093">m_cbc.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a351be005cfac23e82310e91393f5d535"><div class="ttname"><a href="namespacem__global__parameters.html#a351be005cfac23e82310e91393f5d535">m_global_parameters::weno_polyn</a></div><div class="ttdeci">integer weno_polyn</div><div class="ttdoc">Degree of the WENO polynomials (polyn) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ab079ec31add26b8d5f591b3cb5e5b88f"><div class="ttname"><a href="namespacem__cbc.html#ab079ec31add26b8d5f591b3cb5e5b88f">m_cbc::f_src_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable f_src_rs_vf</div><div class="ttdoc">Cell-average fluxes (src - source). These are directly determined from the cell-average primitive var...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00093">m_cbc.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">The number of cells that are necessary to be able to store enough boundary conditions data to march t...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a532334846efcbbca82ab11f26e28c5f7"><div class="ttname"><a href="namespacem__cbc.html#a532334846efcbbca82ab11f26e28c5f7">m_cbc::we</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable we</div><div class="ttdoc">Cell averaged Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00115">m_cbc.f90:115</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ac2bd4c0c73cfb0582f003473d0ec4f7f"><div class="ttname"><a href="namespacem__cbc.html#ac2bd4c0c73cfb0582f003473d0ec4f7f">m_cbc::dvel_ds</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dvel_ds</div><div class="ttdoc">Spatial derivatives in s-dir of velocity. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00118">m_cbc.f90:118</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of fluids in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__cbc_html_aef459892802977978a425cd85648c706"><div class="ttname"><a href="namespacem__cbc.html#aef459892802977978a425cd85648c706">m_cbc::s_compute_supersonic_inflow_l</a></div><div class="ttdeci">subroutine s_compute_supersonic_inflow_l(dflt_int)</div><div class="ttdoc">L variables for the supersonic inflow CBC, see pg. 453 Thompson (1990). The supersonic inflow CBC is ...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01050">m_cbc.f90:1050</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a613c09e8438e535e8c13f15282493793"><div class="ttname"><a href="namespacem__variables__conversion.html#a613c09e8438e535e8c13f15282493793">m_variables_conversion::s_convert_mixture_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_mixture_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00188">m_variables_conversion.f90:188</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a6ba3d055b8d3c0d003ff74ccd2762b1c"><div class="ttname"><a href="namespacem__cbc.html#a6ba3d055b8d3c0d003ff74ccd2762b1c">m_cbc::s_compute_l</a></div><div class="ttdeci">procedure(s_compute_abstract_l), pointer s_compute_l</div><div class="ttdoc">Pointer to procedure used to calculate L variables, based on choice of CBC. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00154">m_cbc.f90:154</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a4e9565add4d8b423cbcecb0da55e232c"><div class="ttname"><a href="namespacem__cbc.html#a4e9565add4d8b423cbcecb0da55e232c">m_cbc::e</a></div><div class="ttdeci">real(kind(0d0)) e</div><div class="ttdoc">Cell averaged energy. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00107">m_cbc.f90:107</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a39d803573d65c9c8ba7cc8b44b8053e1"><div class="ttname"><a href="namespacem__cbc.html#a39d803573d65c9c8ba7cc8b44b8053e1">m_cbc::s_compute_nonreflecting_subsonic_buffer_l</a></div><div class="ttdeci">subroutine s_compute_nonreflecting_subsonic_buffer_l(dflt_int)</div><div class="ttdoc">The L variables for the nonreflecting subsonic buffer CBC see pg. 13 of Thompson (1987). The nonreflecting subsonic buffer reduces the amplitude of any reflections caused by outgoing waves. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00886">m_cbc.f90:886</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a982b2364cfaa61896b8143231fc9e380"><div class="ttname"><a href="namespacem__cbc.html#a982b2364cfaa61896b8143231fc9e380">m_cbc::c</a></div><div class="ttdeci">real(kind(0d0)) c</div><div class="ttdoc">Cell averaged speed of sound. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00113">m_cbc.f90:113</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a76b737dff5c827677888ffde0aff9cf1"><div class="ttname"><a href="namespacem__cbc.html#a76b737dff5c827677888ffde0aff9cf1">m_cbc::s_finalize_cbc_module</a></div><div class="ttdeci">subroutine, public s_finalize_cbc_module()</div><div class="ttdoc">Module deallocation and/or disassociation procedures. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01788">m_cbc.f90:1788</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in system of eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad138d35528cf27ff42dba00d13c269be"><div class="ttname"><a href="namespacem__global__parameters.html#ad138d35528cf27ff42dba00d13c269be">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00187">m_global_parameters.f90:187</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ae86e3f027b189005a2b00f8f2bb9ae32"><div class="ttname"><a href="namespacem__cbc.html#ae86e3f027b189005a2b00f8f2bb9ae32">m_cbc::fd_coef_y</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, target fd_coef_y</div><div class="ttdoc">Finite diff. coefficients y-dir. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00134">m_cbc.f90:134</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ad6960b075aa8db0bcc08761273a6c4c3"><div class="ttname"><a href="namespacem__cbc.html#ad6960b075aa8db0bcc08761273a6c4c3">m_cbc::pres</a></div><div class="ttdeci">real(kind(0d0)) pres</div><div class="ttdoc">Cell averaged pressure. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00106">m_cbc.f90:106</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ae49b66468d949880db575e26231b641c"><div class="ttname"><a href="namespacem__cbc.html#ae49b66468d949880db575e26231b641c">m_cbc::dpres_ds</a></div><div class="ttdeci">real(kind(0d0)) dpres_ds</div><div class="ttdoc">Spatial derivatives in s-dir of pressure. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00119">m_cbc.f90:119</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_abe0d038aac3b3f0166c1a0c93c497e33"><div class="ttname"><a href="namespacem__variables__conversion.html#abe0d038aac3b3f0166c1a0c93c497e33">m_variables_conversion::s_convert_species_to_mixture_variables_bubbles</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables_bubbles(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, i, j, k)</div><div class="ttdoc">This procedure is used alongside with the gamma/pi_inf model to transfer the density, the specific heat ratio function and liquid stiffness function from the vector of conservative or primitive variables to their scalar counterparts. Specifially designed for when subgrid bubbles must be included. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00226">m_variables_conversion.f90:226</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ad0e1fd6e716ca51ccf5d6954e15fb02e"><div class="ttname"><a href="namespacem__cbc.html#ad0e1fd6e716ca51ccf5d6954e15fb02e">m_cbc::dadv_ds</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dadv_ds</div><div class="ttdoc">Spatial derivatives in s-dir of advection variables Note that these are only obtained in those cells ...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00120">m_cbc.f90:120</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate mixture sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00139">m_global_parameters.f90:139</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a53f0d5eed7783c9760aaeeaa0abbd58c"><div class="ttname"><a href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">m_global_parameters::cyl_coord</a></div><div class="ttdeci">logical cyl_coord</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00086">m_global_parameters.f90:86</a></div></div>
<div class="ttc" id="namespacem__cbc_html_af36bd73bae305dd791c6da0a37d2f6f8"><div class="ttname"><a href="namespacem__cbc.html#af36bd73bae305dd791c6da0a37d2f6f8">m_cbc::re</a></div><div class="ttdeci">real(kind(0d0)), dimension(2) re</div><div class="ttdoc">Cell averaged Reynolds numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00114">m_cbc.f90:114</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a0afb287e68b0d1d970fd073849525c36"><div class="ttname"><a href="namespacem__cbc.html#a0afb287e68b0d1d970fd073849525c36">m_cbc::s_initialize_cbc_module</a></div><div class="ttdeci">subroutine, public s_initialize_cbc_module()</div><div class="ttdoc">The computation of parameters, the allocation of memory, the association of pointers and/or the execu...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00167">m_cbc.f90:167</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a4f6b082aae7f83fcad04d8c5d59f6d89"><div class="ttname"><a href="namespacem__cbc.html#a4f6b082aae7f83fcad04d8c5d59f6d89">m_cbc::mf</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable mf</div><div class="ttdoc">Cell averaged mass fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00110">m_cbc.f90:110</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__cbc_html_af820095dcf800b727c19f2b5ee95a814"><div class="ttname"><a href="namespacem__cbc.html#af820095dcf800b727c19f2b5ee95a814">m_cbc::pi_coef_z</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), allocatable, target pi_coef_z</div><div class="ttdoc">Polynominal interpolant coefficients in z-dir The first dimension of the array identifies the polynom...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00144">m_cbc.f90:144</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9dc07be63393049ae70d9dceeff403e9"><div class="ttname"><a href="namespacem__global__parameters.html#a9dc07be63393049ae70d9dceeff403e9">m_global_parameters::dir_flg</a></div><div class="ttdeci">real(kind(0d0)), dimension(3) dir_flg</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00227">m_global_parameters.f90:227</a></div></div>
<div class="ttc" id="namespacem__cbc_html_abbe02209311e19efb816f7678a8a9584"><div class="ttname"><a href="namespacem__cbc.html#abbe02209311e19efb816f7678a8a9584">m_cbc::s_compute_constant_pressure_subsonic_outflow_l</a></div><div class="ttdeci">subroutine s_compute_constant_pressure_subsonic_outflow_l(dflt_int)</div><div class="ttdoc">L variables for the constant pressure subsonic outflow CBC see pg. 455 Thompson (1990). The constant pressure subsonic outflow maintains a fixed pressure at the CBC boundary in absence of any transverse effects. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01014">m_cbc.f90:1014</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a0670171466cd1ce584495face34cc4de"><div class="ttname"><a href="namespacem__variables__conversion.html#a0670171466cd1ce584495face34cc4de">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine, public s_convert_species_to_mixture_variables(qK_vf, rho_K, gamma_K, pi_inf_K, Re_K, We_K, k, l, r)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00306">m_variables_conversion.f90:306</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ad51ac21554842928259732d09a7eaf51"><div class="ttname"><a href="namespacem__cbc.html#ad51ac21554842928259732d09a7eaf51">m_cbc::s_compute_slip_wall_l</a></div><div class="ttdeci">subroutine s_compute_slip_wall_l(dflt_int)</div><div class="ttdoc">The L variables for the slip wall CBC, see pg. 451 of Thompson (1990). At the slip wall (frictionless...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00864">m_cbc.f90:864</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab8488205257dab4e94258eee55d0d1aa"><div class="ttname"><a href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">m_global_parameters::weno_order</a></div><div class="ttdeci">integer weno_order</div><div class="ttdoc">Order of the WENO reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00125">m_global_parameters.f90:125</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a12e2d4feb2b8425b8f2270a8da529555"><div class="ttname"><a href="namespacem__cbc.html#a12e2d4feb2b8425b8f2270a8da529555">m_cbc::q_prim_rs_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable q_prim_rs_vf</div><div class="ttdoc">The cell-average primitive variables. They are obtained by reshaping (RS) q_prim_vf in the coordinate...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00088">m_cbc.f90:88</a></div></div>
<div class="ttc" id="namespacem__cbc_html_afece2e0a449e76d45bd85eeec0207ce8"><div class="ttname"><a href="namespacem__cbc.html#afece2e0a449e76d45bd85eeec0207ce8">m_cbc::rho</a></div><div class="ttdeci">real(kind(0d0)) rho</div><div class="ttdoc">Cell averaged density. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00104">m_cbc.f90:104</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a04878814b8097100a179152ba853262a"><div class="ttname"><a href="namespacem__global__parameters.html#a04878814b8097100a179152ba853262a">m_global_parameters::dz</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable, target dz</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a8477d940e9515138e8405c9302a026c8"><div class="ttname"><a href="namespacem__cbc.html#a8477d940e9515138e8405c9302a026c8">m_cbc::is3</a></div><div class="ttdeci">type(bounds_info) is3</div><div class="ttdoc">Indical bounds in the s1-, s2- and s3-directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00158">m_cbc.f90:158</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a76e19dea2a654c9a7f311baa16ef118c"><div class="ttname"><a href="namespacem__cbc.html#a76e19dea2a654c9a7f311baa16ef118c">m_cbc::s_associate_cbc_coefficients_pointers</a></div><div class="ttdeci">subroutine s_associate_cbc_coefficients_pointers(cbc_dir, cbc_loc)</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00458">m_cbc.f90:458</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a93f1bb8b4aee426f508a6ceef721a35c"><div class="ttname"><a href="namespacem__variables__conversion.html#a93f1bb8b4aee426f508a6ceef721a35c">m_variables_conversion::s_convert_primitive_to_flux_variables</a></div><div class="ttdeci">subroutine, public s_convert_primitive_to_flux_variables(qK_prim_vf, FK_vf, FK_src_vf, ix, iy, iz)</div><div class="ttdoc">The following subroutine handles the conversion between the primitive variables and the Eulerian flux...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00903">m_variables_conversion.f90:903</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a72cc3ba5a0de327fae70742734e77492"><div class="ttname"><a href="namespacem__cbc.html#a72cc3ba5a0de327fae70742734e77492">m_cbc::s_cbc</a></div><div class="ttdeci">subroutine, public s_cbc(q_prim_vf, flux_vf, flux_src_vf, cbc_dir, cbc_loc, ix, iy, iz)</div><div class="ttdoc">The following is the implementation of the CBC based on the work of Thompson (1987, 1990) on hyperbolic systems. The CBC is indirectly applied in the computation of the right-hand-side (RHS) near the relevant domain boundary through the modification of the fluxes. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00539">m_cbc.f90:539</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ace0392bdc9bb94c00e11d4e51432e0ad"><div class="ttname"><a href="namespacem__cbc.html#ace0392bdc9bb94c00e11d4e51432e0ad">m_cbc::pi_coef</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:,:), pointer pi_coef</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00149">m_cbc.f90:149</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a3fcf7cde1a04a7ee72ced4aa62cf53d0"><div class="ttname"><a href="namespacem__cbc.html#a3fcf7cde1a04a7ee72ced4aa62cf53d0">m_cbc::s_finalize_cbc</a></div><div class="ttdeci">subroutine s_finalize_cbc(flux_vf, flux_src_vf, cbc_dir, cbc_loc, ix, iy, iz)</div><div class="ttdoc">Deallocation and/or the disassociation procedures that are necessary in order to finalize the CBC app...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l01538">m_cbc.f90:1538</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__cbc_html_af8d317b53da9384f50a1c51dd46bc8fe"><div class="ttname"><a href="namespacem__cbc.html#af8d317b53da9384f50a1c51dd46bc8fe">m_cbc::adv</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable adv</div><div class="ttdoc">Cell averaged advected variables. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00109">m_cbc.f90:109</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4e4e3806190a62a77cf6542f6d07dbbd"><div class="ttname"><a href="namespacem__global__parameters.html#a4e4e3806190a62a77cf6542f6d07dbbd">m_global_parameters::dflt_int</a></div><div class="ttdeci">integer, parameter dflt_int</div><div class="ttdoc">Default integer value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00060">m_global_parameters.f90:60</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module features a database of subroutines that allow for the conversion of state variables from ...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00047">m_variables_conversion.f90:47</a></div></div>
<div class="ttc" id="namespacem__cbc_html_ad80b730485604931948331f36eb7b6e2"><div class="ttname"><a href="namespacem__cbc.html#ad80b730485604931948331f36eb7b6e2">m_cbc::vel</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable vel</div><div class="ttdoc">Cell averaged velocity. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00105">m_cbc.f90:105</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type annexing beginning and ending bounds information. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00064">m_derived_types.f90:64</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6769808569174ff0eef096e958889837"><div class="ttname"><a href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">m_global_parameters::bc_z</a></div><div class="ttdeci">type(bounds_info) bc_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00158">m_global_parameters.f90:158</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a025a2f672d7d9997966bdedab3f333de"><div class="ttname"><a href="namespacem__cbc.html#a025a2f672d7d9997966bdedab3f333de">m_cbc::fd_coef_z</a></div><div class="ttdeci">real(kind(0d0)), dimension(:,:), allocatable, target fd_coef_z</div><div class="ttdoc">Finite diff. coefficients z-dir The first dimension identifies the location of a coefficient in the F...</div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00135">m_cbc.f90:135</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aec97838cc58623019b07ae47da7f4c1c"><div class="ttname"><a href="namespacem__global__parameters.html#aec97838cc58623019b07ae47da7f4c1c">m_global_parameters::sgm_eps</a></div><div class="ttdeci">real(kind(0d0)), parameter sgm_eps</div><div class="ttdoc">Segmentation tolerance. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00061">m_global_parameters.f90:61</a></div></div>
<div class="ttc" id="namespacem__cbc_html_a23d4bcbedc528222237094361a4ff43f"><div class="ttname"><a href="namespacem__cbc.html#a23d4bcbedc528222237094361a4ff43f">m_cbc::alpha_rho</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable alpha_rho</div><div class="ttdoc">Cell averaged partial densiy. </div><div class="ttdef"><b>Definition:</b> <a href="m__cbc_8f90_source.html#l00103">m_cbc.f90:103</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdoc">Bubbles on/off. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00290">m_global_parameters.f90:290</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cff1091173cf1fe67371edd427ba236f.html">simulation_code</a></li><li class="navelem"><a class="el" href="m__cbc_8f90.html">m_cbc.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
