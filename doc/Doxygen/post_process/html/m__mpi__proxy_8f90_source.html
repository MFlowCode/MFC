<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Post_process: m_mpi_proxy.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Post_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__mpi__proxy_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_mpi_proxy.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__mpi__proxy_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html">   39</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">USE </span>mpi                     !&lt; message passing interface (mpi) module</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         !&lt; definitions of the derived types</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     !&lt; global parameters for the code</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">   58</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">   59</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">   66</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">   67</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a306ba163b09cfc692125f2c0ba82ef8c">   72</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PRIVATE</span> :: <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">s_mpi_initialize</a>() <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">   84</a></span>&#160;            </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="comment">! Establishing the MPI environment</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keyword">CALL </span>mpi_init(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="comment">! Checking whether the MPI environment has been properly intialized</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> /= mpi_success) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to initialize MPI environment. Exiting ...&#39;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">! Querying number of processors available for the job</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keyword">CALL </span>mpi_comm_size(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="comment">! Identifying the rank of the local processor</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keyword">CALL </span>mpi_comm_rank(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> ,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">s_mpi_initialize</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        </div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a>() <span class="comment">! ---------------------------------------------</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">  113</a></span>&#160;            </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">! Terminating the MPI environment</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">s_mpi_abort</a> <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a>(q_cons_vf) <span class="comment">! --------------------------</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">  125</a></span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_cons_vf</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(num_dims)</span> :: sizes_glb, sizes_loc</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordtype">INTEGER</span> :: ierr</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%var(i)%sf =&gt; q_cons_vf(i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="comment">! Define global(g) and local(l) sizes for flow variables</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            sizes_glb(1) = <a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>+1; sizes_loc(1) = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                sizes_glb(2) = <a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>+1; sizes_loc(2) = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    sizes_glb(3) = <a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>+1; sizes_loc(3) = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="comment">! Define the view for each variable</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="keyword">CALL </span>mpi_type_create_subarray(<a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a>,sizes_glb,sizes_loc,<a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>,&amp;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    mpi_order_fortran,mpi_double_precision,<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i),ierr)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keyword">CALL </span>mpi_type_commit(<a class="code" href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">mpi_io_data</a>%view(i),ierr)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">s_initialize_mpi_data</a> <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a>() <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">  164</a></span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">! Calling MPI_BARRIER</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keyword">CALL </span>mpi_barrier(mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">s_mpi_barrier</a> <span class="comment">! -----------------------------------------</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a015ee2c0892e9cfcb858da8f27b646d5">s_initialize_mpi_proxy_module</a>() <span class="comment">! ------------------------------</span></div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a015ee2c0892e9cfcb858da8f27b646d5">  175</a></span>&#160;           </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">! Allocating vectorized buffer regions of conservative variables.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">! The length of buffer vectors are set according to the size of the</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">! largest buffer region in the sub-domain.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="comment">! Simulation is at least 2D</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    <span class="comment">! Simulation is 3D</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>( 0 : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *         &amp;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *          &amp;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) / &amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                        ( min(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)        &amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                        + 2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1 )-1 ))</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>( 0 : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *         &amp;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *          &amp;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                                        (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) / &amp;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                                        ( min(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>)        &amp;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                                        + 2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1 )-1 ))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <span class="comment">! Simulation is 2D</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>( 0 : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *         &amp;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *          &amp;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                                        ( max(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>)          &amp;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                        + 2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1 )-1 ))</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>( 0 : <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *         &amp;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                                        <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *          &amp;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                                        ( max(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>)          &amp;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                        + 2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1 )-1 ))</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        </div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="comment">! Simulation is 1D</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>-1))</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0:<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>-1))</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="comment">! Initially zeroing out the vectorized buffer region variables</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">! to avoid possible underflow from any unused allocated memory</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>  = 0d0</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a> = 0d0</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">! Allocating and configuring the recieve counts and the displacement</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">! vector variables used in variable-gather communication procedures.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">! Note that these are only needed for either multidimensional runs</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">! that utilize the Silo database file format or for 1D simulations.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">IF</span>((<span class="keyword">format</span> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>(0:<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>-1))</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keyword">ALLOCATE</span>(    <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>(0:<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>-1))</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <span class="keyword">CALL </span>mpi_gather( <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, 1, mpi_integer, <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>(0), 1, &amp;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                     mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>   )</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a> = 1</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>(0) = 0</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>-1</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>(i) = <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>(i-1) + <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>(i-1)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a015ee2c0892e9cfcb858da8f27b646d5">s_initialize_mpi_proxy_module</a> <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">s_mpi_bcast_user_inputs</a>() <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">  273</a></span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            </div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">! Logistics</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>, len(<a class="code" href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">case_dir</a>), mpi_character ,      &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                            0      , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="comment">! Computational domain parameters</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">n_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">p_glb</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ace0c8a67825d0dccd2e23b5d0f9985c0">t_step_start</a>, 1, mpi_integer, 0, mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aff1140575af25247060f3e7f31a8a10f">t_step_stop</a> , 1, mpi_integer, 0, mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a98b51eda2c46660b439c0a8375385165">t_step_save</a> , 1, mpi_integer, 0, mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">! Simulation algorithm parameters</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">mixture_err</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">alt_soundspeed</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>, 1, mpi_logical, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            </div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="comment">! Fluids physical parameters</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%gamma   , 1, &amp;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(i)%pi_inf  , 1, &amp;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                mpi_double_precision, 0, &amp;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>     )</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">! Formatted database file(s) structure parameters</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<span class="keyword">format</span>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">precision</a>, 1, mpi_integer, 0, mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a2db51a0beed308d7a3c51c5c0ed45609">coarsen_silo</a>  ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aabc3362b8f53b08f4f113e699d449754">rho_wrt</a>       ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a5d11d820127525a02b4c6f9d09fad258">mom_wrt</a>(1)    ,    3    , mpi_logical,         &amp;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ae4ab7caa7dee5e616b217437f7f2b87f">vel_wrt</a>(1)    ,    3    , mpi_logical,         &amp;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">flux_lim</a>      , 1, mpi_integer         , &amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                           0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a35133a9d59c33919af73594f804d2fd9">flux_wrt</a>(1)    ,    3    , mpi_logical,         &amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ab6d5da2756e61a0695236e24ad920e38">kappa_wrt</a>(1)    , <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>, mpi_logical   , &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                    0       , mpi_comm_world, &amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                              <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a81724112f8d98fe4345fc37eb13a51b2">e_wrt</a>         ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a444f5e3df80f338ae77ccecd326a325f">pres_wrt</a>      ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a610d39b1d30ffa66fead89c936c83226">gamma_wrt</a>     ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ad9c6ef3b20d42a8c3dababd60c20cca3">heat_ratio_wrt</a>,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#afb66fcff0c17f2298a9b7a35c85dedb7">pi_inf_wrt</a>    ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a34bbf8acae0d925bb193265fb2966d1c">pres_inf_wrt</a>  ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ad23223100223bdb6d7f59fed5ec7bbb9">cons_vars_wrt</a> ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a795878d693cec161db5f5c06aea7331e">prim_vars_wrt</a> ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a56a071ae0b79b39a826646ace37972eb">c_wrt</a>         ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">omega_wrt</a>(1)  ,    3    , mpi_logical,         &amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">schlieren_wrt</a> ,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a629b922f4d06112a6d03d7864872990f">alpha_rho_wrt</a>(1), <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>, mpi_logical   , &amp;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                    0       , mpi_comm_world, &amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                              <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a61f570bcde70f7013523e11d93c66929">alpha_wrt</a>(1)    , <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>, mpi_logical   , &amp;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                    0       , mpi_comm_world, &amp;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                              <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ada8a4a23b5804dfa9843b25ddd1cd8c1">schlieren_alpha</a>(1)  , <a class="code" href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">num_fluids_max</a>, &amp;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                            mpi_double_precision,        0      , &amp;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                            mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                  )</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            </div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a8892cc67c7d04be4d8e6d02a86e209bc">fd_order</a>, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a41c2be7ba7b793490633ce040f949274">fourier_decomp</a>,    1    , mpi_logical,         &amp;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                               0    , mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a085b3000bac43a3ff2963646c8ecd96a">fourier_modes</a>%beg, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacem__global__parameters.html#a085b3000bac43a3ff2963646c8ecd96a">fourier_modes</a>%end, 1, mpi_integer, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="comment">! Tait EOS</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a>,1,             &amp;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>,1,           &amp;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="comment">! Bubble modeling</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>,1,          &amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a>,1,          &amp;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a17169a5387f8f1efd5ac34cb4eae7c81">thermal</a>,1,            &amp;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        mpi_integer,0, &amp;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a24492f9b474683476a342e7ee42c1c6d">r0ref</a>,1,            &amp;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a>,1,            &amp;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        mpi_integer,0, &amp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a32791d9d5fef0213f01fc31713b17ae8">polydisperse</a>,1,          &amp;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        mpi_logical,0,          &amp;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>  )</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a29164826db891e5662ce2bccdbc57d3c">poly_sigma</a>,1,            &amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">web</a>,1,            &amp;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">ca</a>,1,            &amp;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( <a class="code" href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">re_inv</a>,1,            &amp;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                        mpi_double_precision,0, &amp;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        mpi_comm_world,<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>) </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">s_mpi_bcast_user_inputs</a> <span class="comment">! -------------------------------</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">s_mpi_decompose_computational_domain</a>() <span class="comment">! --------------------</span></div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">  440</a></span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="comment">! # of processors in the x-, y- and z-coordinate directions</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordtype">INTEGER</span> :: num_procs_x, num_procs_y, num_procs_z</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="comment">! Temporary # of processors in x-, y- and z-coordinate directions</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="comment">! used during the processor factorization optimization procedure</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: tmp_num_procs_x, tmp_num_procs_y, tmp_num_procs_z</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="comment">! Processor factorization (fct) minimization parameter</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: fct_min</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="comment">! Cartesian processor topology communicator</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">INTEGER</span> :: MPI_COMM_CART</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="comment">! Number of remaining cells for a particular coordinate direction</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="comment">! after the bulk has evenly been distributed among the available</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="comment">! processors for that coordinate direction</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordtype">INTEGER</span> :: rem_cells</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">num_dims</a></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(i) = 0</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            </div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="comment">! Performing the computational domain decomposition. The procedure</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">! is optimized by ensuring that each processor contains a close to</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">! equivalent piece of the computational domain. Note that explicit</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">! type-casting is omitted here for code legibility purposes.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            </div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="comment">! Generating 3D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">cyl_coord</a> .AND. <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="comment">! Implement pencil processor blocking if using cylindrical coordinates so</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    <span class="comment">! that all cells in azimuthal direction are stored on a single processor.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    <span class="comment">! This is necessary for efficient application of Fourier filter near axis.</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                        num_procs_x =  1</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        num_procs_z =  1</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        tmp_num_procs_z = num_procs_z</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                            </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                            <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                               .AND.                &amp;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                tmp_num_procs_x = i</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                tmp_num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / i</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                                 -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                    .AND.                &amp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y        &amp;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                                     &gt;=                  &amp;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                    </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                    num_procs_x = i</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                    num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                    fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                                     -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                    <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                    </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">                                END IF</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                            </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        num_procs_x =  1</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        num_procs_y =  1</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        tmp_num_procs_z = num_procs_z</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                        + 10d0*abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y  &amp;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                  -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                            </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                            <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                               .AND.                &amp;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                <span class="keywordflow">DO</span> j = 1, (<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                    </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                    <span class="keywordflow">IF</span>(       mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i,j) == 0       &amp;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                                       .AND.                &amp;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/j &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                        </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                        tmp_num_procs_x = i</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                        tmp_num_procs_y = j</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                        tmp_num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / (i*j)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                        </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                        <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x    &amp;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                                         -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)   &amp;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                    + abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y    &amp;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                                         -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)   &amp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                                            .AND.                  &amp;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                    (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z          &amp;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                                             &gt;=                    &amp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                                   <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) &amp;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                                            <span class="keywordflow">THEN</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                           </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                           num_procs_x = i</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                           num_procs_y = j</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                           num_procs_z = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/(i*j)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                           fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                            -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)&amp;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                       + abs((<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y &amp;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                                            -(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1)/tmp_num_procs_z)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                           </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordflow">                                        END IF</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                        </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">                                    END IF</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                    </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                            </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    <span class="comment">! Checking whether the decomposition of the computational</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    <span class="comment">! domain was successful</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0 .AND. <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to decompose computational &#39;</span> // &amp;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                     <span class="stringliteral">&#39;domain for selected number of &#39;</span> // &amp;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                     <span class="stringliteral">&#39;processors. Exiting ...&#39;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 3, (/ num_procs_x, &amp;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                          num_procs_y, num_procs_z /),       &amp;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                          (/ .true., .true., .true. /),      &amp;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                          .false., mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>       )</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    <span class="comment">! Finding corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <span class="comment">! processor rank in newly declared cartesian communicator</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 3, &amp;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="comment">! END: Generating 3D Cartesian Processor Topology ==================</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="comment">! Sub-domain Global Parameters in z-direction ======================</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    <span class="comment">! Number of remaining cells after majority is distributed</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1, num_procs_z)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) / num_procs_z - 1</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> + 1</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                            <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    <span class="comment">! Boundary condition at the beginning</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &gt; 0 .OR. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) - 1</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        <span class="keyword">CALL </span>mpi_cart_rank( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, &amp;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) + 1</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    </div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="comment">! Ghost zone at the beginning</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &gt; 0 .AND. <span class="keyword">format</span> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg = 2</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%beg = 0</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="comment">! Boundary condition at the end</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &lt; num_procs_z-1 .OR. <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) + 1</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        <span class="keyword">CALL </span>mpi_cart_rank( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, &amp;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>              )</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) - 1</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="comment">! Ghost zone at the end</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &lt; num_procs_z-1 .AND. <span class="keyword">format</span> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end = 2</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">offset_z</a>%end = 0</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(3) = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(3) = (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(3) + rem_cells</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="comment">! Generating 2D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="comment">! Initial values of the processor factorization optimization</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    num_procs_x =  1</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = -1</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="comment">! Computing minimization variable for these initial values</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    tmp_num_procs_x = num_procs_x</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    tmp_num_procs_y = num_procs_y</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    fct_min         = 10d0*abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                              -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <span class="comment">! Searching for optimal computational domain distribution</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                        <span class="keywordflow">IF</span>(        mod(<a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>,i) == 0        &amp;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                           .AND.                &amp;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                            (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/i &gt;= <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                            </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                            tmp_num_procs_x = i</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            tmp_num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a> / i</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                            <span class="keywordflow">IF</span>( fct_min &gt;= abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x  &amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                             -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y) &amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                                .AND.                &amp;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y        &amp;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                                 &gt;=                  &amp;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                       <a class="code" href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">num_stcls_min</a>*<a class="code" href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">weno_order</a>      ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                num_procs_x = i</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                num_procs_y = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a>/i</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                fct_min     = abs((<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1)/tmp_num_procs_x &amp;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                                 -(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)/tmp_num_procs_y)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>        = 0</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                            </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                        </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <span class="comment">! Checking whether the decomposition of the computational</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="comment">! domain was successful</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0 .AND. <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39;Unable to decompose computational &#39;</span> // &amp;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                     <span class="stringliteral">&#39;domain for selected number of &#39;</span> // &amp;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                     <span class="stringliteral">&#39;processors. Exiting ...&#39;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        <span class="keyword">CALL </span>mpi_abort(mpi_comm_world, <a class="code" href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">err_code</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 2, (/ num_procs_x, &amp;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                          num_procs_y /), (/ .true.,         &amp;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                          .true. /), .false., mpi_comm_cart, &amp;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    <span class="comment">! Finding corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <span class="comment">! processor rank in newly declared cartesian communicator</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 2, &amp;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="comment">! END: Generating 2D Cartesian Processor Topology ==================</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">! Sub-domain Global Parameters in y-direction ======================</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="comment">! Number of remaining cells after majority has been distributed</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1, num_procs_y)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                </div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) / num_procs_y - 1</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                </div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> + 1</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="comment">! Boundary condition at the beginning</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &gt; 0 .OR. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) - 1</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_rank( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, &amp;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                  )</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) + 1</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="comment">! Ghost zone at the beginning</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &gt; 0 .AND. <span class="keyword">format</span> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg = 2</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%beg = 0</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="comment">! Boundary condition at the end</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &lt; num_procs_y-1 .OR. <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) + 1</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="keyword">CALL </span>mpi_cart_rank( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, &amp;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                        <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                  )</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) - 1</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="comment">! Ghost zone at the end</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &lt; num_procs_y-1 .AND. <span class="keyword">format</span> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end = 2</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">offset_y</a>%end = 0</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(2) = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(2) = (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(2) + rem_cells</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="comment">! Generating 1D Cartesian Processor Topology =======================</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">! Number of processors in the coordinate direction is equal to</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="comment">! the total number of processors available</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                num_procs_x = <a class="code" href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">num_procs</a></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="comment">! Number of cells in undecomposed computational domain needed</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="comment">! for sub-domain reassembly during formatted data output</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <a class="code" href="namespacem__global__parameters.html#afabaedf16b26e327635e956d13b45086">m_root</a> = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                </div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <span class="comment">! Creating a new communicator using Cartesian topology</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="keyword">CALL </span>mpi_cart_create( mpi_comm_world, 1, (/ num_procs_x /), &amp;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                      (/ .true. /), .false., mpi_comm_cart, &amp;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                  )</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <span class="comment">! Finding the corresponding Cartesian coordinates of the local</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="comment">! processor rank in the newly declared cartesian communicator</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="keyword">CALL </span>mpi_cart_coords( mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a>, 1, &amp;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>            )</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            </div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            </div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">! Sub-domain Global Parameters in x-direction ======================</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="comment">! Number of remaining cells after majority has been distributed</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            rem_cells = mod(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, num_procs_x)</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="comment">! Optimal number of cells per processor</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) / num_procs_x - 1</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">! Distributing any remaining cells</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">DO</span> i = 1, rem_cells</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) == i-1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a> + 1</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="comment">! Boundary condition at the beginning</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &gt; 0 .OR. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) - 1</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keyword">CALL </span>mpi_cart_rank(mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) + 1</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="comment">! Ghost zone at the beginning</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &gt; 0 .AND. <span class="keyword">format</span> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg = 2</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%beg = 0</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="comment">! Boundary condition at the end</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &lt; num_procs_x-1 .OR. <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end == -1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) + 1</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keyword">CALL </span>mpi_cart_rank(mpi_comm_cart, <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) = <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) - 1</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            </div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="comment">! Ghost zone at the end</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1)&lt; num_procs_x-1 .AND. <span class="keyword">format</span> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end = 2</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <a class="code" href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">offset_x</a>%end = 0</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">parallel_io</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) &lt; rem_cells) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(1) = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">start_idx</a>(1) = (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1) * <a class="code" href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">proc_coords</a>(1) + rem_cells</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">s_mpi_decompose_computational_domain</a> <span class="comment">! ------------------</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        </div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a8e48d59a04981a6594f25ad7a7562492">s_mpi_sendrecv_grid_vars_buffer_regions</a>(pbc_loc, sweep_coord)</div><div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a8e48d59a04981a6594f25ad7a7562492">  892</a></span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordtype">CHARACTER(LEN = 3)</span>, <span class="keywordtype">INTENT(IN)</span> :: pbc_loc</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordtype">CHARACTER</span>, <span class="keywordtype">INTENT(IN)</span> :: sweep_coord</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">! Communications in the x-direction ================================</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            </div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="keywordflow">IF</span>(sweep_coord == <span class="stringliteral">&#39;x&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                    </div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                        </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%end/bc_x%beg</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 0, &amp;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 0, &amp;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%beg/bc_x%beg</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, &amp;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 0, &amp;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                    </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%beg/bc_x%end</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, &amp;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, &amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%end/bc_x%end</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 0, &amp;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">dx</a>(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, &amp;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                </div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">! END: Communications in the x-direction ===========================</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                </div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="comment">! Communications in the y-direction ================================</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">ELSEIF</span>(sweep_coord == <span class="stringliteral">&#39;y&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    </div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                        </div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%end/bc_y%beg</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 0, &amp;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 0, &amp;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        </div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%beg/bc_y%beg</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, &amp;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 0, &amp;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                        </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%beg/bc_y%end</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, &amp;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, &amp;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                        </div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                        </div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%end/bc_y%end</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 0, &amp;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">dy</a>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, &amp;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                        </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="comment">! END: Communications in the y-direction ===========================</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="comment">! Communications in the z-direction ================================</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                        </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%end/bc_z%beg</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 0, &amp;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 0, &amp;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                        </div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%beg/bc_z%beg</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, &amp;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,         &amp;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 0, &amp;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    </div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%beg/bc_z%end</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                  &amp;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, &amp;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, &amp;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        </div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%end/bc_z%end</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,      &amp;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 0, &amp;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">dz</a>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>,                &amp;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, &amp;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                </div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="comment">! END: Communications in the z-direction ===========================</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            </div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            </div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a8e48d59a04981a6594f25ad7a7562492">s_mpi_sendrecv_grid_vars_buffer_regions</a> <span class="comment">! ---------------</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        </div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a4d7ec0d1976967504babdf44ec83c1b1">s_mpi_sendrecv_cons_vars_buffer_regions</a>(q_cons_vf, pbc_loc, &amp;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                                               sweep_coord     )</div><div class="line"><a name="l01094"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a4d7ec0d1976967504babdf44ec83c1b1"> 1094</a></span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), &amp;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">DIMENSION(sys_size)</span>, &amp;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_cons_vf</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordtype">CHARACTER(LEN = 3)</span>, <span class="keywordtype">INTENT(IN)</span> :: pbc_loc</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordtype">CHARACTER</span>, <span class="keywordtype">INTENT(IN)</span> :: sweep_coord</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            </div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l,r</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            </div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="comment">! Communications in the x-direction ================================</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordflow">IF</span>(sweep_coord == <span class="stringliteral">&#39;x&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                </div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    </div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_x%end</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j-<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1)   &amp;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k + (i-1) &amp;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                        </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%end/bc_x%beg</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0),              &amp;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 0, &amp;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                          <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),               &amp;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 0, &amp;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                          mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                        </div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                        </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_x%beg</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                        r = (i-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*j         &amp;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k       &amp;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        </div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%beg/bc_x%beg</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0),              &amp;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, &amp;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                          <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),               &amp;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 0, &amp;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                          mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    </div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    <span class="comment">! Unpacking the data received from bc_x%beg</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                        <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                            <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, -1</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                    r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k + (i-1) &amp;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                        </div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_x%beg</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                        r = (i-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*j         &amp;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k       &amp;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                        </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%beg/bc_x%end</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0),              &amp;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%beg, 1, &amp;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                          <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),               &amp;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, &amp;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                          mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        </div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_x%end</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j-<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1)   &amp;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k + (i-1) &amp;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        </div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_x%end/bc_x%end</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0),              &amp;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 0, &amp;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                          <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),               &amp;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),    &amp;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                          mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">bc_x</a>%end, 1, &amp;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                          mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                          <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    </div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    <span class="comment">! Unpacking the data received from bc_x%end</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                        <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                            <span class="keywordflow">DO</span> j = <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                    r = (i-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j-<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>-1)   &amp;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*k       &amp;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1)*l</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    </div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                </div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="comment">! END: Communications in the x-direction ===========================</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                </div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="comment">! Communications in the y-direction ================================</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                </div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keywordflow">ELSEIF</span>(sweep_coord == <span class="stringliteral">&#39;y&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                    </div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                        </div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_y%end</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                            (k-<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1) + (i-1)    &amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        </div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%end/bc_y%beg</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), mpi_double_precision,       &amp;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 0, <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),  &amp;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *               &amp;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),           &amp;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 0, &amp;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                        </div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                        </div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_y%beg</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*k &amp;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l + (i-1)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                        </div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%beg/bc_y%beg</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), mpi_double_precision,       &amp;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),  &amp;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *               &amp;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),           &amp;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 0, &amp;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        </div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    </div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                    <span class="comment">! Unpacking the data received from bc_y%beg</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                        <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, -1</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                            <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                    r = (i-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) &amp;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *   &amp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                        (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *     &amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                    </div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    </div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        </div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_y%beg</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*k &amp;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l + (i-1)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        </div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%beg/bc_y%end</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), mpi_double_precision,       &amp;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%beg, 1, <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),  &amp;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *               &amp;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),           &amp;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, &amp;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                        </div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        </div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_y%end</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                            <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                            (k-<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1) + (i-1)    &amp;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                            <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                        </div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_y%end/bc_y%end</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1), mpi_double_precision,       &amp;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 0, <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0),  &amp;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *               &amp;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1),           &amp;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">bc_y</a>%end, 1, &amp;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                        </div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                    </div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                    <span class="comment">! Unpacking the data received form bc_y%end</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                    <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                        <span class="keywordflow">DO</span> k = <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+1, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                            <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                                    r = (i-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) &amp;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *   &amp;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                        (k-<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>-1) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *           &amp;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>*l</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                    </div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                </div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="comment">! END: Communications in the y-direction ===========================</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                </div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="comment">! Communications in the z-direction ================================</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                </div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                </div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                <span class="keywordflow">IF</span>(pbc_loc == <span class="stringliteral">&#39;beg&#39;</span>) <span class="keywordflow">THEN</span>    <span class="comment">! Buffer region at the beginning</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    </div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                        </div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_z%end</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                            (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *   &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *          &amp;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *          &amp;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                            (l-<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1) + (i-1)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                        </div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%end/bc_z%beg</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 0, &amp;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                           <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *   &amp;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 0, &amp;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                        </div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                    <span class="comment">! PBC only at beginning of the sub-domain</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                        </div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_z%beg</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                                            (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + (i-1)        &amp;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*l</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        </div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%beg/bc_z%beg</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, &amp;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                           <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *   &amp;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 0, &amp;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                        </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    </div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                    <span class="comment">! Unpacking the data from bc_z%beg</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    <span class="keywordflow">DO</span> l = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, -1</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                            <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                    r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)         &amp;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *   &amp;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                        (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + (i-1)          &amp;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *   &amp;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(l+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                    </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <span class="keywordflow">ELSE</span>                         <span class="comment">! Buffer region at the end</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                    </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                    <span class="comment">! PBC at both ends of the sub-domain</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg &gt;= 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                        </div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_z%beg</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                        <span class="keywordflow">DO</span> l = 0, <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                            (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + (i-1)        &amp;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*l</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                                   q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                        </div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%beg/bc_z%end</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%beg, 1, &amp;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                           <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *   &amp;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, &amp;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                        </div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                    <span class="comment">! PBC only at end of the sub-domain</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                        </div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                        <span class="comment">! Packing the data to be sent to bc_z%end</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                        <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                            <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                    <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                                        r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                          + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                                            (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a> *   &amp;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *          &amp;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                                            (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *          &amp;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                            (l-<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>-1) + (i-1)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                                        <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(r) = &amp;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                                q_cons_vf(i)%sf(j,k,l)</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="keywordflow">                                    END DO</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                        </div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                        <span class="comment">! Sending/receiving the data to/from bc_z%end/bc_z%end</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                        <span class="keyword">CALL </span>mpi_sendrecv( <a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *  &amp;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 0, &amp;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                                           <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(0), <a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> *   &amp;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) *       &amp;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                           (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1),                 &amp;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                                           mpi_double_precision, <a class="code" href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">bc_z</a>%end, 1, &amp;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                                           mpi_comm_world, mpi_status_ignore, &amp;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                                           <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                               )</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                        </div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                    </div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                    <span class="comment">! Unpacking the data received from bc_z%end</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                    <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+1, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                        <span class="keywordflow">DO</span> k = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                            <span class="keywordflow">DO</span> j = -<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                    r = <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(j+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>)       &amp;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                                        (k+<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>) + (i-1)        &amp;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                      + <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>*(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1) * &amp;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                                        (<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>+2*<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a>+1)*(l-<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>-1)</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                    q_cons_vf(i)%sf(j,k,l) = <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>(r)</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordflow">                        END DO</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                    </div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                </div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            </div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="comment">! END: Communications in the z-direction ===========================</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            </div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            </div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a4d7ec0d1976967504babdf44ec83c1b1">s_mpi_sendrecv_cons_vars_buffer_regions</a> <span class="comment">! ---------------</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        </div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        </div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        </div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        </div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734">s_mpi_reduce_maxloc</a>(var_loc) <span class="comment">! ------------------------------</span></div><div class="line"><a name="l01631"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734"> 1631</a></span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: var_loc</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(2)</span> :: var_glb</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            </div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="comment">! Performing reduction procedure and eventually storing its result</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="comment">! into the variable that was initially inputted into the subroutine</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="keyword">CALL </span>mpi_reduce( var_loc, var_glb, 1, mpi_2double_precision, &amp;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                             mpi_maxloc, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>          )</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            </div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keyword">CALL </span>mpi_bcast( var_glb, 1, mpi_2double_precision, &amp;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                                      0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>   )</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            </div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            var_loc = var_glb</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            </div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734">s_mpi_reduce_maxloc</a> <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        </div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        </div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        </div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ab2ced8f095b812fcc355539c2c5fa162">s_mpi_gather_spatial_extents</a>(spatial_extents) <span class="comment">! -------------</span></div><div class="line"><a name="l01661"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#ab2ced8f095b812fcc355539c2c5fa162"> 1661</a></span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(1:,0:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: spatial_extents</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            </div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            </div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="comment">! Simulation is 3D</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">grid_geometry</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    <span class="comment">! Minimum spatial extent in the r-direction</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                                      spatial_extents(1,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                    </div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                    <span class="comment">! Minimum spatial extent in the theta-direction</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                                      spatial_extents(2,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                    </div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                    <span class="comment">! Minimum spatial extent in the z-direction</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                      spatial_extents(3,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                    </div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                    <span class="comment">! Maximum spatial extent in the r-direction</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                      spatial_extents(4,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    </div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                    <span class="comment">! Maximum spatial extent in the theta-direction</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                                      spatial_extents(5,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                    </div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                    <span class="comment">! Maximum spatial extent in the z-direction</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                                      spatial_extents(6,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                    <span class="comment">! Minimum spatial extent in the x-direction</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                      spatial_extents(1,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    </div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    <span class="comment">! Minimum spatial extent in the y-direction</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                      spatial_extents(2,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    </div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    <span class="comment">! Minimum spatial extent in the z-direction</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                                      spatial_extents(3,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                    </div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                    <span class="comment">! Maximum spatial extent in the x-direction</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                      spatial_extents(4,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                    </div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                    <span class="comment">! Maximum spatial extent in the y-direction</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                      spatial_extents(5,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                    </div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    <span class="comment">! Maximum spatial extent in the z-direction</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                    <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">z_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                      spatial_extents(6,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 6*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                      mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                      <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <span class="comment">! Simulation is 2D</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                </div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                <span class="comment">! Minimum spatial extent in the x-direction</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                  spatial_extents(1,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 4*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                </div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                <span class="comment">! Minimum spatial extent in the y-direction</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( minval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                  spatial_extents(2,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 4*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                </div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                <span class="comment">! Maximum spatial extent in the x-direction</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                  spatial_extents(3,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 4*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                <span class="comment">! Maximum spatial extent in the y-direction</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( maxval(<a class="code" href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">y_cb</a>), 1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                                  spatial_extents(4,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 4*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>, &amp;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world,    &amp;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                        )</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                </div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            </div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            </div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ab2ced8f095b812fcc355539c2c5fa162">s_mpi_gather_spatial_extents</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        </div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        </div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        </div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        </div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ac15a15ba12e6110bb015af0ece5bba47">s_mpi_defragment_1d_grid_variable</a>() <span class="comment">! -----------------------</span></div><div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#ac15a15ba12e6110bb015af0ece5bba47"> 1781</a></span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="comment">! Silo-HDF5 database format</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            <span class="keywordflow">IF</span>(<span class="keyword">format</span> == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                </div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( <a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(0), <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a94882b68d8ecf627c44e55c567659807">x_root_cc</a>(0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>,        &amp;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world, &amp;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                     )</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                </div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            <span class="comment">! Binary database format</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                </div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="keyword">CALL </span>mpi_gatherv( <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(0), <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, mpi_double_precision,      &amp;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a44deb07824e0bcefed07571e50258d19">x_root_cb</a>(0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>,        &amp;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                  mpi_double_precision, 0, mpi_comm_world, &amp;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                  <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>                                     )</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                </div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">proc_rank</a> == 0) <a class="code" href="namespacem__global__parameters.html#a44deb07824e0bcefed07571e50258d19">x_root_cb</a>(-1) = <a class="code" href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">x_cb</a>(-1)</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                </div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            </div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ac15a15ba12e6110bb015af0ece5bba47">s_mpi_defragment_1d_grid_variable</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        </div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        </div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        </div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a0b226acd5a9097566685604292c3ae0d">s_mpi_gather_data_extents</a>(q_sf, data_extents) <span class="comment">! -------------</span></div><div class="line"><a name="l01816"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a0b226acd5a9097566685604292c3ae0d"> 1816</a></span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            </div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: q_sf</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            </div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            <span class="keywordtype">DIMENSION(1:2,0:num_procs-1)</span>, &amp;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: data_extents</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            </div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            </div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <span class="comment">! Mimimum flow variable extent</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            <span class="keyword">CALL </span>mpi_gatherv( minval(q_sf), 1, mpi_double_precision,        &amp;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                              data_extents(1,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 2*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>,      &amp;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                              mpi_double_precision, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            </div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="comment">! Maximum flow variable extent</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keyword">CALL </span>mpi_gatherv( maxval(q_sf), 1, mpi_double_precision,        &amp;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                              data_extents(2,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, 2*<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>,      &amp;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                              mpi_double_precision, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            </div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            </div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a0b226acd5a9097566685604292c3ae0d">s_mpi_gather_data_extents</a> <span class="comment">! -----------------------------</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        </div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        </div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ae5286531f6390643aad1e4db5d5f6d91">s_mpi_defragment_1d_flow_variable</a>(q_sf, q_root_sf) <span class="comment">! --------</span></div><div class="line"><a name="l01847"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#ae5286531f6390643aad1e4db5d5f6d91"> 1847</a></span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            <span class="keywordtype">DIMENSION(0:m,0:0,0:0)</span>, &amp;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="keywordtype">INTENT(IN)</span> :: q_sf</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            </div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, &amp;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <span class="keywordtype">DIMENSION(0:m_root,0:0,0:0)</span>, &amp;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            <span class="keywordtype">INTENT(INOUT)</span> :: q_root_sf</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            </div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;            <span class="comment">! Gathering the sub-domain flow variable data from all the processes</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <span class="comment">! and putting it back together for the entire computational domain</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <span class="comment">! on the process with rank 0</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="keyword">CALL </span>mpi_gatherv( q_sf(0,0,0), <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>+1, mpi_double_precision,       &amp;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                              q_root_sf(0,0,0), <a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>, <a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>,         &amp;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                              mpi_double_precision, 0, mpi_comm_world, <a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a> )</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            </div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            </div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ae5286531f6390643aad1e4db5d5f6d91">s_mpi_defragment_1d_flow_variable</a> <span class="comment">! ---------------------</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        </div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        </div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        </div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        </div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ac984c84fe4140876d6600250af9807da">s_finalize_mpi_proxy_module</a>() <span class="comment">! ---------------------------</span></div><div class="line"><a name="l01871"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#ac984c84fe4140876d6600250af9807da"> 1871</a></span>&#160;            </div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            <span class="comment">! Deallocating the conservative variables buffer vectors</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">buff_size</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                <span class="keyword">DEALLOCATE</span>( <a class="code" href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">q_cons_buffer_in</a>)</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">q_cons_buffer_out</a>)</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            </div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            </div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="comment">! Deallocating the recieve counts and the displacement vector</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <span class="comment">! variables used in variable-gather communication procedures</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            <span class="keywordflow">IF</span>((<span class="keyword">format</span> == 1 .AND. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) .OR. <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> == 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">recvcounts</a>)</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">displs</a>)</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            </div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            </div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#ac984c84fe4140876d6600250af9807da">s_finalize_mpi_proxy_module</a> <span class="comment">! -------------------------</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        </div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        </div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        </div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        </div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">s_mpi_finalize</a>() <span class="comment">! ------------------------------</span></div><div class="line"><a name="l01894"></a><span class="lineno"><a class="line" href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5"> 1894</a></span>&#160;            </div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <span class="comment">! Terminating the MPI environment</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            <span class="keyword">CALL </span>mpi_finalize(<a class="code" href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">ierr</a>)</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            </div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">s_mpi_finalize</a> <span class="comment">! ----------------------------</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        </div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        </div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        </div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        </div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        </div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttc" id="namespacem__global__parameters_html_a44deb07824e0bcefed07571e50258d19"><div class="ttname"><a href="namespacem__global__parameters.html#a44deb07824e0bcefed07571e50258d19">m_global_parameters::x_root_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_root_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00088">m_global_parameters.f90:88</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab6d5da2756e61a0695236e24ad920e38"><div class="ttname"><a href="namespacem__global__parameters.html#ab6d5da2756e61a0695236e24ad920e38">m_global_parameters::kappa_wrt</a></div><div class="ttdeci">logical, dimension(num_fluids_max) kappa_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00209">m_global_parameters.f90:209</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aff1140575af25247060f3e7f31a8a10f"><div class="ttname"><a href="namespacem__global__parameters.html#aff1140575af25247060f3e7f31a8a10f">m_global_parameters::t_step_stop</a></div><div class="ttdeci">integer t_step_stop</div><div class="ttdoc">Last time-step directory. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00108">m_global_parameters.f90:108</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a3d449655a88a9e5248af35a82caf877a"><div class="ttname"><a href="namespacem__mpi__proxy.html#a3d449655a88a9e5248af35a82caf877a">m_mpi_proxy::q_cons_buffer_out</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable q_cons_buffer_out</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00059">m_mpi_proxy.f90:59</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4438313a11564fa911c586d2dee15b8d"><div class="ttname"><a href="namespacem__global__parameters.html#a4438313a11564fa911c586d2dee15b8d">m_global_parameters::re_inv</a></div><div class="ttdeci">real(kind(0d0)) re_inv</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00258">m_global_parameters.f90:258</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a48dea2bc17c5e4465a444c926070ae9b"><div class="ttname"><a href="namespacem__global__parameters.html#a48dea2bc17c5e4465a444c926070ae9b">m_global_parameters::proc_coords</a></div><div class="ttdeci">integer, dimension(:), allocatable proc_coords</div><div class="ttdoc">Processor coordinates in MPI_CART_COMM. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00151">m_global_parameters.f90:151</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8892cc67c7d04be4d8e6d02a86e209bc"><div class="ttname"><a href="namespacem__global__parameters.html#a8892cc67c7d04be4d8e6d02a86e209bc">m_global_parameters::fd_order</a></div><div class="ttdeci">integer fd_order</div><div class="ttdoc">The order of the finite-difference (fd) approximations of the first-order derivatives that need to be...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00237">m_global_parameters.f90:237</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a17169a5387f8f1efd5ac34cb4eae7c81"><div class="ttname"><a href="namespacem__global__parameters.html#a17169a5387f8f1efd5ac34cb4eae7c81">m_global_parameters::thermal</a></div><div class="ttdeci">integer thermal</div><div class="ttdoc">1 = adiabatic, 2 = isotherm, 3 = transfer </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00263">m_global_parameters.f90:263</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a576bd60474fdaccd3ee42edaaabddefa"><div class="ttname"><a href="namespacem__global__parameters.html#a576bd60474fdaccd3ee42edaaabddefa">m_global_parameters::offset_y</a></div><div class="ttdeci">type(bounds_info) offset_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a629b922f4d06112a6d03d7864872990f"><div class="ttname"><a href="namespacem__global__parameters.html#a629b922f4d06112a6d03d7864872990f">m_global_parameters::alpha_rho_wrt</a></div><div class="ttdeci">logical, dimension(num_fluids_max) alpha_rho_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00203">m_global_parameters.f90:203</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a46461347b5094736adfa94ef005b49a6"><div class="ttname"><a href="namespacem__global__parameters.html#a46461347b5094736adfa94ef005b49a6">m_global_parameters::ierr</a></div><div class="ttdeci">integer, private ierr</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00165">m_global_parameters.f90:165</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_abfbc42cea69273bc9fa4a2d78f636eb1"><div class="ttname"><a href="namespacem__mpi__proxy.html#abfbc42cea69273bc9fa4a2d78f636eb1">m_mpi_proxy::s_mpi_barrier</a></div><div class="ttdeci">subroutine s_mpi_barrier()</div><div class="ttdoc">Halts all processes until all have reached barrier. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00164">m_mpi_proxy.f90:164</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a80c5e235786545276fe6ffa06965017f"><div class="ttname"><a href="namespacem__mpi__proxy.html#a80c5e235786545276fe6ffa06965017f">m_mpi_proxy::s_mpi_decompose_computational_domain</a></div><div class="ttdeci">subroutine s_mpi_decompose_computational_domain()</div><div class="ttdoc">This subroutine takes care of efficiently distributing the computational domain among the available p...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00440">m_mpi_proxy.f90:440</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a98b51eda2c46660b439c0a8375385165"><div class="ttname"><a href="namespacem__global__parameters.html#a98b51eda2c46660b439c0a8375385165">m_global_parameters::t_step_save</a></div><div class="ttdeci">integer t_step_save</div><div class="ttdoc">Interval between consecutive time-step directory. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00109">m_global_parameters.f90:109</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a94882b68d8ecf627c44e55c567659807"><div class="ttname"><a href="namespacem__global__parameters.html#a94882b68d8ecf627c44e55c567659807">m_global_parameters::x_root_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_root_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00094">m_global_parameters.f90:94</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a9bc4c617505152d3cc553e5bc25c1ee1"><div class="ttname"><a href="namespacem__mpi__proxy.html#a9bc4c617505152d3cc553e5bc25c1ee1">m_mpi_proxy::s_mpi_initialize</a></div><div class="ttdeci">subroutine s_mpi_initialize()</div><div class="ttdoc">The subroutine intializes the MPI environment and queries both the number of processors that will be ...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00084">m_mpi_proxy.f90:84</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa46a7f3638e49fa9ec33ea859b9e6a5a"><div class="ttname"><a href="namespacem__global__parameters.html#aa46a7f3638e49fa9ec33ea859b9e6a5a">m_global_parameters::bc_x</a></div><div class="ttdeci">type(bounds_info) bc_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a32791d9d5fef0213f01fc31713b17ae8"><div class="ttname"><a href="namespacem__global__parameters.html#a32791d9d5fef0213f01fc31713b17ae8">m_global_parameters::polydisperse</a></div><div class="ttdeci">logical polydisperse</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00262">m_global_parameters.f90:262</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00169">m_global_parameters.f90:169</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adab11dab474410541d4c37725bea01e1"><div class="ttname"><a href="namespacem__global__parameters.html#adab11dab474410541d4c37725bea01e1">m_global_parameters::n_glb</a></div><div class="ttdeci">integer n_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2db51a0beed308d7a3c51c5c0ed45609"><div class="ttname"><a href="namespacem__global__parameters.html#a2db51a0beed308d7a3c51c5c0ed45609">m_global_parameters::coarsen_silo</a></div><div class="ttdeci">logical coarsen_silo</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00182">m_global_parameters.f90:182</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ae5709407e3600d19d79b183e409bb982"><div class="ttname"><a href="namespacem__mpi__proxy.html#ae5709407e3600d19d79b183e409bb982">m_mpi_proxy::err_code</a></div><div class="ttdeci">integer, private err_code</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00072">m_mpi_proxy.f90:72</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, stiffened equation of state and finally, the formatted database file(s) structure. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aabc3362b8f53b08f4f113e699d449754"><div class="ttname"><a href="namespacem__global__parameters.html#aabc3362b8f53b08f4f113e699d449754">m_global_parameters::rho_wrt</a></div><div class="ttdeci">logical rho_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00204">m_global_parameters.f90:204</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a71f091e6074e6c248fd7e03218b89218"><div class="ttname"><a href="namespacem__global__parameters.html#a71f091e6074e6c248fd7e03218b89218">m_global_parameters::num_stcls_min</a></div><div class="ttdeci">integer, parameter num_stcls_min</div><div class="ttdoc">Mininum # of stencils. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00053">m_global_parameters.f90:53</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ac984c84fe4140876d6600250af9807da"><div class="ttname"><a href="namespacem__mpi__proxy.html#ac984c84fe4140876d6600250af9807da">m_mpi_proxy::s_finalize_mpi_proxy_module</a></div><div class="ttdeci">subroutine s_finalize_mpi_proxy_module()</div><div class="ttdoc">Deallocation procedures for the module. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01871">m_mpi_proxy.f90:1871</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00051">m_derived_types.f90:51</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ada8a4a23b5804dfa9843b25ddd1cd8c1"><div class="ttname"><a href="namespacem__global__parameters.html#ada8a4a23b5804dfa9843b25ddd1cd8c1">m_global_parameters::schlieren_alpha</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids_max) schlieren_alpha</div><div class="ttdoc">Amplitude coefficients of the numerical Schlieren function that are used to adjust the intensity of n...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00231">m_global_parameters.f90:231</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_afb66fcff0c17f2298a9b7a35c85dedb7"><div class="ttname"><a href="namespacem__global__parameters.html#afb66fcff0c17f2298a9b7a35c85dedb7">m_global_parameters::pi_inf_wrt</a></div><div class="ttdeci">logical pi_inf_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00215">m_global_parameters.f90:215</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00256">m_global_parameters.f90:256</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00251">m_global_parameters.f90:251</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a35133a9d59c33919af73594f804d2fd9"><div class="ttname"><a href="namespacem__global__parameters.html#a35133a9d59c33919af73594f804d2fd9">m_global_parameters::flux_wrt</a></div><div class="ttdeci">logical, dimension(3) flux_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00208">m_global_parameters.f90:208</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a68eaaca2982b39252417b29ef5d0f9c3"><div class="ttname"><a href="namespacem__global__parameters.html#a68eaaca2982b39252417b29ef5d0f9c3">m_global_parameters::bc_y</a></div><div class="ttdeci">type(bounds_info) bc_y</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aa436c56a050419e85c8c08611a688e63"><div class="ttname"><a href="namespacem__global__parameters.html#aa436c56a050419e85c8c08611a688e63">m_global_parameters::y_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable y_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00088">m_global_parameters.f90:88</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d11d820127525a02b4c6f9d09fad258"><div class="ttname"><a href="namespacem__global__parameters.html#a5d11d820127525a02b4c6f9d09fad258">m_global_parameters::mom_wrt</a></div><div class="ttdeci">logical, dimension(3) mom_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00205">m_global_parameters.f90:205</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abd9ada93ee5222de406111ee9c91ddf0"><div class="ttname"><a href="namespacem__global__parameters.html#abd9ada93ee5222de406111ee9c91ddf0">m_global_parameters::x_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00088">m_global_parameters.f90:88</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a795878d693cec161db5f5c06aea7331e"><div class="ttname"><a href="namespacem__global__parameters.html#a795878d693cec161db5f5c06aea7331e">m_global_parameters::prim_vars_wrt</a></div><div class="ttdeci">logical prim_vars_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00217">m_global_parameters.f90:217</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a43fbda10c02ec8bc1fc572c83090f2e5"><div class="ttname"><a href="namespacem__mpi__proxy.html#a43fbda10c02ec8bc1fc572c83090f2e5">m_mpi_proxy::s_mpi_finalize</a></div><div class="ttdeci">subroutine s_mpi_finalize()</div><div class="ttdoc">Finalization of all MPI related processes. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01894">m_mpi_proxy.f90:1894</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ace0c8a67825d0dccd2e23b5d0f9985c0"><div class="ttname"><a href="namespacem__global__parameters.html#ace0c8a67825d0dccd2e23b5d0f9985c0">m_global_parameters::t_step_start</a></div><div class="ttdeci">integer t_step_start</div><div class="ttdoc">First time-step directory. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00107">m_global_parameters.f90:107</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acd86b6cea52b83b147f680d9d6da342c"><div class="ttname"><a href="namespacem__global__parameters.html#acd86b6cea52b83b147f680d9d6da342c">m_global_parameters::schlieren_wrt</a></div><div class="ttdeci">logical schlieren_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00221">m_global_parameters.f90:221</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aacf46ffa4ec2f27743a20fb3016f2c82"><div class="ttname"><a href="namespacem__global__parameters.html#aacf46ffa4ec2f27743a20fb3016f2c82">m_global_parameters::offset_z</a></div><div class="ttdeci">type(bounds_info) offset_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a24492f9b474683476a342e7ee42c1c6d"><div class="ttname"><a href="namespacem__global__parameters.html#a24492f9b474683476a342e7ee42c1c6d">m_global_parameters::r0ref</a></div><div class="ttdeci">real(kind(0d0)) r0ref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00257">m_global_parameters.f90:257</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1072f221ca8e41b0ea3240b33374cc1e"><div class="ttname"><a href="namespacem__global__parameters.html#a1072f221ca8e41b0ea3240b33374cc1e">m_global_parameters::p_glb</a></div><div class="ttdeci">integer p_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This module features the definitions of all the custom-defined derived types that are utilized throug...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1f932e794cad6291b2e6c62b93dcf533"><div class="ttname"><a href="namespacem__global__parameters.html#a1f932e794cad6291b2e6c62b93dcf533">m_global_parameters::z_cb</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable z_cb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00088">m_global_parameters.f90:88</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad23223100223bdb6d7f59fed5ec7bbb9"><div class="ttname"><a href="namespacem__global__parameters.html#ad23223100223bdb6d7f59fed5ec7bbb9">m_global_parameters::cons_vars_wrt</a></div><div class="ttdeci">logical cons_vars_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00218">m_global_parameters.f90:218</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a61f570bcde70f7013523e11d93c66929"><div class="ttname"><a href="namespacem__global__parameters.html#a61f570bcde70f7013523e11d93c66929">m_global_parameters::alpha_wrt</a></div><div class="ttdeci">logical, dimension(num_fluids_max) alpha_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00212">m_global_parameters.f90:212</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a81724112f8d98fe4345fc37eb13a51b2"><div class="ttname"><a href="namespacem__global__parameters.html#a81724112f8d98fe4345fc37eb13a51b2">m_global_parameters::e_wrt</a></div><div class="ttdeci">logical e_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1fcd6cc13ad7f604ef81708716a1feac"><div class="ttname"><a href="namespacem__global__parameters.html#a1fcd6cc13ad7f604ef81708716a1feac">m_global_parameters::ca</a></div><div class="ttdeci">real(kind(0d0)) ca</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00258">m_global_parameters.f90:258</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6e342ae3eb66f89e0eeb94e11aa42d92"><div class="ttname"><a href="namespacem__global__parameters.html#a6e342ae3eb66f89e0eeb94e11aa42d92">m_global_parameters::buff_size</a></div><div class="ttdeci">integer buff_size</div><div class="ttdoc">Number of cells in buffer region. For the variables which feature a buffer region, this region is used to store information outside the computational domain based on the boundary conditions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00102">m_global_parameters.f90:102</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of different fluids present in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a444f5e3df80f338ae77ccecd326a325f"><div class="ttname"><a href="namespacem__global__parameters.html#a444f5e3df80f338ae77ccecd326a325f">m_global_parameters::pres_wrt</a></div><div class="ttdeci">logical pres_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00211">m_global_parameters.f90:211</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_aebaa6e3cc66d2431c5fb49896d40d7e6"><div class="ttname"><a href="namespacem__mpi__proxy.html#aebaa6e3cc66d2431c5fb49896d40d7e6">m_mpi_proxy::displs</a></div><div class="ttdeci">integer, dimension(:), allocatable displs</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00067">m_mpi_proxy.f90:67</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a29164826db891e5662ce2bccdbc57d3c"><div class="ttname"><a href="namespacem__global__parameters.html#a29164826db891e5662ce2bccdbc57d3c">m_global_parameters::poly_sigma</a></div><div class="ttdeci">real(kind(0d0)) poly_sigma</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00267">m_global_parameters.f90:267</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaf315f1df492ccc9daaeee046f185bb5"><div class="ttname"><a href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">m_global_parameters::x_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00094">m_global_parameters.f90:94</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ab2ced8f095b812fcc355539c2c5fa162"><div class="ttname"><a href="namespacem__mpi__proxy.html#ab2ced8f095b812fcc355539c2c5fa162">m_mpi_proxy::s_mpi_gather_spatial_extents</a></div><div class="ttdeci">subroutine s_mpi_gather_spatial_extents(spatial_extents)</div><div class="ttdoc">This subroutine gathers the Silo database metadata for the spatial extents in order to boost the perf...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01661">m_mpi_proxy.f90:1661</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ae5286531f6390643aad1e4db5d5f6d91"><div class="ttname"><a href="namespacem__mpi__proxy.html#ae5286531f6390643aad1e4db5d5f6d91">m_mpi_proxy::s_mpi_defragment_1d_flow_variable</a></div><div class="ttdeci">subroutine s_mpi_defragment_1d_flow_variable(q_sf, q_root_sf)</div><div class="ttdoc">This subroutine gathers the sub-domain flow variable data from all of the processors and puts it back...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01847">m_mpi_proxy.f90:1847</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4bd117ae744eab60f3d681fd03d6e90d"><div class="ttname"><a href="namespacem__global__parameters.html#a4bd117ae744eab60f3d681fd03d6e90d">m_global_parameters::start_idx</a></div><div class="ttdeci">integer, dimension(:), allocatable start_idx</div><div class="ttdoc">Starting cell-center index of local processor in global grid. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00154">m_global_parameters.f90:154</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in the system of equations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00124">m_global_parameters.f90:124</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Maximum volume fraction limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00123">m_global_parameters.f90:123</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaf0ab8b40d717a67662251516870b1a6"><div class="ttname"><a href="namespacem__global__parameters.html#aaf0ab8b40d717a67662251516870b1a6">m_global_parameters::omega_wrt</a></div><div class="ttdeci">logical, dimension(3) omega_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00220">m_global_parameters.f90:220</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6ed5e5561c16f30a4010f6612877029d"><div class="ttname"><a href="namespacem__global__parameters.html#a6ed5e5561c16f30a4010f6612877029d">m_global_parameters::precision</a></div><div class="ttdeci">integer precision</div><div class="ttdoc">Floating point precision of the database file(s) </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00185">m_global_parameters.f90:185</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad80f68aac31aa898ab2d7729f60e375f"><div class="ttname"><a href="namespacem__global__parameters.html#ad80f68aac31aa898ab2d7729f60e375f">m_global_parameters::mpi_io_data</a></div><div class="ttdeci">type(mpi_io_var), public mpi_io_data</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00157">m_global_parameters.f90:157</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a0b226acd5a9097566685604292c3ae0d"><div class="ttname"><a href="namespacem__mpi__proxy.html#a0b226acd5a9097566685604292c3ae0d">m_mpi_proxy::s_mpi_gather_data_extents</a></div><div class="ttdeci">subroutine s_mpi_gather_data_extents(q_sf, data_extents)</div><div class="ttdoc">This subroutine gathers the Silo database metadata for the flow variable&amp;#39;s extents as to boost perfor...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01816">m_mpi_proxy.f90:1816</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0f2d413d9739928f8e1a98f0a5783ab9"><div class="ttname"><a href="namespacem__global__parameters.html#a0f2d413d9739928f8e1a98f0a5783ab9">m_global_parameters::grid_geometry</a></div><div class="ttdeci">integer grid_geometry</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00076">m_global_parameters.f90:76</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a0b91e533fe3b3e112c42af4024014544"><div class="ttname"><a href="namespacem__global__parameters.html#a0b91e533fe3b3e112c42af4024014544">m_global_parameters::case_dir</a></div><div class="ttdeci">character(len=path_len) case_dir</div><div class="ttdoc">Case folder location. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a34bbf8acae0d925bb193265fb2966d1c"><div class="ttname"><a href="namespacem__global__parameters.html#a34bbf8acae0d925bb193265fb2966d1c">m_global_parameters::pres_inf_wrt</a></div><div class="ttdeci">logical pres_inf_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00216">m_global_parameters.f90:216</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a30d96803eb46c67ff4f0f1d7c7b92a37"><div class="ttname"><a href="namespacem__global__parameters.html#a30d96803eb46c67ff4f0f1d7c7b92a37">m_global_parameters::dz</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dz</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00099">m_global_parameters.f90:99</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5a19b6ba65c32dfc21f4762eceb25f29"><div class="ttname"><a href="namespacem__global__parameters.html#a5a19b6ba65c32dfc21f4762eceb25f29">m_global_parameters::alt_soundspeed</a></div><div class="ttdeci">logical alt_soundspeed</div><div class="ttdoc">Alternate sound speed. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00127">m_global_parameters.f90:127</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00251">m_global_parameters.f90:251</a></div></div>
<div class="ttc" id="namespacem__derived__types_html_a3dde07670ef3e164534aa68c1830ff62"><div class="ttname"><a href="namespacem__derived__types.html#a3dde07670ef3e164534aa68c1830ff62">m_derived_types::num_fluids_max</a></div><div class="ttdeci">integer, parameter num_fluids_max</div><div class="ttdoc">Maximum number of fluids allowed. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00041">m_derived_types.f90:41</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a53f0d5eed7783c9760aaeeaa0abbd58c"><div class="ttname"><a href="namespacem__global__parameters.html#a53f0d5eed7783c9760aaeeaa0abbd58c">m_global_parameters::cyl_coord</a></div><div class="ttdeci">logical cyl_coord</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00075">m_global_parameters.f90:75</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aafb65952c33f1c363d1040bde29734ea"><div class="ttname"><a href="namespacem__global__parameters.html#aafb65952c33f1c363d1040bde29734ea">m_global_parameters::num_procs</a></div><div class="ttdeci">integer num_procs</div><div class="ttdoc">Number of processors. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00052">m_global_parameters.f90:52</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a2198e825f0884d4ee9e96b6efdb69cee"><div class="ttname"><a href="namespacem__mpi__proxy.html#a2198e825f0884d4ee9e96b6efdb69cee">m_mpi_proxy::recvcounts</a></div><div class="ttdeci">integer, dimension(:), allocatable recvcounts</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00066">m_mpi_proxy.f90:66</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad9c6ef3b20d42a8c3dababd60c20cca3"><div class="ttname"><a href="namespacem__global__parameters.html#ad9c6ef3b20d42a8c3dababd60c20cca3">m_global_parameters::heat_ratio_wrt</a></div><div class="ttdeci">logical heat_ratio_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00214">m_global_parameters.f90:214</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a8e48d59a04981a6594f25ad7a7562492"><div class="ttname"><a href="namespacem__mpi__proxy.html#a8e48d59a04981a6594f25ad7a7562492">m_mpi_proxy::s_mpi_sendrecv_grid_vars_buffer_regions</a></div><div class="ttdeci">subroutine s_mpi_sendrecv_grid_vars_buffer_regions(pbc_loc, sweep_coord)</div><div class="ttdoc">Communicates the buffer regions associated with the grid variables with processors in charge of the n...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00892">m_mpi_proxy.f90:892</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a69660c5fe9302a8c0496b622fa3b5286"><div class="ttname"><a href="namespacem__mpi__proxy.html#a69660c5fe9302a8c0496b622fa3b5286">m_mpi_proxy::s_mpi_bcast_user_inputs</a></div><div class="ttdeci">subroutine s_mpi_bcast_user_inputs()</div><div class="ttdoc">Since only processor with rank 0 is in charge of reading and checking the consistency of the user pro...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00273">m_mpi_proxy.f90:273</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af2ed21959a90158c2459574230cdfcff"><div class="ttname"><a href="namespacem__global__parameters.html#af2ed21959a90158c2459574230cdfcff">m_global_parameters::web</a></div><div class="ttdeci">real(kind(0d0)) web</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00258">m_global_parameters.f90:258</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a015ee2c0892e9cfcb858da8f27b646d5"><div class="ttname"><a href="namespacem__mpi__proxy.html#a015ee2c0892e9cfcb858da8f27b646d5">m_mpi_proxy::s_initialize_mpi_proxy_module</a></div><div class="ttdeci">subroutine s_initialize_mpi_proxy_module()</div><div class="ttdoc">Computation of parameters, allocation procedures, and/or any other tasks needed to properly setup the...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00175">m_mpi_proxy.f90:175</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad4e160df8d0de7ea1801a1ca29f8e9b0"><div class="ttname"><a href="namespacem__global__parameters.html#ad4e160df8d0de7ea1801a1ca29f8e9b0">m_global_parameters::m_glb</a></div><div class="ttdeci">integer m_glb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00081">m_global_parameters.f90:81</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a56a071ae0b79b39a826646ace37972eb"><div class="ttname"><a href="namespacem__global__parameters.html#a56a071ae0b79b39a826646ace37972eb">m_global_parameters::c_wrt</a></div><div class="ttdeci">logical c_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00219">m_global_parameters.f90:219</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_acbb163a79ff0011a4327c3fb65a04c14"><div class="ttname"><a href="namespacem__global__parameters.html#acbb163a79ff0011a4327c3fb65a04c14">m_global_parameters::flux_lim</a></div><div class="ttdeci">integer flux_lim</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00207">m_global_parameters.f90:207</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab8488205257dab4e94258eee55d0d1aa"><div class="ttname"><a href="namespacem__global__parameters.html#ab8488205257dab4e94258eee55d0d1aa">m_global_parameters::weno_order</a></div><div class="ttdeci">integer weno_order</div><div class="ttdoc">Order of accuracy for the WENO reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00125">m_global_parameters.f90:125</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a41c2be7ba7b793490633ce040f949274"><div class="ttname"><a href="namespacem__global__parameters.html#a41c2be7ba7b793490633ce040f949274">m_global_parameters::fourier_decomp</a></div><div class="ttdeci">logical fourier_decomp</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00227">m_global_parameters.f90:227</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a610d39b1d30ffa66fead89c936c83226"><div class="ttname"><a href="namespacem__global__parameters.html#a610d39b1d30ffa66fead89c936c83226">m_global_parameters::gamma_wrt</a></div><div class="ttdeci">logical gamma_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00213">m_global_parameters.f90:213</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00261">m_global_parameters.f90:261</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a04ac565bad2b22dc045a5eeb4f516e2e"><div class="ttname"><a href="namespacem__mpi__proxy.html#a04ac565bad2b22dc045a5eeb4f516e2e">m_mpi_proxy::s_mpi_abort</a></div><div class="ttdeci">subroutine s_mpi_abort()</div><div class="ttdoc">The subroutine terminates the MPI execution environment. </div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00113">m_mpi_proxy.f90:113</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_adaa028bb99f844487de8d6e4507e7734"><div class="ttname"><a href="namespacem__mpi__proxy.html#adaa028bb99f844487de8d6e4507e7734">m_mpi_proxy::s_mpi_reduce_maxloc</a></div><div class="ttdeci">subroutine s_mpi_reduce_maxloc(var_loc)</div><div class="ttdoc">The following subroutine takes the first element of the 2-element inputted variable and determines it...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01631">m_mpi_proxy.f90:1631</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a2ff35ede51e90c483969e44c31303415"><div class="ttname"><a href="namespacem__mpi__proxy.html#a2ff35ede51e90c483969e44c31303415">m_mpi_proxy::s_initialize_mpi_data</a></div><div class="ttdeci">subroutine s_initialize_mpi_data(q_cons_vf)</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00125">m_mpi_proxy.f90:125</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac127ac2a9036e1cdb7e6c41159cacdfb"><div class="ttname"><a href="namespacem__global__parameters.html#ac127ac2a9036e1cdb7e6c41159cacdfb">m_global_parameters::parallel_io</a></div><div class="ttdeci">logical parallel_io</div><div class="ttdoc">Format of the data files. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abeca739b09557ccbf37b2ec35b0e73cc"><div class="ttname"><a href="namespacem__global__parameters.html#abeca739b09557ccbf37b2ec35b0e73cc">m_global_parameters::dy</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dy</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00099">m_global_parameters.f90:99</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a76e251296a28212df87bf9f653ff9a3b"><div class="ttname"><a href="namespacem__global__parameters.html#a76e251296a28212df87bf9f653ff9a3b">m_global_parameters::num_dims</a></div><div class="ttdeci">integer num_dims</div><div class="ttdoc">Number of spatial dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00084">m_global_parameters.f90:84</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a085b3000bac43a3ff2963646c8ecd96a"><div class="ttname"><a href="namespacem__global__parameters.html#a085b3000bac43a3ff2963646c8ecd96a">m_global_parameters::fourier_modes</a></div><div class="ttdeci">type(bounds_info) fourier_modes</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00228">m_global_parameters.f90:228</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae4ab7caa7dee5e616b217437f7f2b87f"><div class="ttname"><a href="namespacem__global__parameters.html#ae4ab7caa7dee5e616b217437f7f2b87f">m_global_parameters::vel_wrt</a></div><div class="ttdeci">logical, dimension(3) vel_wrt</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00206">m_global_parameters.f90:206</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_ac15a15ba12e6110bb015af0ece5bba47"><div class="ttname"><a href="namespacem__mpi__proxy.html#ac15a15ba12e6110bb015af0ece5bba47">m_mpi_proxy::s_mpi_defragment_1d_grid_variable</a></div><div class="ttdeci">subroutine s_mpi_defragment_1d_grid_variable()</div><div class="ttdoc">This subroutine collects the sub-domain cell-boundary or cell-center locations data from all of the p...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01781">m_mpi_proxy.f90:1781</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00122">m_global_parameters.f90:122</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5f209d71bd815d863485787639d9684a"><div class="ttname"><a href="namespacem__global__parameters.html#a5f209d71bd815d863485787639d9684a">m_global_parameters::offset_x</a></div><div class="ttdeci">type(bounds_info) offset_x</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00193">m_global_parameters.f90:193</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_a4d7ec0d1976967504babdf44ec83c1b1"><div class="ttname"><a href="namespacem__mpi__proxy.html#a4d7ec0d1976967504babdf44ec83c1b1">m_mpi_proxy::s_mpi_sendrecv_cons_vars_buffer_regions</a></div><div class="ttdeci">subroutine s_mpi_sendrecv_cons_vars_buffer_regions(q_cons_vf, pbc_loc, sweep_coord)</div><div class="ttdoc">Communicates buffer regions associated with conservative variables with processors in charge of the n...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l01094">m_mpi_proxy.f90:1094</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6769808569174ff0eef096e958889837"><div class="ttname"><a href="namespacem__global__parameters.html#a6769808569174ff0eef096e958889837">m_global_parameters::bc_z</a></div><div class="ttdeci">type(bounds_info) bc_z</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a383c6ff025d4ea09ddd4e2356042d86b"><div class="ttname"><a href="namespacem__global__parameters.html#a383c6ff025d4ea09ddd4e2356042d86b">m_global_parameters::proc_rank</a></div><div class="ttdeci">integer proc_rank</div><div class="ttdoc">Rank of the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00064">m_global_parameters.f90:64</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html"><div class="ttname"><a href="namespacem__mpi__proxy.html">m_mpi_proxy</a></div><div class="ttdoc">This module serves as a proxy to the parameters and subroutines available in the MPI implementation&amp;#39;s...</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00039">m_mpi_proxy.f90:39</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_afabaedf16b26e327635e956d13b45086"><div class="ttname"><a href="namespacem__global__parameters.html#afabaedf16b26e327635e956d13b45086">m_global_parameters::m_root</a></div><div class="ttdeci">integer m_root</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a3981c7e6886ba3cde245ce4dcc6ca664"><div class="ttname"><a href="namespacem__global__parameters.html#a3981c7e6886ba3cde245ce4dcc6ca664">m_global_parameters::mixture_err</a></div><div class="ttdeci">logical mixture_err</div><div class="ttdoc">Mixture error limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__mpi__proxy_html_af08f3246d9efac15d6391dc4205d4611"><div class="ttname"><a href="namespacem__mpi__proxy.html#af08f3246d9efac15d6391dc4205d4611">m_mpi_proxy::q_cons_buffer_in</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable q_cons_buffer_in</div><div class="ttdef"><b>Definition:</b> <a href="m__mpi__proxy_8f90_source.html#l00058">m_mpi_proxy.f90:58</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00260">m_global_parameters.f90:260</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac96de935d1ac1a172537dfcba610b976"><div class="ttname"><a href="namespacem__global__parameters.html#ac96de935d1ac1a172537dfcba610b976">m_global_parameters::dx</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable dx</div><div class="ttdoc">Cell-width distributions in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00099">m_global_parameters.f90:99</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f39c77f8ac4f88bc51904794a36f3985.html">post_process_code</a></li><li class="navelem"><a class="el" href="m__mpi__proxy_8f90.html">m_mpi_proxy.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
