<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFC:Pre_process: m_initial_condition.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFC:Pre_process
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m__initial__condition_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">m_initial_condition.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="m__initial__condition_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!       __  _______________</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!!      /  |/  / ____/ ____/</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!!     / /|_/ / /_  / /     </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!!    / /  / / __/ / /___   </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!!   /_/  /_/_/    \____/   </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!!                       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!!  This file is part of MFC.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!!  MFC is the legal property of its developers, whose names </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!!  are listed in the copyright file included with this source </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!!  distribution.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!!  MFC is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!!  it under the terms of the GNU General Public License as published </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!!  by the Free Software Foundation, either version 3 of the license </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!!  or any later version.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!!  MFC is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!!  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!!  GNU General Public License for more details.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!!  </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!!  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!!  along with MFC (LICENSE).  </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!!  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html">   46</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacem__initial__condition.html">m_initial_condition</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">! Dependencies =============================================================</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__derived__types.html">m_derived_types</a>         <span class="comment">! Definitions of the derived types</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__global__parameters.html">m_global_parameters</a>     <span class="comment">! Global parameters for the code</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacem__variables__conversion.html">m_variables_conversion</a>  <span class="comment">! Subroutines to change the state variables from</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                <span class="comment">! one form to another</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">! ==========================================================================</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    abstract <span class="keyword">INTERFACE</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html">   73</a></span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html">s_assign_patch_xxxxx_primitive_variables</a>( patch_id,j,k,l)</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html#ac27723d90d114627926a6d04b00b42f3">   74</a></span>&#160;           </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html">s_assign_patch_xxxxx_primitive_variables</a></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">    END INTERFACE</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">! NOTE: The abstract interface allows for the declaration of a pointer to</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">! a procedure such that the choice of the model equations does not have to</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">! be queried every time the patch primitive variables are to be assigned in</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">! a cell in the computational domain.</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">   86</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">   88</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>), <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: <a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">   90</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1scalar__field.html">scalar_field</a>) :: <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">   92</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>, <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>, <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> </div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">   93</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>, <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a>, <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">   94</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">   95</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>, <a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">   96</a></span>&#160;    <span class="keywordtype">INTEGER</span>         :: <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">   97</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">  103</a></span>&#160;    <span class="keywordtype">TYPE</span>(<a class="code" href="structm__derived__types_1_1bounds__info.html">bounds_info</a>) :: <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>, <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>, <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">  110</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>, <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>, <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>, <a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">  116</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">  123</a></span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:,:,:)</span> :: <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">  128</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>, <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a></div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">  129</a></span>&#160;    <span class="keywordtype">REAL(KIND(0d0))</span> :: <a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">  134</a></span>&#160;    <span class="keywordtype">PROCEDURE</span>(<a class="code" href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html">s_assign_patch_xxxxx_primitive_variables</a>), &amp;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">POINTER</span> :: <a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a> =&gt; null() </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ac414f08eb31dad32ed313767d214df72">s_assign_patch_mixture_primitive_variables</a>( patch_id,j,k,l)</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ac414f08eb31dad32ed313767d214df72">  159</a></span>&#160;            </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                               :: rho</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(E_idx-mom_idx%beg)</span> :: vel</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                               :: pres</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>                               :: gamma</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">! Assigning the mixture primitive variables of a uniform state patch</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%geometry /= 6) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                </div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="comment">! Transferring the identity of the smoothing patch</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%smooth_patch_id</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="comment">! Density</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                              <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>    *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%rho &amp;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%rho</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                </div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="comment">! Velocity</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>-<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i+1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        1d0 / <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(j,k,l) * &amp;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        (     <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>    *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%rho    &amp;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                     *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%vel(i) &amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%rho    &amp;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                     *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%vel(i) )</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                </div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="comment">! Specific heat ratio function</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">gamma_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                              <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>    *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%gamma &amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%gamma</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="comment">! Pressure</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        1d0 / <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">gamma_idx</a>)%sf(j,k,l) * &amp;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        (     <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>    *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%gamma &amp;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                     *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%pres  &amp;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%gamma &amp;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                     *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%pres  )</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="comment">! Liquid stiffness function</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">pi_inf_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                              <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>    *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(    patch_id   )%pi_inf &amp;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%pi_inf</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">! Assigning mixture primitive variables of isentropic vortex patch</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="comment">! Transferring the centroid of the isentropic vortex patch, the</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="comment">! amplitude of its disturbance and also its domain of influence</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%x_centroid</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%y_centroid</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>    = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%epsilon</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>       = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%beta</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="comment">! Reference density, velocity, pressure and specific heat ratio</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="comment">! function of the isentropic vortex patch</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                rho    = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%rho</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                vel    = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%vel</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                pres   = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%pres</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                gamma  = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%gamma</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">! Density</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(j,k,0) = &amp;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                             rho*( 1d0 - (rho/pres)*(<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(2d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                   (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(8d0*<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*(gamma+1d0)*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                      exp( 2d0*<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*( 1d0 - (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0    &amp;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                          - (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0) ) &amp;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                 )**gamma</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="comment">! Velocity</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(2)%sf(j,k,0) = &amp;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                      vel(1) - (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)*(<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(2d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                          exp( <a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*( 1d0 - (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0    &amp;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                          - (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0) )</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(3)%sf(j,k,0) = &amp;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                      vel(2) + (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)*(<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(2d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                          exp( <a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*( 1d0 - (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0    &amp;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                          - (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0) )</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                </div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="comment">! Pressure</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(4)%sf(j,k,0) = &amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                            pres*( 1d0 - (rho/pres)*(<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(2d0*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                   (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>/(8d0*<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*(gamma+1d0)*<a class="code" href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">pi</a>)) * &amp;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                      exp( 2d0*<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>*( 1d0 - (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(j)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0    &amp;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                          - (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(k)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0) ) &amp;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                 )**(gamma+1d0)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">! Specific heat ratio function</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(5)%sf(j,k,0) = gamma</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">! Liquid stiffness function</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(6)%sf(j,k,0) = 0d0</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">! Updating the patch identities bookkeeping variable</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">IF</span>(1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> &lt; 1<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-16) <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(j,k,l) = patch_id</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ac414f08eb31dad32ed313767d214df72">s_assign_patch_mixture_primitive_variables</a> <span class="comment">! ------------</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#abd7cee461afabc01b81373e4be5a20c7">s_assign_patch_species_primitive_variables_bubbles</a>( patch_id,j,k,l)</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#abd7cee461afabc01b81373e4be5a20c7">  277</a></span>&#160;            </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">! Density, the specific heat ratio function and the liquid stiffness</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">! function, respectively, obtained from the combination of primitive</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="comment">! variables of the current and smoothing patches</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma        </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: lit_gamma</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_rho     </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_gamma</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_pi_inf </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(sys_size)</span> :: orig_prim_vf</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">! Transferring the identity of the smoothing patch</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%smooth_patch_id</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment">! Transferring original primitive variables</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                orig_prim_vf(i) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end - 1</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf + <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end-1</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf * (1.d0 - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            / <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">! Computing Mixture Variables from Original Primitive Variables</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(    &amp;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,   &amp;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                        orig_rho,           &amp;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                        orig_gamma,         &amp;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                        orig_pi_inf )</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">! Computing Mixture Variables of Current Patch =====================</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="comment">! Volume fraction(s)</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end - 1</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf + <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end-1</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf * (1.d0 - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                            / <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="comment">! Partial densities</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha_rho(i)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">! Bubbles variables</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%r0</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a334b440356a4353d073c43e68c2372da">v0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%v0</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(    &amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,           &amp;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%rho,   &amp;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%gamma, &amp;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%pi_inf )</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="comment">! Computing Mixture Variables of Smoothing Patch ===================</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="comment">! Partial densities</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%alpha_rho(i)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;           </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="comment">! Volume fraction(s)</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end - 1</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf + <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end-1</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf * (1.d0 - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                            / <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="comment">! Bubbles variables</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%r0</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a334b440356a4353d073c43e68c2372da">v0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%v0</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;           </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(       &amp;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,                  &amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%rho,   &amp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%gamma, &amp;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%pi_inf )</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="comment">! Pressure</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%pres  &amp;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                     + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>) * orig_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>))    </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">! Volume fractions \alpha</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>) &amp;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)   *orig_prim_vf(i)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end - 1</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf + <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end-1</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf * (1.d0 - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            / <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="comment">! Partial densities \alpha \rho</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> .NE. 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="comment">!mixture density is an input</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha_rho(i) &amp;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>) * orig_prim_vf(i)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <span class="comment">!get mixture density from pressure via Tait EOS</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                pi_inf = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                gamma = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                lit_gamma = (1.d0+gamma)/gamma</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="comment">! \rho = (( p_l + pi_inf)/( p_ref + pi_inf))**(1/little_gam) * rhoref(1-alf)</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) + pi_inf)/(<a class="code" href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">pref</a> + pi_inf))**(1/lit_gamma)) * &amp;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    <a class="code" href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">rhoref</a>*(1-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf(j,k,l))</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>( <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a> , j,k,l, &amp;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                          rho,gamma,pi_inf  )</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="comment">! Velocity</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>-<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%vel(i) &amp; </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                         + (1d0-<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*orig_prim_vf(i+<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end))</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">! Smoothed bubble variables</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%r0 &amp; </div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        + (1d0-<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*orig_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i)))</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j,k,l) = &amp;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#a334b440356a4353d073c43e68c2372da">v0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%v0 &amp; </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        + (1d0-<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*orig_prim_vf(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i)))</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%rs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">r0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%r0</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%vs(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a334b440356a4353d073c43e68c2372da">v0</a>(i)*<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%v0</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">mpp_lim</a> .AND. <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="comment">!adjust volume fractions, according to modeled gas void fraction</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = 0d0</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end - 1</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf = <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf + <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end-1</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf * (1.d0 - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">alf_idx</a>)%sf) &amp;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            / <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> .AND. (<a class="code" href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">polytropic</a> .NEQV. .true.) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">DO</span> i = 1,<a class="code" href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">nb</a></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ps(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a1097b95561b65a9035e5f9218de577f9">pb0</a>(i) </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">bub_idx</a>%ms(i))%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#a6a06981be6cdab78452a106009022aa4">mass_v0</a>(i)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="comment">! Updating the patch identities bookkeeping variable</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">IF</span>(1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> &lt; 1<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-16) <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(j,k,l) = patch_id            </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#abd7cee461afabc01b81373e4be5a20c7">s_assign_patch_species_primitive_variables_bubbles</a> <span class="comment">! ------------ </span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;       </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a0024bfbe15f4f49cb2a5a2c574d89e19">s_assign_patch_species_primitive_variables</a>( patch_id,j,k,l)</div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a0024bfbe15f4f49cb2a5a2c574d89e19">  528</a></span>&#160;            </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: j,k,l</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rho</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: gamma</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_rho</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_gamma</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: orig_pi_inf</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">DIMENSION(sys_size)</span> :: orig_prim_vf</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">! Vector to hold original values of cell for smoothing purposes</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            </div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">! Transferring the identity of the smoothing patch</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%smooth_patch_id</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">! Transferring original primitive variables</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                orig_prim_vf(i) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="comment">! Computing Mixture Variables from Original Primitive Variables</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(    &amp;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,   &amp;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                        orig_rho,           &amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                        orig_gamma,         &amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                        orig_pi_inf )</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="comment">! Computing Mixture Variables of Current Patch =====================</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            </div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="comment">! Partial densities</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha_rho(i)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">! Volume fraction(s)</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(    &amp;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,           &amp;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%rho,   &amp;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%gamma, &amp;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%pi_inf )</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            </div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="comment">! Computing Mixture Variables of Smoothing Patch ===================</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="comment">! Partial densities</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%alpha_rho(i)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="comment">! Volume fraction(s)</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>(       &amp;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, j,k,l,                  &amp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%rho,   &amp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%gamma, &amp;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                            <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(<a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>)%pi_inf )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">! Partial densities</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha_rho(i) &amp;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)   *orig_prim_vf(i)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> *<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alpha(i-<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>) &amp;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)   *orig_prim_vf(i)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="comment">! Density and the specific heat ratio and liquid stiffness functions</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">s_convert_species_to_mixture_variables</a>( <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a> , j,k,l, &amp;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                                          rho,gamma,pi_inf  )</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="comment">! Velocity</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>-<a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i+<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%vel(i) &amp; </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                         + (1d0-<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>)*orig_prim_vf(i+<a class="code" href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">cont_idx</a>%end))</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="comment">! Pressure</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l) = &amp;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    (<a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> * <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%pres  &amp;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                     + (1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a>) * orig_prim_vf(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>))            </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">! Set partial pressures to mixture pressure</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordflow">DO</span> i = <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">internalenergies_idx</a>%end</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(j,k,l) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>)%sf(j,k,l)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordflow">            ENDIF</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">! Updating the patch identities bookkeeping variable</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">IF</span>(1d0 - <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> &lt; 1<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-16) <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(j,k,l) = patch_id</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;           </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a0024bfbe15f4f49cb2a5a2c574d89e19">s_assign_patch_species_primitive_variables</a> <span class="comment">! ------------</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a07a665ff41297455ac2da7b54243bac5">s_initialize_initial_condition_module</a>() <span class="comment">! -------------------</span></div><div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a07a665ff41297455ac2da7b54243bac5">  651</a></span>&#160;            </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="comment">! Allocating the primitive and conservative variables</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>(1:<a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a>))</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>(i)%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keyword">ALLOCATE</span>( <a class="code" href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">alf_sum</a>%sf(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>) )</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="comment">! Allocating the patch identities bookkeeping variable</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(0:<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>,0:<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>,0:<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a>))</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            </div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="comment">! Setting default values for conservative and primitive variables so</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="comment">! that in the case that the initial condition is wrongly laid out on</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="comment">! the grid the simulation component will catch the problem on start-</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="comment">! up. The conservative variables do not need to be similarly treated</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="comment">! since they are computed directly from the primitive variables.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">sys_size</a></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>(i)%sf = <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf = <a class="code" href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">dflt_real</a></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">! Setting default values for patch identities bookkeeping variable.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="comment">! This is necessary to avoid any confusion in the assessment of the</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="comment">! extent of application that the overwrite permissions give a patch</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="comment">! when it is being applied in the domain.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a> = 0</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="comment">! Depending on multicomponent flow model, the appropriate procedure</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="comment">! for assignment of the patch mixture or species primitive variables</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="comment">! to a cell in the domain is targeted by the procedure pointer</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;           </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">model_eqns</a> == 1) <span class="keywordflow">THEN</span>        <span class="comment">! Gamma/pi_inf model</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a> =&gt; &amp;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ac414f08eb31dad32ed313767d214df72">s_assign_patch_mixture_primitive_variables</a></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">bubbles</a> ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a> =&gt; &amp;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#abd7cee461afabc01b81373e4be5a20c7">s_assign_patch_species_primitive_variables_bubbles</a></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">ELSE</span> <span class="comment">! Volume fraction model</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a> =&gt; &amp;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#a0024bfbe15f4f49cb2a5a2c574d89e19">s_assign_patch_species_primitive_variables</a></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a07a665ff41297455ac2da7b54243bac5">s_initialize_initial_condition_module</a> <span class="comment">! -----------------</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#aa74a70029e3ec0fd3225b369e7c5443e">s_generate_initial_condition</a>() <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#aa74a70029e3ec0fd3225b369e7c5443e">  715</a></span>&#160;            </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            </div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="comment">! Converting the conservative variables to the primitive ones given</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="comment">! preexisting initial condition data files were read in on start-up</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ae83688439601a9ff9bad58f09357a721">old_ic</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">s_convert_conservative_to_primitive_variables</a>( <a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>, &amp;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                                                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>  )</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            </div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment">!  3D Patch Geometries =============================================</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">num_patches</a></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="comment">! Spherical patch</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 8) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a9037159f591341d05fa5fb23fe82bc2c">s_sphere</a>(i)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    <span class="comment">! Cuboidal patch</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 9) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a2297a9b98d2478b3594083197bd9b8b5">s_cuboid</a>(i)</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    <span class="comment">! Cylindrical patch</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 10) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#af834c631376de6906fb6b002df70ce49">s_cylinder</a>(i)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    <span class="comment">! Swept plane patch</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 11) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a51f30d0a86584bdc757c22ebf7993e88">s_sweep_plane</a>(i)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="comment">! Ellipsoidal patch</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 12) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a524f37de8423b7943c22c5d105eda922">s_ellipsoid</a>(i)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    <span class="comment">! Analytical function patch for testing purposes</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 13) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#abb87c531b4d42302dd22863b95a7cdb2">s_3d_analytical</a>(i)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    <span class="comment">! Spherical harmonic patch</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 14) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#af17f90ba4a3878feb6e38bc8d66cb950">s_spherical_harmonic</a>(i)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    <span class="comment">! 3D Modified circular patch</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 19) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#aea2bf07e8890b1a108f2f891609174c9">s_3dvarcircle</a>(i)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">                    ENDIF</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">! 2D Patch Geometries ==============================================</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a> &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">num_patches</a></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <span class="comment">! Circular patch</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="keywordflow">IF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a75d13cb7c7c4f88e8b532cf7e7dda498">s_circle</a>(i)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                        </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <span class="comment">! Rectangular patch</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a9c54a1e384e94493914688f9a2a2cf14">s_rectangle</a>(i)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    <span class="comment">! Swept line patch</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 4) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#ab056c04c30f55423904517abe61ebd99">s_sweep_line</a>(i)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    <span class="comment">! Elliptical patch</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 5) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a5e999ad19f23f5f2b059b80e49c0a086">s_ellipse</a>(i)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                        </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    <span class="comment">! Isentropic vortex patch</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 6) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#ab329077796ad7579df0a96543263150d">s_isentropic_vortex</a>(i)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    <span class="comment">! Analytical function patch for testing purposes</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 7) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a50f5727753c025d26925640a19259102">s_2d_analytical</a>(i)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="comment">! Spiral patch</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 17) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#ac4540baa01372eb3df51b268769fa6fc">s_spiral</a>(i)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    <span class="comment">! Modified circular patch</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 18) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3e1c1480513e75b444ce7a77ed0fe598">s_varcircle</a>(i)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="comment">! 1D Patch Geometries ==============================================</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                </div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                <span class="keywordflow">DO</span> i = 1, <a class="code" href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">num_patches</a></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;               </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    <span class="comment">! Line segment patch</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3be32c8ee8a7dffae734d063200471e8">s_line_segment</a>(i)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;             </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    <span class="comment">! 1d analytical</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 15) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3b4fe978231e74b699695a35fb544236">s_1d_analytical</a>(i)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <span class="comment">! 1d bubble screen with sinusoidal pressure pulse</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(i)%geometry == 16) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a7685befab45f10089fc46907fa4cc049">s_1d_bubble_pulse</a>(i)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="comment">! ==================================================================</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#add2d4033abdced8536200ef739ab379b">perturb_flow</a>) <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#ab66e3b04024a8ae7327857b1b265bc27">s_perturb_surrounding_flow</a>()</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#a98ddabe1c45996064589ca24ce5d8fe3">perturb_sph</a>) <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#afef3f507e182798fcfd7aecc52878fc9">s_perturb_sphere</a>()</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="comment">! Converting the primitive variables to the conservative ones</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">s_convert_primitive_to_conservative_variables</a>( <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>, &amp;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                                <a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>  )</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#aa74a70029e3ec0fd3225b369e7c5443e">s_generate_initial_condition</a> <span class="comment">! --------------------------</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(cyl_y,cyl_z)</div><div class="line"><a name="l00852"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">  852</a></span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: cyl_y, cyl_z</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = cyl_y*sin(cyl_z)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = cyl_y*cos(cyl_z)</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a88d2e8debdc097d4d811fb67d6fbc880">s_convert_cylindrical_to_spherical_coord</a>(cyl_x,cyl_y)</div><div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a88d2e8debdc097d4d811fb67d6fbc880">  861</a></span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: cyl_x, cyl_y</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a> = atan(cyl_y/cyl_x)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a88d2e8debdc097d4d811fb67d6fbc880">s_convert_cylindrical_to_spherical_coord</a> <span class="comment">! --------------</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#afef3f507e182798fcfd7aecc52878fc9">s_perturb_sphere</a>() <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l00870"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#afef3f507e182798fcfd7aecc52878fc9">  870</a></span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: perturb_alpha</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: alpha_unadv</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rand_real</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keyword">CALL </span>random_seed()</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        <span class="keyword">CALL </span>random_number(rand_real)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                        <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a90f36c0b74894ddd901534dd4efccfc8">perturb_sph_fluid</a> == <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                            perturb_alpha = 1d0</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                perturb_alpha = perturb_alpha - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                            perturb_alpha = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a90f36c0b74894ddd901534dd4efccfc8">perturb_sph_fluid</a>)%sf(i,j,k)</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                        <span class="comment">! Perturb partial density fields to match perturbed volume fraction fields</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">!                        IF ((perturb_alpha &gt;= 25d-2) .AND. (perturb_alpha &lt;= 75d-2)) THEN</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        <span class="keywordflow">IF</span> ((perturb_alpha /= 0d0) .AND. (perturb_alpha /= 1d0)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                <span class="comment">! Find new unadvected volume fraction</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                alpha_unadv = 1d0</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                    alpha_unadv = alpha_unadv - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                <span class="comment">! Derive new partial densities</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>-1</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a> + l)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">fluid_rho</a>(l)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)%sf(i,j,k) = alpha_unadv*<a class="code" href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">fluid_rho</a>(<a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                            <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                <span class="comment">! Derive new partial densities</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                <span class="keywordflow">DO</span> l = 1, <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a> + l)%sf(i,j,k)*<a class="code" href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">fluid_rho</a>(l)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">                                END DO</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                            </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#afef3f507e182798fcfd7aecc52878fc9">s_perturb_sphere</a> <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab66e3b04024a8ae7327857b1b265bc27">s_perturb_surrounding_flow</a>() <span class="comment">! ------------------------------</span></div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ab66e3b04024a8ae7327857b1b265bc27">  922</a></span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k,l</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: perturb_alpha</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: rand_real</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keyword">CALL </span>random_seed()</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="comment">! Perturb partial density or velocity of surrounding flow by some random small amount of noise</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">DO</span> k = 0, <a class="code" href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">p</a></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                        <span class="keywordflow">IF</span> ((<a class="code" href="namespacem__global__parameters.html#a1c242fb70db5a2c91c0997b37bcffd6a">perturb_flow_fluid</a> == <a class="code" href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">num_fluids</a>) .AND. (<a class="code" href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">adv_alphan</a> .NEQV. .true.)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                            perturb_alpha = 1d0</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%beg, <a class="code" href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">adv_idx</a>%end</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                perturb_alpha = perturb_alpha - <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                            perturb_alpha = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(<a class="code" href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">e_idx</a>+<a class="code" href="namespacem__global__parameters.html#a1c242fb70db5a2c91c0997b37bcffd6a">perturb_flow_fluid</a>)%sf(i,j,k)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        <span class="keywordflow">IF</span> (perturb_alpha == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                            <span class="comment">! Perturb partial density</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">!                            CALL RANDOM_NUMBER(rand_real)</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">!                            rand_real = rand_real / 1d2 / 1d3</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">!                            q_prim_vf(perturb_flow_fluid)%sf(i,j,k) = q_prim_vf(perturb_flow_fluid)%sf(i,j,k) + rand_real</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                            <span class="comment">! Perturb velocity</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                            <span class="keywordflow">DO</span> l = <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%beg+1, <a class="code" href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">mom_idx</a>%end</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                <span class="keyword">CALL </span>random_number(rand_real)</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                rand_real = rand_real / 1d1 / 145d1</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(l)%sf(i,j,k) + rand_real</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keywordflow">                            END DO</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keywordflow">                    END DO</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab66e3b04024a8ae7327857b1b265bc27">s_perturb_surrounding_flow</a> <span class="comment">! ----------------------------</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3be32c8ee8a7dffae734d063200471e8">s_line_segment</a>(patch_id) <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l00968"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a3be32c8ee8a7dffae734d063200471e8">  968</a></span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf, gamma, lit_gamma</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            pi_inf = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%pi_inf</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            gamma = <a class="code" href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">fluid_pp</a>(1)%gamma</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            lit_gamma = (1d0+gamma)/gamma</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            </div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="comment">! Transferring the line segment&#39;s centroid and length information</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%x_centroid</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>   = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%length_x</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            </div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">! Computing the beginning and end x-coordinates of the line segment</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">! based on its centroid and length</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="comment">! Since the line segment patch does not allow for its boundaries to</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="comment">! be smoothed out, the pseudo volume fraction is set to 1 to ensure</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            </div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="comment">! Checking whether the line segment covers a particular cell in the</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the permission</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <span class="keywordflow">IF</span>(             <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= <a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(i) .AND.              &amp;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= <a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(i) .AND.              &amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                     <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,0,0)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,0,0)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                   </div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    <span class="comment">!IF ( (q_prim_vf(1)%sf(i,0,0) &lt; 1.e-12) .AND. (model_eqns .NE. 4)) THEN</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="comment">!    !zero density, reassign according to Tait EOS</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    <span class="comment">!    q_prim_vf(1)%sf(i,0,0) = &amp;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    <span class="comment">!        (((q_prim_vf(E_idx)%sf(i,0,0) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    <span class="comment">!        rhoref*(1d0-q_prim_vf(alf_idx)%sf(i,0,0))</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    <span class="comment">!END IF</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;           </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3be32c8ee8a7dffae734d063200471e8">s_line_segment</a> <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;       </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ac4540baa01372eb3df51b268769fa6fc">s_spiral</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ac4540baa01372eb3df51b268769fa6fc"> 1025</a></span>&#160;           </div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: th, thickness, nturns, mya</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: spiral_x_min, spiral_x_max, spiral_y_min, spiral_y_max</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="comment">! Transferring the circular patch&#39;s radius, centroid, smearing patch</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="comment">! identity and smearing coefficient information</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%x_centroid</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%y_centroid</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            mya             = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%radius</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            thickness       = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%length_x</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            nturns          = <a class="code" href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">patch_icpp</a>(patch_id)%length_y</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <a class="code" href="namespacem__global__parameters.html#adfaf902b37292b91750274e26989e8e6">logic_grid</a> = 0</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="keywordflow">DO</span> k = 0,int(<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>*91*nturns)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                th = k/<span class="keywordtype">REAL(int(m*91d0*nturns))</span> * nturns*2.d0*pi</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                spiral_x_min = minval( (/ <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,0.0d0,    mya)*cos(th), &amp;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                          <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,thickness,mya)*cos(th) /) )</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                spiral_y_min = minval( (/ <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,0.0d0,    mya)*sin(th), &amp;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                          <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,thickness,mya)*sin(th) /) )</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                spiral_x_max = maxval( (/ <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,0.0d0,    mya)*cos(th), &amp;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                          <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,thickness,mya)*cos(th) /) )</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                spiral_y_max = maxval( (/ <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,0.0d0,    mya)*sin(th), &amp;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                          <a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(th,thickness,mya)*sin(th) /) )</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                <span class="keywordflow">DO</span> j = 0,<a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a>; <span class="keywordflow">DO</span> i = 0,<a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    <span class="keywordflow">if</span>( (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(i) &gt; spiral_x_min) .AND. (<a class="code" href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">x_cc</a>(i) &lt; spiral_x_max) .AND. &amp;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(j) &gt; spiral_y_min) .AND. (<a class="code" href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">y_cc</a>(j) &lt; spiral_y_max)) <span class="keywordflow">THEN</span>  </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        <a class="code" href="namespacem__global__parameters.html#adfaf902b37292b91750274e26989e8e6">logic_grid</a>(i,j,0) = 1</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keyword">                END </span>DO; END do</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">DO</span> j = 0, <a class="code" href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">n</a></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="keywordflow">DO</span> i = 0, <a class="code" href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m</a></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                    <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__global__parameters.html#adfaf902b37292b91750274e26989e8e6">logic_grid</a>(i,j,0) == 1) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ac4540baa01372eb3df51b268769fa6fc">s_spiral</a> <span class="comment">! ---------------------------------------------- </span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keyword">        FUNCTION </span><a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a>(myth,offset,a)</div><div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e"> 1079</a></span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span>, <span class="keywordtype">INTENT(IN)</span> :: myth, offset,a</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: b</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: f_r</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="comment">!r(th) = a + b*th</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            b = 2.d0*a/(2.d0*pi) </div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            f_r = a + b*myth + offset</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keyword">        END FUNCTION </span><a class="code" href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">f_r</a></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        </div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a75d13cb7c7c4f88e8b532cf7e7dda498">s_circle</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01096"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a75d13cb7c7c4f88e8b532cf7e7dda498"> 1096</a></span>&#160;            </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;             </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="comment">! Transferring the circular patch&#39;s radius, centroid, smearing patch</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="comment">! identity and smearing coefficient information</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            </div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            </div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="comment">! case that smoothing of the circular patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">! Checking whether the circle covers a particular cell in the domain</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="comment">! that cell. If both queries check out, the primitive variables of</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="comment">! the current patch are assigned to this cell.</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        </div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dy) *   &amp;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                            ( sqrt( (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                                  + (y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0 ) &amp;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                  - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a> ) ) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                        </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    </div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    <span class="keywordflow">IF</span>((       (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                     &amp;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                             + (y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0      &amp;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                                  .AND.                        &amp;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0))) &amp;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                                  .OR.                         &amp;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0) == <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>        ) &amp;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                                  <span class="keywordflow">THEN</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                        </div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    </div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            </div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            </div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a75d13cb7c7c4f88e8b532cf7e7dda498">s_circle</a> <span class="comment">! ----------------------------------------------</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3e1c1480513e75b444ce7a77ed0fe598">s_varcircle</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a3e1c1480513e75b444ce7a77ed0fe598"> 1155</a></span>&#160;            </div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            </div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            </div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;           </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: myr, thickness</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="comment">! Transferring the circular patch&#39;s radius, centroid, smearing patch</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">! identity and smearing coefficient information</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            thickness       = patch_icpp(patch_id)%epsilon</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            </div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="comment">! case that smoothing of the circular patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            </div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="comment">! Checking whether the circle covers a particular cell in the domain</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="comment">! that cell. If both queries check out, the primitive variables of</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="comment">! the current patch are assigned to this cell.</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    myr = dsqrt(  (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0 &amp;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                + (y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0                   )</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    <span class="keywordflow">IF</span>( myr &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>+thickness/2.d0 .AND. &amp;       </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                        myr &gt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>-thickness/2.d0 .AND. &amp;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        </div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,j,0) = patch_icpp(patch_id)%alpha(1) * &amp;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                            dexp( -0.5d0 * ((myr - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>)**2.d0) / (thickness/3.d0)**2.d0 )</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3e1c1480513e75b444ce7a77ed0fe598">s_varcircle</a> <span class="comment">! ----------------------------------------------</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;       </div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#aea2bf07e8890b1a108f2f891609174c9">s_3dvarcircle</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#aea2bf07e8890b1a108f2f891609174c9"> 1208</a></span>&#160;            </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            </div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;           </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: myr, thickness</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <span class="comment">! Transferring the circular patch&#39;s radius, centroid, smearing patch</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="comment">! identity and smearing coefficient information</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>      = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a>        = patch_icpp(patch_id)%length_z </div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            thickness       = patch_icpp(patch_id)%epsilon</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            </div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            </div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="comment">! case that smoothing of the circular patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            </div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="comment">! write for all z</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="comment">! Checking whether the circle covers a particular cell in the domain</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="comment">! that cell. If both queries check out, the primitive variables of</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            <span class="comment">! the current patch are assigned to this cell.</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keywordflow">DO</span> k =0,p</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    myr = dsqrt(  (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0 &amp;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                + (y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0                   )</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    <span class="keywordflow">IF</span>( myr &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>+thickness/2.d0 .AND. &amp;       </div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        myr &gt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>-thickness/2.d0 .AND. &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                        patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                        </div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                        </div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,j,k) = patch_icpp(patch_id)%alpha(1) * &amp;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                            dexp( -0.5d0 * ((myr - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>)**2.d0) / (thickness/3.d0)**2.d0 )</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    </div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            </div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            </div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#aea2bf07e8890b1a108f2f891609174c9">s_3dvarcircle</a> <span class="comment">! ----------------------------------------------</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        </div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a5e999ad19f23f5f2b059b80e49c0a086">s_ellipse</a>(patch_id) <span class="comment">! ---------------------------------------</span></div><div class="line"><a name="l01269"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a5e999ad19f23f5f2b059b80e49c0a086"> 1269</a></span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="comment">! Transferring the elliptical patch&#39;s radii, centroid, smearing</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="comment">! patch identity, and smearing coefficient information</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a> = patch_icpp(patch_id)%radii(1)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a> = patch_icpp(patch_id)%radii(2)</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value </span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in </span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <span class="comment">! the case that smoothing of the elliptical patch&#39;s boundary is</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <span class="comment">! enabled. </span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">! Checking whether the ellipse covers a particular cell in the </span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            <span class="comment">! domain and verifying whether the current patch has permission</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh(<a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dy) * &amp;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                            ( sqrt( ((x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>)**2d0 + &amp;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                    ((y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>)**2d0 ) &amp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                    - 1d0 )) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    <span class="keywordflow">IF</span> ((        ((x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>)**2d0 +          &amp;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                 ((y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>)**2d0 &lt;= 1d0     &amp;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                                .AND.                         &amp;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                        patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0))) &amp;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                                .OR.                          &amp;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                              <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0) == <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> )         &amp;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                                <span class="keywordflow">THEN</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a5e999ad19f23f5f2b059b80e49c0a086">s_ellipse</a> <span class="comment">! ---------------------------------------------</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a524f37de8423b7943c22c5d105eda922">s_ellipsoid</a>(patch_id) <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a524f37de8423b7943c22c5d105eda922"> 1326</a></span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="comment">! Transferring the ellipsoidal patch&#39;s radii, centroid, smearing</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="comment">! patch identity, and smearing coefficient information</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a> = patch_icpp(patch_id)%radii(1)</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a> = patch_icpp(patch_id)%radii(2)</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a> = patch_icpp(patch_id)%radii(3)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value </span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in </span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="comment">! the case that smoothing of the ellipsoidal patch&#39;s boundary is</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="comment">! enabled. </span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <span class="comment">! Checking whether the ellipsoid covers a particular cell in the </span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="comment">! domain and verifying whether the current patch has permission</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                     <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh(<a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dy,dz) *       &amp;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                             ( sqrt( ((x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>)**2d0 + &amp;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                     (( <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>)**2d0 + &amp;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                     (( <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>)**2d0 ) &amp;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                 - 1d0 )) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                     <span class="keywordflow">IF</span> ((      ((  x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>)**2d0 +          &amp;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                ((   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>)**2d0 +          &amp;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                ((   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>) / <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>)**2d0 &lt;= 1d0     &amp;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                                 .AND.                         &amp;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k))) &amp;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                                 .OR.                          &amp;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k) == <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> )               &amp;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                                 <span class="keywordflow">THEN</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a524f37de8423b7943c22c5d105eda922">s_ellipsoid</a> <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a9c54a1e384e94493914688f9a2a2cf14">s_rectangle</a>(patch_id) <span class="comment">! -------------------------------------</span></div><div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a9c54a1e384e94493914688f9a2a2cf14"> 1402</a></span>&#160;           </div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf, gamma, lit_gamma</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            pi_inf = fluid_pp(1)%pi_inf</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            gamma = fluid_pp(1)%gamma</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            lit_gamma = (1d0+gamma)/gamma</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            </div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            </div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="comment">! Transferring the rectangle&#39;s centroid and length information</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>   = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a>   = patch_icpp(patch_id)%length_y</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            </div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            </div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <span class="comment">! Computing the beginning and the end x- and y-coordinates of the</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <span class="comment">! rectangle based on its centroid and lengths</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            </div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            </div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <span class="comment">! Since the rectangular patch does not allow for its boundaries to</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="comment">! be smoothed out, the pseudo volume fraction is set to 1 to ensure</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            </div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            </div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="comment">! Checking whether the rectangle covers a particular cell in the</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the permission</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                    <span class="keywordflow">IF</span>(             <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i) .AND.            &amp;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i) .AND.            &amp;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg &lt;= y_cc(j) .AND.            &amp;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end &gt;= y_cc(j)                  &amp;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                                .AND.                          &amp;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                        patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0)) ) &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                                <span class="keywordflow">THEN</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                        </div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                        <span class="keywordflow">IF</span> ( (<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,j,0) &lt; 1.e-10) .AND. (model_eqns .NE. 4)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                            <span class="comment">!zero density, reassign according to Tait EOS</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,j,0) = &amp;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,0) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                rhoref*(1d0-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,j,0))</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="keywordflow">                        END IF</span>                        </div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            </div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            </div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a9c54a1e384e94493914688f9a2a2cf14">s_rectangle</a> <span class="comment">! -------------------------------------------</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        </div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        </div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab056c04c30f55423904517abe61ebd99">s_sweep_line</a>(patch_id) <span class="comment">! ------------------------------------</span></div><div class="line"><a name="l01476"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ab056c04c30f55423904517abe61ebd99"> 1476</a></span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            </div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            </div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            </div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            <span class="comment">! Transferring the centroid information of the line to be swept</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            </div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            </div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="comment">! Obtaining coefficients of the equation describing the sweep line</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a> = patch_icpp(patch_id)%normal(1)</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a> = patch_icpp(patch_id)%normal(2)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a> = -<a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            </div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            </div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="comment">! case that smoothing of the sweep line patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            </div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <span class="comment">! Checking whether the region swept by the line covers a particular</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="comment">! cell in the domain and verifying whether the current patch has the</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="comment">! permission to write to that cell. If both queries check out, the</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="comment">! primitive variables of the current patch are written to this cell.</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    </div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1 + 5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1*tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>/min(dx,dy)  &amp;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                               * (<a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*x_cc(i)+<a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*y_cc(j)+<a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>) &amp;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                               / sqrt(<a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>**2d0+<a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>**2d0)     )</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    </div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    <span class="keywordflow">IF</span>((           <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*x_cc(i) + <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*y_cc(j) + <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a> &gt;= 0d0            &amp;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                                 .AND.                         &amp;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0))) &amp;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                                 .OR.                          &amp;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0) == <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>        ) &amp;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                                                 <span class="keywordflow">THEN</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                        </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                    </div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            </div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            </div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab056c04c30f55423904517abe61ebd99">s_sweep_line</a> <span class="comment">! ------------------------------------------</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        </div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        </div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab329077796ad7579df0a96543263150d">s_isentropic_vortex</a>(patch_id) <span class="comment">! ----------------------------</span></div><div class="line"><a name="l01537"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#ab329077796ad7579df0a96543263150d"> 1537</a></span>&#160;           </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            </div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            </div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="comment">! Transferring isentropic vortex patch&#39;s centroid and radius info</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            </div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            </div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="comment">! Since the isentropic vortex patch does not allow for its boundary</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="comment">! to get smoothed, the pseudo volume fraction is set to 1 to ensure</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            </div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="comment">! Verifying whether the isentropic vortex includes a particular cell</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            <span class="comment">! that cell. If both queries work out the primitive variables of the</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <span class="comment">! the current patch are assigned to this cell.</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                    </div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                    <span class="keywordflow">IF</span>(        (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                     &amp;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                             + (y_cc(j) - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0      &amp;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                                  .AND.                        &amp;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                        patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0)) ) &amp;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                                  <span class="keywordflow">THEN</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                        </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(  patch_id, &amp;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                                                                     i,j,0)</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                        </div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    </div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            </div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            </div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#ab329077796ad7579df0a96543263150d">s_isentropic_vortex</a> <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        </div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3b4fe978231e74b699695a35fb544236">s_1d_analytical</a>(patch_id) <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a3b4fe978231e74b699695a35fb544236"> 1587</a></span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="comment">! Placeholders for the cell boundary values</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: a,b,c,d, pi_inf, gamma, lit_gamma</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            pi_inf = fluid_pp(1)%pi_inf</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            gamma = fluid_pp(1)%gamma</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            lit_gamma = (1d0+gamma)/gamma</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <span class="comment">! Transferring the patch&#39;s centroid and length information</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="comment">! Computing the beginning and the end x- and y-coordinates</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="comment">! of the patch based on its centroid and lengths</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="comment">! Since the patch doesn&#39;t allow for its boundaries to be</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to </span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="comment">! ensure that only the current patch contributes to the fluid</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="comment">! state in the cells that this patch covers.</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            </div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="comment">! Checking whether the line segment covers a particular cell in the</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the permission</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                <span class="keywordflow">IF</span>(             <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i) .AND.              &amp;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i) .AND.              &amp;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                     patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,0,0)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                   </div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,0,0)</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    <span class="comment">!what variables to alter</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    <span class="comment">!bump in pressure</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) * &amp;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                        ( 1d0 + 0.2d0*dexp(-1d0*((x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2.d0)/(2.d0*0.005d0)) )</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    <span class="comment">!bump in void fraction</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                    <span class="comment">!q_prim_vf(adv_idx%beg)%sf(i,0,0) = q_prim_vf(adv_idx%beg)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                    <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                    <span class="comment">!bump in R(x)</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                    <span class="comment">!q_prim_vf(adv_idx%end+1)%sf(i,0,0) = q_prim_vf(adv_idx%end+1)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                    <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                    <span class="comment">!IF (model_eqns == 4) THEN</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                        <span class="comment">!reassign density</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    <span class="comment">!IF (num_fluids == 1) THEN</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,0,0) = &amp;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                            (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                            rhoref*(1d0-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,0,0))</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    <span class="comment">!END IF</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                    <span class="comment">!ELSE IF (model_eqns == 2) THEN</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                        <span class="comment">!can manually adjust density here</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                        <span class="comment">!q_prim_vf(1)%sf(i,0,0) = q_prim_vf(1)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                        <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    <span class="comment">!END IF</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            </div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a3b4fe978231e74b699695a35fb544236">s_1d_analytical</a> <span class="comment">! --------------------------------------- </span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        </div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a7685befab45f10089fc46907fa4cc049">s_1d_bubble_pulse</a>(patch_id) <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01661"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a7685befab45f10089fc46907fa4cc049"> 1661</a></span>&#160;        <span class="comment">! Description: This patch assigns the primitive variables as analytical </span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="comment">!       functions such that the code can be verified. </span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="comment">! Patch identifier</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="comment">! Placeholders for the cell boundary values</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: fac, a,b,c,d, pi_inf, gamma, lit_gamma</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            pi_inf = fluid_pp(1)%pi_inf</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            gamma = fluid_pp(1)%gamma</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            lit_gamma = (1d0+gamma)/gamma</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            <span class="comment">! Transferring the patch&#39;s centroid and length information</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            <span class="comment">! Computing the beginning and the end x- and y-coordinates</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="comment">! of the patch based on its centroid and lengths</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="comment">! Since the patch doesn&#39;t allow for its boundaries to be</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to </span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;            <span class="comment">! ensure that only the current patch contributes to the fluid</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            <span class="comment">! state in the cells that this patch covers.</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            </div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="comment">! Checking whether the line segment covers a particular cell in the</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the permission</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                <span class="keywordflow">IF</span>(             <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i) .AND.              &amp;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i) .AND.              &amp;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                     patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,0,0)) ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                   </div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,0,0)</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                    <span class="comment">!what variables to alter</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                    <span class="comment">!sinusoid in pressure</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                    <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) * &amp;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                        ( 1d0 + 0.1d0*sin(-1d0*(x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)*2d0*pi/<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> ) )</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    <span class="comment">!bump in void fraction</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    <span class="comment">!q_prim_vf(adv_idx%beg)%sf(i,0,0) = q_prim_vf(adv_idx%beg)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                    <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                    <span class="comment">!bump in R(x)</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                    <span class="comment">!q_prim_vf(adv_idx%end+1)%sf(i,0,0) = q_prim_vf(adv_idx%end+1)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                    <span class="comment">!IF (model_eqns == 4) THEN</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                        <span class="comment">!reassign density</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                    <span class="comment">!IF (num_fluids == 1) THEN</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,0,0) = &amp;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                            (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,0,0) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                            rhoref*(1d0-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,0,0))</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                    <span class="comment">!END IF</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                    <span class="comment">!ELSE IF (model_eqns == 2) THEN</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                        <span class="comment">!can manually adjust density here</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                        <span class="comment">!q_prim_vf(1)%sf(i,0,0) = q_prim_vf(1)%sf(i,0,0) * &amp;</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                        <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                    <span class="comment">!END IF</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="keywordflow">                END IF</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            </div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a7685befab45f10089fc46907fa4cc049">s_1d_bubble_pulse</a> <span class="comment">! --------------------------------------- </span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a50f5727753c025d26925640a19259102">s_2d_analytical</a>(patch_id) <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01739"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a50f5727753c025d26925640a19259102"> 1739</a></span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: a,b,c,d</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf,gamma,lit_gamma</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            pi_inf = fluid_pp(1)%pi_inf</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            gamma = fluid_pp(1)%gamma</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            lit_gamma = (1d0+gamma)/gamma</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            </div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="comment">! Transferring the patch&#39;s centroid and length information</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a> = patch_icpp(patch_id)%length_y</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            <span class="comment">! Computing the beginning and the end x- and y-coordinates</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            <span class="comment">! of the patch based on its centroid and lengths</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="comment">! Since the patch doesn&#39;t allow for its boundaries to be</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to </span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            <span class="comment">! ensure that only the current patch contributes to the fluid</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="comment">! state in the cells that this patch covers.</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <span class="comment">! Checking whether the patch covers a particular cell in the </span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the </span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            <span class="comment">! permission to write to that cell. If both queries check out, </span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="comment">! the primitive variables of the current patch are assigned</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            <span class="comment">! to this cell.</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                    <span class="keywordflow">IF</span> (    <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i) .AND. &amp;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i) .AND. &amp;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg &lt;= y_cc(j) .AND. &amp;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end &gt;= y_cc(j) .AND. &amp;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                            patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,0))) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    </div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,0)</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        <span class="comment">!what variables to alter</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                        <span class="comment">!x-y bump in pressure</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        <span class="comment">!q_prim_vf(E_idx)%sf(i,j,0) = q_prim_vf(E_idx)%sf(i,j,0) * &amp;</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                        <span class="comment">!    ( 1d0 + 0.2d0*dexp(-1d0*((x_cb(i)-x_centroid)**2.d0 + (y_cb(j)-y_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                        <span class="comment">!x-bump</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,0) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,0) * &amp;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                            ( 1d0 + 0.2d0*dexp(-1d0*((x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2.d0)/(2.d0*0.005d0)) )</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                        <span class="comment">!bump in void fraction</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                        <span class="comment">!q_prim_vf(adv_idx%beg)%sf(i,j,0) = q_prim_vf(adv_idx%beg)%sf(i,j,0) * &amp;</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                        <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0 + (y_cb(j)-y_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                        <span class="comment">!bump in R(x)</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                        <span class="comment">!q_prim_vf(adv_idx%end+1)%sf(i,j,0) = q_prim_vf(adv_idx%end+1)%sf(i,j,0) * &amp;</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                        <span class="comment">!    ( 1d0 + 0.2d0*exp(-1d0*((x_cb(i)-x_centroid)**2.d0 + (y_cb(j)-y_centroid)**2.d0)/(2.d0*0.005d0)) )</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                        <span class="comment">!reassign density</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,j,0) = &amp;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                            (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,0) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                            rhoref*(1d0-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(alf_idx)%sf(i,j,0))</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                       </div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                       <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                        <span class="comment">! Sinusoidal initial condition for all flow variables =============================</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                        <span class="comment">! Cell-center values</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">!                        a = 0d0</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">!                        b = 0d0</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">!                        c = 0d0</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">!                        d = 0d0</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">!                        q_prim_vf(adv_idx%beg)%sf(i,j,0) = SIN(x_cc(i)) * SIN(y_cc(j))</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">!                        q_prim_vf(1)%sf(i,j,0) = q_prim_vf(adv_idx%beg)%sf(i,j,0) * 1d0</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">!                        q_prim_vf(cont_idx%end)%sf(i,j,0) = (1d0 - q_prim_vf(adv_idx%beg)%sf(i,j,0)) * 1d0</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">!                        q_prim_vf(mom_idx%beg)%sf(i,j,0) = SIN(x_cc(i))</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">!                        q_prim_vf(mom_idx%end)%sf(i,j,0) = SIN(y_cc(j))</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">!                        q_prim_vf(E_idx)%sf(i,j,0) = 1d0</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                        <span class="comment">! Cell-average values</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">!                       a = x_cc(i) - 5d-1*dx ! x-beg</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">!                       b = x_cc(i) + 5d-1*dx ! x-end</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">!                       c = y_cc(j) - 5d-1*dy ! y-beg</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">!                       d = y_cc(j) + 5d-1*dy ! y-end</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">!                       q_prim_vf(adv_idx%beg)%sf(i,j,0) = 1d0/((b-a)*(d-c)) * &amp;</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">!                               (COS(a)*COS(c) - COS(a)*COS(d) - COS(b)*COS(c) + COS(b)*COS(d))</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">!                       q_prim_vf(1)%sf(i,j,0) = q_prim_vf(adv_idx%beg)%sf(i,j,0) * 1d0</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment">!                       q_prim_vf(cont_idx%end)%sf(i,j,0) = (1d0 - q_prim_vf(adv_idx%beg)%sf(i,j,0)) * 1d0</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">!                       q_prim_vf(mom_idx%beg)%sf(i,j,0) = (COS(a) - COS(b))/(b-a)</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">!                       q_prim_vf(mom_idx%end)%sf(i,j,0) = (COS(c) - COS(d))/(d-c)</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">!                       q_prim_vf(E_idx)%sf(i,j,0) = 1d0</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                        <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        <span class="comment">! Initial pressure profile smearing for bubble collapse case of Tiwari (2013) ====</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                        <span class="comment">!IF((       (x_cc(i))**2d0                     &amp;</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                        <span class="comment">!         + (y_cc(j))**2d0 &lt;= 1d0**2d0)) THEN</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        <span class="comment">!         q_prim_vf(E_idx)%sf(i,j,0) = 1d5 / 25d0</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        <span class="comment">!ELSE</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        <span class="comment">!    q_prim_vf(E_idx)%sf(i,j,0) = 1d5 + 1d0/SQRT(x_cc(i)**2d0+y_cc(j)**2d0) &amp; </span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                        <span class="comment">!                                    * ((1d5/25d0) - 1d5)</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                        <span class="comment">!END IF</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                        <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="keywordflow">                    END IF</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="keywordflow">                END DO</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a50f5727753c025d26925640a19259102">s_2d_analytical</a> <span class="comment">! ---------------------------------------</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#abb87c531b4d42302dd22863b95a7cdb2">s_3d_analytical</a>(patch_id) <span class="comment">! ---------------------------------</span></div><div class="line"><a name="l01859"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#abb87c531b4d42302dd22863b95a7cdb2"> 1859</a></span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: pi_inf, gamma, lit_gamma</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            </div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            pi_inf = fluid_pp(1)%pi_inf</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            gamma = fluid_pp(1)%gamma</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            lit_gamma = (1d0+gamma)/gamma    </div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            <span class="comment">! Transferring the patch&#39;s centroid and length information</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>   = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a>   = patch_icpp(patch_id)%length_y</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a>   = patch_icpp(patch_id)%length_z</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            </div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="comment">! Computing the beginning and the end x-, y- and z-coordinates of</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="comment">! the patch based on its centroid and lengths</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            </div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            <span class="comment">! Since the analytical patch does not allow for its boundaries to get</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to make sure</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            </div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <span class="comment">! Checking whether the patch covers a particular cell in the domain</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <span class="comment">! to that cell. If both queries check out, the primitive variables</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            <span class="comment">! of the current patch are assigned to this cell.</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                     <span class="keywordflow">IF</span>(            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i)   .AND.            &amp;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i)   .AND.            &amp;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>    .AND.            &amp;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>    .AND.            &amp;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>    .AND.            &amp;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>                     &amp;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                                                .AND.                            &amp;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)))   &amp;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                                                <span class="keywordflow">THEN</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                        <span class="comment">!gaussian ball</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                        <span class="comment">!what variables to alter</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                        <span class="comment">!bump in pressure</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,k) * &amp;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                            ( 1d0 + 0.2d0*exp(-1d0 * &amp;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                            ((x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2.d0 + (y_cb(j)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2.d0 + (z_cb(k)-<a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2.d0) &amp;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                            /(2.d0*0.005d0)) )</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                        <span class="comment">!bump in void fraction</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(adv_idx%beg)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(adv_idx%beg)%sf(i,j,k) * &amp;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                            ( 1d0 + 0.2d0*exp(-1d0 * &amp;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                            ((x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2.d0 + (y_cb(j)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2.d0 + (z_cb(k)-<a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2.d0) &amp;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                            /(2.d0*0.005d0)) )</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                        <span class="comment">!bump in R(x)</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(adv_idx%end+1)%sf(i,j,k) = <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(adv_idx%end+1)%sf(i,j,k) * &amp;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                            ( 1d0 + 0.2d0*exp(-1d0 * &amp;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                            ((x_cb(i)-<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2.d0 + (y_cb(j)-<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2.d0 + (z_cb(k)-<a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2.d0) &amp;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                            /(2.d0*0.005d0)) )</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                        <span class="comment">!reassign density</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(1)%sf(i,j,k) = &amp;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                            (((<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx)%sf(i,j,k) + pi_inf)/(pref + pi_inf))**(1d0/lit_gamma)) * &amp;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                            rhoref*(1d0-<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(e_idx+1)%sf(i,j,k))</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                        <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                        <span class="comment">! Constant x-velocity in cylindrical grid ========================================</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment">!                        q_prim_vf(cont_idx%beg )%sf(i,j,k) = 1d0 </span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">!                        q_prim_vf(cont_idx%end )%sf(i,j,k) = 0d0</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">!                        q_prim_vf(mom_idx%beg  )%sf(i,j,k) = 0d0</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">!                        q_prim_vf(mom_idx%beg+1)%sf(i,j,k) = COS(z_cc(k))</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">!                        q_prim_vf(mom_idx%end  )%sf(i,j,k) = -SIN(z_cc(k))</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">!                        q_prim_vf(E_idx        )%sf(i,j,k) = 1d0</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">!                        q_prim_vf(adv_idx%beg  )%sf(i,j,k) = 1d0</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                        <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                        <span class="comment">! Couette flow in cylindrical grid ===============================================</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                        <span class="comment">!q_prim_vf(cont_idx%beg )%sf(i,j,k) = 1d0 </span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                        <span class="comment">!q_prim_vf(cont_idx%end )%sf(i,j,k) = 0d0</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                        <span class="comment">!q_prim_vf(mom_idx%beg  )%sf(i,j,k) = 0d0</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                        <span class="comment">!q_prim_vf(mom_idx%beg+1)%sf(i,j,k) = y_cc(j)*COS(z_cc(k))*SIN(z_cc(k))</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                        <span class="comment">!q_prim_vf(mom_idx%end  )%sf(i,j,k) = -y_cc(j)*SIN(z_cc(k))**2d0</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                        <span class="comment">!q_prim_vf(E_idx        )%sf(i,j,k) = 1d0</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                        <span class="comment">!q_prim_vf(adv_idx%beg  )%sf(i,j,k) = 1d0</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                        <span class="comment">! ================================================================================</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            </div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#abb87c531b4d42302dd22863b95a7cdb2">s_3d_analytical</a> <span class="comment">! ---------------------------------------</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#af17f90ba4a3878feb6e38bc8d66cb950">s_spherical_harmonic</a>(patch_id) <span class="comment">! ----------------------------</span></div><div class="line"><a name="l01981"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#af17f90ba4a3878feb6e38bc8d66cb950"> 1981</a></span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id </div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            </div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            <span class="keywordtype">COMPLEX(KIND(0d0))</span> :: cmplx_i = (0d0,1d0)</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <span class="keywordtype">COMPLEX(KIND(0d0))</span> :: H</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            </div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <span class="comment">! Transferring the patch&#39;s centroid and radius information</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>     = patch_icpp(patch_id)%radius</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>    = patch_icpp(patch_id)%epsilon</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a>       = patch_icpp(patch_id)%beta</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            </div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <span class="comment">! Since the analytical patch does not allow for its boundaries to get</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to make sure</span></div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            </div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            <span class="comment">! Checking whether the patch covers a particular cell in the domain</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="comment">! to that cell. If both queries check out, the primitive variables</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <span class="comment">! of the current patch are assigned to this cell.</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                     <span class="keywordflow">IF</span>((       (  x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                    &amp;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                              + (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0                    &amp;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                              + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0     &amp;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                                   .AND.                         &amp;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k))))  &amp;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                                                   <span class="keywordflow">THEN</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a88d2e8debdc097d4d811fb67d6fbc880">s_convert_cylindrical_to_spherical_coord</a>(x_cc(i),y_cc(j))</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                        <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a>  == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                                h = 5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1*sqrt(3d0/pi)*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                                h = -5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1*sqrt(3d0/(2d0*pi))*exp(cmplx_i*z_cc(k))*sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a> == 2d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                                h = 25<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-2*sqrt(5d0/pi)*(3d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 - 1d0)</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                                h = -5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1*sqrt(15d0/(2d0*pi))*exp(cmplx_i*z_cc(k))*sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 2d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                                h = 25<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-2*sqrt(15d0/(2d0*pi))*exp(2d0*cmplx_i*z_cc(k))*sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a> == 3d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                                h = 25<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-2*sqrt(7d0/pi)*(5d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0 - 3d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>))</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                                h = -125<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-3*sqrt(21d0/pi)*exp(cmplx_i*z_cc(k))*sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>) * &amp;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                                    (5d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 - 1d0)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 2d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                                h = 25<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-2*sqrt(105d0/(2d0*pi))*exp(2d0*cmplx_i*z_cc(k)) * &amp;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 3d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                h = -125<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-3*sqrt(35d0/pi)*exp(3d0*cmplx_i*z_cc(k))*sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a> == 4d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                h = 3d0/16d0*sqrt(1d0/pi)*(35d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**4d0 - &amp;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                                    3d1*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 + 3d0)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                                h = -3d0/8d0*sqrt(5d0/pi)*exp(cmplx_i*z_cc(k))* &amp;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)*(7d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0 - 3d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>))</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 2d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                                h = 3d0/8d0*sqrt(5d0/(2d0*pi))*exp(2d0*cmplx_i*z_cc(k))* &amp;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0*(7d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 - 1d0)</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 3d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                                h = -3d0/8d0*sqrt(35d0/pi)*exp(3d0*cmplx_i*z_cc(k))* &amp;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 4d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                                h = 3d0/16d0*sqrt(35d0/(2d0*pi))*exp(4d0*cmplx_i*z_cc(k))* &amp;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**4d0</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">epsilon</a> == 5d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                            <span class="keywordflow">IF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 0d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                h = 1d0/16d0*sqrt(11d0/pi)*(63d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**5d0 - &amp;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                    7d1*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0 + 15d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>))</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 1d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                                h = -1d0/16d0*sqrt(165d0/(2d0*pi))*exp(cmplx_i*z_cc(k))* &amp;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)*(21d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**4d0 - 14d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 + 1d0)</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 2d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                                h = 125<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-3*sqrt(1155d0/(2d0*pi))*exp(2d0*cmplx_i*z_cc(k)) * &amp;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0*(3d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0 - cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>))</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 3d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                                h = -1d0/32d0*sqrt(385d0/pi)*exp(3d0*cmplx_i*z_cc(k) )* &amp;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**3d0*(9d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**2d0 - 1d0)</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 4d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                h = 3d0/16d0*sqrt(385d0/(2d0*pi))*exp(4d0*cmplx_i*z_cc(k)) * &amp;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**4d0*cos(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">beta</a> == 5d0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                                h = -3d0/32d0*sqrt(77d0/pi)*exp(5d0*cmplx_i*z_cc(k)) * &amp;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                    sin(<a class="code" href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">sph_phi</a>)**5d0</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="keywordflow">                            END IF</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(adv_idx%beg)%sf(i,j,k) = 1d0-abs(<span class="keywordtype">REAL</span>(h,kind(0d0)))</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            </div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#af17f90ba4a3878feb6e38bc8d66cb950">s_spherical_harmonic</a> <span class="comment">! ----------------------------------</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a9037159f591341d05fa5fb23fe82bc2c">s_sphere</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l02110"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a9037159f591341d05fa5fb23fe82bc2c"> 2110</a></span>&#160;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            </div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            <span class="comment">! Generic loop iterators</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            <span class="keywordtype">REAL(KIND(0d0))</span> :: radius_pressure, pressure_bubble, pressure_inf</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            </div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            </div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            <span class="comment">! Transferring spherical patch&#39;s radius, centroid, smoothing patch</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <span class="comment">! identity and smoothing coefficient information</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>      = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            </div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            </div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="comment">! case that smoothing of the spherical patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            </div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            </div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            <span class="comment">! Checking whether the sphere covers a particular cell in the domain</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="comment">! that cell. If both queries check out, the primitive variables of</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <span class="comment">! the current patch are assigned to this cell.</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                     </div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                     <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                        </div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dy,dz) *  &amp;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                            ( sqrt( (  x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                                  + (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                  + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 ) &amp;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                  - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a> ) ) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                        </div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                     </div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                     <span class="keywordflow">IF</span>((       (  x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                    &amp;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                              + (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0                    &amp;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                              + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0     &amp;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                                                   .AND.                         &amp;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)))   &amp;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                                                   .OR.                          &amp;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                 <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)== <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>        )   &amp;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                                                   <span class="keywordflow">THEN</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                        </div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                        </div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                     <span class="comment">! Initialization of the pressure field that corresponds to the bubble-collapse </span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                     <span class="comment">!! test case found in Tiwari et al. (2013)</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                     <span class="comment">! radius_pressure = SQRT(x_cc(i)**2d0) ! 1D</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                     <span class="comment">! radius_pressure = SQRT(x_cc(i)**2d0 + cart_y**2d0) ! 2D</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                     <span class="comment">! radius_pressure = SQRT(x_cc(i)**2d0 + cart_y**2d0 + cart_z**2d0) ! 3D</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                     <span class="comment">! pressure_bubble = 1.E+04</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                     <span class="comment">! pressure_inf    = 1.E+05</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                     <span class="comment">! q_prim_vf(E_idx)%sf(i,j,k) = pressure_inf + radius / radius_pressure * (pressure_bubble - pressure_inf)</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                     <span class="comment">! </span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                     <span class="comment">! IF(       ((  x_cc(i) - x_centroid)**2d0                    &amp;</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                     <span class="comment">!          + (   cart_y - y_centroid)**2d0                    &amp;</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                     <span class="comment">!          + (   cart_z - z_centroid)**2d0) &lt;= radius**2d0)   &amp;</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                     <span class="comment">!                               THEN</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                     <span class="comment">!    </span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                     <span class="comment">!    q_prim_vf(E_idx)%sf(i,j,k) = pressure_bubble</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                     <span class="comment">!    </span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                     <span class="comment">! END IF</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            </div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            </div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a9037159f591341d05fa5fb23fe82bc2c">s_sphere</a> <span class="comment">! ----------------------------------------------</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        </div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        </div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a2297a9b98d2478b3594083197bd9b8b5">s_cuboid</a>(patch_id) <span class="comment">! ----------------------------------------</span></div><div class="line"><a name="l02212"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a2297a9b98d2478b3594083197bd9b8b5"> 2212</a></span>&#160;            </div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            </div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            </div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            </div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            <span class="comment">! Transferring the cuboid&#39;s centroid and length information</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>   = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a>   = patch_icpp(patch_id)%length_y</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a>   = patch_icpp(patch_id)%length_z</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            </div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            </div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            <span class="comment">! Computing the beginning and the end x-, y- and z-coordinates of</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="comment">! the cuboid based on its centroid and lengths</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            </div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            </div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="comment">! Since the cuboidal patch does not allow for its boundaries to get</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <span class="comment">! smoothed out, the pseudo volume fraction is set to 1 to make sure</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            <span class="comment">! that only the current patch contributes to the fluid state in the</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="comment">! cells that this patch covers.</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            </div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            </div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            <span class="comment">! Checking whether the cuboid covers a particular cell in the domain</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <span class="comment">! and verifying whether the current patch has permission to write to</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            <span class="comment">! to that cell. If both queries check out, the primitive variables</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            <span class="comment">! of the current patch are assigned to this cell.</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                     <span class="keywordflow">IF</span>(            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i)   .AND.            &amp;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i)   .AND.            &amp;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>    .AND.            &amp;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>    .AND.            &amp;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>    .AND.            &amp;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                                    <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>                     &amp;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                                                .AND.                            &amp;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)))   &amp;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                                                <span class="keywordflow">THEN</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                        </div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                        </div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            </div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            </div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a2297a9b98d2478b3594083197bd9b8b5">s_cuboid</a> <span class="comment">! ----------------------------------------------</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        </div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        </div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#af834c631376de6906fb6b002df70ce49">s_cylinder</a>(patch_id) <span class="comment">! --------------------------------------</span></div><div class="line"><a name="l02290"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#af834c631376de6906fb6b002df70ce49"> 2290</a></span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;            </div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            </div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            </div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="comment">! Transferring the cylindrical patch&#39;s centroid, length, radius,</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="comment">! smoothing patch identity and smoothing coefficient information</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>      = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>      = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>      = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a>        = patch_icpp(patch_id)%length_x</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a>        = patch_icpp(patch_id)%length_y</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a>        = patch_icpp(patch_id)%length_z</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>          = patch_icpp(patch_id)%radius</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>    = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            </div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            </div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="comment">! Computing the beginning and the end x-, y- and z-coordinates of</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            <span class="comment">! the cylinder based on its centroid and lengths</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> - 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end = <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> + 0.5d0*<a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            </div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            </div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="comment">! case that smearing of the cylindrical patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            </div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            </div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <span class="comment">! Checking whether the cylinder covers a particular cell in the</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="comment">! domain and verifying whether the current patch has the permission</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            <span class="comment">! to write to that cell. If both queries check out, the primitive</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            <span class="comment">! variables of the current patch are assigned to this cell.</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                     </div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                     <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                         </div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                         <span class="keywordflow">IF</span>(<a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> /= dflt_real) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dy,dz) *     &amp;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                                ( sqrt( (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                                      + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 ) &amp;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                                      - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a> ) ) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                        <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a> /= dflt_real) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dz) *   &amp;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                                ( sqrt( (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                    + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 ) &amp;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                                    - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a> ) ) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> / min(dx,dy) *   &amp;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                                ( sqrt( (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0   &amp;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                                    + (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0 ) &amp;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                                    - <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a> ) ) * (-0.5d0) + 0.5d0</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="keywordflow">                        END IF</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                        </div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                       </div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                     <span class="keywordflow">IF</span>((((                <a class="code" href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">length_x</a> /= dflt_real         .AND. &amp;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                            (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0                      &amp;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                          + (   <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0 .AND. &amp;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%beg &lt;= x_cc(i)       .AND. &amp;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">x_boundary</a>%end &gt;= x_cc(i)          )  &amp;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                                                   .OR.                        &amp;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                          (                <a class="code" href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">length_y</a> /= dflt_real         .AND. &amp;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                              (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                      &amp;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                          + (<a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> - <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0    .AND. &amp;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>        .AND. &amp;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">y_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a>           )  &amp;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                                                   .OR.                        &amp;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                          (                <a class="code" href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">length_z</a> /= dflt_real         .AND. &amp;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                              (x_cc(i) - <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a>)**2d0                      &amp;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                          + (   <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> - <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a>)**2d0 &lt;= <a class="code" href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">radius</a>**2d0 .AND. &amp;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%beg &lt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>        .AND. &amp;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                                         <a class="code" href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">z_boundary</a>%end &gt;= <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a>          ))  &amp;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                                                   .AND.                       &amp;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                          patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)))&amp;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                                                   .OR.                        &amp;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                                 <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)== <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>         )&amp;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                                                   <span class="keywordflow">THEN</span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                         </div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                        </div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                     </div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            </div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            </div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#af834c631376de6906fb6b002df70ce49">s_cylinder</a> <span class="comment">! --------------------------------------------</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        </div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        </div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a51f30d0a86584bdc757c22ebf7993e88">s_sweep_plane</a>(patch_id) <span class="comment">! -----------------------------------</span></div><div class="line"><a name="l02405"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a51f30d0a86584bdc757c22ebf7993e88"> 2405</a></span>&#160;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: patch_id</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            </div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="keywordtype">INTEGER</span> :: i,j,k</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            </div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <span class="comment">! Transferring the centroid information of the plane to be swept</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> = patch_icpp(patch_id)%x_centroid</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> = patch_icpp(patch_id)%y_centroid</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            <a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a> = patch_icpp(patch_id)%z_centroid</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a> = patch_icpp(patch_id)%smooth_patch_id</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a> = patch_icpp(patch_id)%smooth_coeff</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            </div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            </div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            <span class="comment">! Obtaining coefficients of the equation describing the sweep plane</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a> = patch_icpp(patch_id)%normal(1)</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a> = patch_icpp(patch_id)%normal(2)</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a> = patch_icpp(patch_id)%normal(3)</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            <a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a> = -<a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*<a class="code" href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">x_centroid</a> - <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*<a class="code" href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">y_centroid</a> - <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>*<a class="code" href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">z_centroid</a></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            </div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            </div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <span class="comment">! Initializing the pseudo volume fraction value to 1. The value will</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;            <span class="comment">! be modified as the patch is laid out on the grid, but only in the</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="comment">! case that smearing of the sweep plane patch&#39;s boundary is enabled.</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 1d0</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            </div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            </div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            <span class="comment">! Checking whether the region swept by the plane covers a particular</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            <span class="comment">! cell in the domain and verifying whether the current patch has the</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            <span class="comment">! permission to write to that cell. If both queries check out, the</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;            <span class="comment">! primitive variables of the current patch are written to this cell.</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            <span class="keywordflow">DO</span> k = 0, p</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;               <span class="keywordflow">DO</span> j = 0, n</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                  <span class="keywordflow">DO</span> i = 0, m</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                     </div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                     <span class="keywordflow">IF</span> (grid_geometry == 3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                         <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">s_convert_cylindrical_to_cartesian_coord</a>(y_cc(j),z_cc(k))</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> = y_cc(j)</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                         <a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> = z_cc(k)</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                     <span class="keywordflow">IF</span>(patch_icpp(patch_id)%smoothen) <span class="keywordflow">THEN</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                        <a class="code" href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">eta</a> = 5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1 + 5<a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a>-1*tanh( <a class="code" href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">smooth_coeff</a>/min(dx,dy,dz) &amp;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                                              *    ( <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*x_cc(i) +           &amp;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                                                     <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*<a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> +            &amp;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                                                     <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>*<a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> + <a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a> )        &amp;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                                              / sqrt(<a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>**2d0+<a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>**2d0+<a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>**2d0) )</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                     </div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                     <span class="keywordflow">IF</span>((     <a class="code" href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">a</a>*x_cc(i) + <a class="code" href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">b</a>*<a class="code" href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">cart_y</a> + <a class="code" href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">c</a>*<a class="code" href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">cart_z</a> + <a class="code" href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">d</a> &gt;= 0d0       &amp;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                                                  .AND.                        &amp;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                         patch_icpp(patch_id)%alter_patch(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k))) &amp;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                                                   .OR.                        &amp;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                                 <a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>(i,j,k)== <a class="code" href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">smooth_patch_id</a>        ) &amp;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                                                   <span class="keywordflow">THEN</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                        </div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                        <span class="keyword">CALL </span><a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a>(patch_id, i,j,k)</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                        </div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="keywordflow">                     END IF</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                     </div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="keywordflow">                  END DO</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="keywordflow">               END DO</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            </div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            </div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a51f30d0a86584bdc757c22ebf7993e88">s_sweep_plane</a> <span class="comment">! -----------------------------------------</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        </div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        </div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        </div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        </div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="keyword">        SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a944c63abd61afab021ab664246f80495">s_finalize_initial_condition_module</a>() <span class="comment">! ---------------------</span></div><div class="line"><a name="l02477"></a><span class="lineno"><a class="line" href="namespacem__initial__condition.html#a944c63abd61afab021ab664246f80495"> 2477</a></span>&#160;            </div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            <span class="keywordtype">INTEGER</span> :: i</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            </div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            </div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <span class="comment">! Dellocating the primitive and conservative variables</span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            <span class="keywordflow">DO</span> i = 1, sys_size</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>(i)%sf)</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>(i)%sf)</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="keywordflow">            END DO</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            </div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">q_prim_vf</a>)</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">q_cons_vf</a>)</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            </div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            </div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <span class="comment">! Deallocating the patch identities bookkeeping variable</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">patch_id_fp</a>)</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            </div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            </div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            <span class="comment">! Nullifying procedure pointer to the subroutine assigning either</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="comment">! the patch mixture or species primitive variables to a cell in the</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="comment">! computational domain</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            <a class="code" href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">s_assign_patch_primitive_variables</a> =&gt; null()</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            </div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            </div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="keyword">        END SUBROUTINE </span><a class="code" href="namespacem__initial__condition.html#a944c63abd61afab021ab664246f80495">s_finalize_initial_condition_module</a> <span class="comment">! -------------------</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        </div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        </div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacem__initial__condition.html">m_initial_condition</a></div><div class="ttc" id="namespacem__global__parameters_html_a3bde8cf1ea00471fcd005219c55e824e"><div class="ttname"><a href="namespacem__global__parameters.html#a3bde8cf1ea00471fcd005219c55e824e">m_global_parameters::fluid_rho</a></div><div class="ttdeci">real(kind(0d0)), dimension(num_fluids_max) fluid_rho</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00148">m_global_parameters.f90:148</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a334b440356a4353d073c43e68c2372da"><div class="ttname"><a href="namespacem__global__parameters.html#a334b440356a4353d073c43e68c2372da">m_global_parameters::v0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable v0</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00195">m_global_parameters.f90:195</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a3e1c1480513e75b444ce7a77ed0fe598"><div class="ttname"><a href="namespacem__initial__condition.html#a3e1c1480513e75b444ce7a77ed0fe598">m_initial_condition::s_varcircle</a></div><div class="ttdeci">subroutine s_varcircle(patch_id)</div><div class="ttdoc">The varcircle patch is a 2D geometry that may be used . It generatres an annulus. ...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01155">m_initial_condition.f90:1155</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a0014f6589f0b33ea2372c1d4b7f0c824"><div class="ttname"><a href="namespacem__initial__condition.html#a0014f6589f0b33ea2372c1d4b7f0c824">m_initial_condition::patch_id_fp</a></div><div class="ttdeci">integer, dimension(:,:,:), allocatable patch_id_fp</div><div class="ttdoc">Bookkepping variable used to track the patch identities (id) associated with each of the cells in the...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00123">m_initial_condition.f90:123</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a9037159f591341d05fa5fb23fe82bc2c"><div class="ttname"><a href="namespacem__initial__condition.html#a9037159f591341d05fa5fb23fe82bc2c">m_initial_condition::s_sphere</a></div><div class="ttdeci">subroutine s_sphere(patch_id)</div><div class="ttdoc">The spherical patch is a 3D geometry that may be used, for example, in creating a bubble or a droplet...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l02110">m_initial_condition.f90:2110</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aaf66843a6e051174a3cde0729daa1300"><div class="ttname"><a href="namespacem__initial__condition.html#aaf66843a6e051174a3cde0729daa1300">m_initial_condition::x_centroid</a></div><div class="ttdeci">real(kind(0d0)) x_centroid</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00092">m_initial_condition.f90:92</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a75d13cb7c7c4f88e8b532cf7e7dda498"><div class="ttname"><a href="namespacem__initial__condition.html#a75d13cb7c7c4f88e8b532cf7e7dda498">m_initial_condition::s_circle</a></div><div class="ttdeci">subroutine s_circle(patch_id)</div><div class="ttdoc">The circular patch is a 2D geometry that may be used, for example, in creating a bubble or a droplet...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01096">m_initial_condition.f90:1096</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a7685befab45f10089fc46907fa4cc049"><div class="ttname"><a href="namespacem__initial__condition.html#a7685befab45f10089fc46907fa4cc049">m_initial_condition::s_1d_bubble_pulse</a></div><div class="ttdeci">subroutine s_1d_bubble_pulse(patch_id)</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01661">m_initial_condition.f90:1661</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a2297a9b98d2478b3594083197bd9b8b5"><div class="ttname"><a href="namespacem__initial__condition.html#a2297a9b98d2478b3594083197bd9b8b5">m_initial_condition::s_cuboid</a></div><div class="ttdeci">subroutine s_cuboid(patch_id)</div><div class="ttdoc">The cuboidal patch is a 3D geometry that may be used, for example, in creating a solid boundary...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l02212">m_initial_condition.f90:2212</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ab59e590873d32a54651ac60af6b1a6e4"><div class="ttname"><a href="namespacem__initial__condition.html#ab59e590873d32a54651ac60af6b1a6e4">m_initial_condition::length_x</a></div><div class="ttdeci">real(kind(0d0)) length_x</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00093">m_initial_condition.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a90f36c0b74894ddd901534dd4efccfc8"><div class="ttname"><a href="namespacem__global__parameters.html#a90f36c0b74894ddd901534dd4efccfc8">m_global_parameters::perturb_sph_fluid</a></div><div class="ttdeci">integer perturb_sph_fluid</div><div class="ttdoc">Fluid to be perturbed with perturb_sph flag. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00147">m_global_parameters.f90:147</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7297abec8863ecabf95e24ebdae46a17"><div class="ttname"><a href="namespacem__global__parameters.html#a7297abec8863ecabf95e24ebdae46a17">m_global_parameters::fluid_pp</a></div><div class="ttdeci">type(physical_parameters), dimension(num_fluids_max) fluid_pp</div><div class="ttdoc">Database of the physical parameters of each of the fluids that is present in the flow. These include the stiffened gas equation of state parameters, the Reynolds numbers and the Weber numbers. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00180">m_global_parameters.f90:180</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a7db1a23566279bdbc7da68850c596c69"><div class="ttname"><a href="namespacem__global__parameters.html#a7db1a23566279bdbc7da68850c596c69">m_global_parameters::pi_inf_idx</a></div><div class="ttdeci">integer pi_inf_idx</div><div class="ttdoc">Index of liquid stiffness func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00133">m_global_parameters.f90:133</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a3b4fe978231e74b699695a35fb544236"><div class="ttname"><a href="namespacem__initial__condition.html#a3b4fe978231e74b699695a35fb544236">m_initial_condition::s_1d_analytical</a></div><div class="ttdeci">subroutine s_1d_analytical(patch_id)</div><div class="ttdoc">This patch assigns the primitive variables as analytical functions such that the code can be verified...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01587">m_initial_condition.f90:1587</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad7e05d3d526e5dfa14a74ffda890e63d"><div class="ttname"><a href="namespacem__global__parameters.html#ad7e05d3d526e5dfa14a74ffda890e63d">m_global_parameters::y_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable y_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00085">m_global_parameters.f90:85</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html"><div class="ttname"><a href="namespacem__global__parameters.html">m_global_parameters</a></div><div class="ttdoc">This module contains all of the parameters characterizing the computational domain, simulation algorithm, initial condition and the stiffened equation of state. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00037">m_global_parameters.f90:37</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a6bd15d72ae72d7c598bbc3b57cf0b90e"><div class="ttname"><a href="namespacem__initial__condition.html#a6bd15d72ae72d7c598bbc3b57cf0b90e">m_initial_condition::f_r</a></div><div class="ttdeci">real(kind(0d0)) function f_r(myth, offset, a)</div><div class="ttdoc">Archimedes spiral function. </div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01079">m_initial_condition.f90:1079</a></div></div>
<div class="ttc" id="structm__derived__types_1_1scalar__field_html"><div class="ttname"><a href="structm__derived__types_1_1scalar__field.html">m_derived_types::scalar_field</a></div><div class="ttdoc">Derived type annexing a scalar field (SF) </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00047">m_derived_types.f90:47</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_af692b3658ab0d7bcda937394fe3e2903"><div class="ttname"><a href="namespacem__initial__condition.html#af692b3658ab0d7bcda937394fe3e2903">m_initial_condition::d</a></div><div class="ttdeci">real(kind(0d0)) d</div><div class="ttdoc">When a line or a plane sweep patch geometry is employed, these variables represent the coefficients a...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00110">m_initial_condition.f90:110</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ad76c4758994b52559f478d251dc0cba5"><div class="ttname"><a href="namespacem__global__parameters.html#ad76c4758994b52559f478d251dc0cba5">m_global_parameters::nb</a></div><div class="ttdeci">integer nb</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00192">m_global_parameters.f90:192</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a485a360d73013d7bce1daa01df404534"><div class="ttname"><a href="namespacem__global__parameters.html#a485a360d73013d7bce1daa01df404534">m_global_parameters::rhoref</a></div><div class="ttdeci">real(kind(0d0)) rhoref</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a8a559b4d7a1e1e69f5e3b9ea0474e3fa"><div class="ttname"><a href="namespacem__initial__condition.html#a8a559b4d7a1e1e69f5e3b9ea0474e3fa">m_initial_condition::a</a></div><div class="ttdeci">real(kind(0d0)) a</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00110">m_initial_condition.f90:110</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_add70754fa3c57535e4bc79c012962dc6"><div class="ttname"><a href="namespacem__variables__conversion.html#add70754fa3c57535e4bc79c012962dc6">m_variables_conversion::s_convert_species_to_mixture_variables</a></div><div class="ttdeci">subroutine s_convert_species_to_mixture_variables(q_vf, j, k, l, rho, gamma, pi_inf)</div><div class="ttdoc">This subroutine is designed for the volume fraction model and provided a set of either conservative o...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00217">m_variables_conversion.f90:217</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a50f5727753c025d26925640a19259102"><div class="ttname"><a href="namespacem__initial__condition.html#a50f5727753c025d26925640a19259102">m_initial_condition::s_2d_analytical</a></div><div class="ttdeci">subroutine s_2d_analytical(patch_id)</div><div class="ttdoc">This patch assigns the primitive variables as analytical functions such that the code can be verified...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01739">m_initial_condition.f90:1739</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ac4540baa01372eb3df51b268769fa6fc"><div class="ttname"><a href="namespacem__initial__condition.html#ac4540baa01372eb3df51b268769fa6fc">m_initial_condition::s_spiral</a></div><div class="ttdeci">subroutine s_spiral(patch_id)</div><div class="ttdoc">The spiral patch is a 2D geometry that may be used, The geometry of the patch is well-defined when it...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01025">m_initial_condition.f90:1025</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a0932a1bcb9b0293f1368e204a8fda4b9"><div class="ttname"><a href="namespacem__initial__condition.html#a0932a1bcb9b0293f1368e204a8fda4b9">m_initial_condition::b</a></div><div class="ttdeci">real(kind(0d0)) b</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00110">m_initial_condition.f90:110</a></div></div>
<div class="ttc" id="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables_html"><div class="ttname"><a href="interfacem__initial__condition_1_1s__assign__patch__xxxxx__primitive__variables.html">m_initial_condition::s_assign_patch_xxxxx_primitive_variables</a></div><div class="ttdoc">Abstract interface to the two subroutines that assign the patch primitive variables, either mixture or species, depending on the subroutine, to a particular cell in the computational domain. </div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00073">m_initial_condition.f90:73</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5d234ed722013d06fbb2d1ee5f8aab56"><div class="ttname"><a href="namespacem__global__parameters.html#a5d234ed722013d06fbb2d1ee5f8aab56">m_global_parameters::cont_idx</a></div><div class="ttdeci">type(int_bounds_info) cont_idx</div><div class="ttdoc">Indexes of first &amp; last continuity eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00125">m_global_parameters.f90:125</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a791e5fa466dd15343882711c91bae63d"><div class="ttname"><a href="namespacem__initial__condition.html#a791e5fa466dd15343882711c91bae63d">m_initial_condition::s_convert_cylindrical_to_cartesian_coord</a></div><div class="ttdeci">subroutine s_convert_cylindrical_to_cartesian_coord(cyl_y, cyl_z)</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00852">m_initial_condition.f90:852</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a1f42c68f3b3d167616d52b7cf7a7d56a"><div class="ttname"><a href="namespacem__initial__condition.html#a1f42c68f3b3d167616d52b7cf7a7d56a">m_initial_condition::q_cons_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable q_cons_vf</div><div class="ttdoc">conservative variables </div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00088">m_initial_condition.f90:88</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a5e999ad19f23f5f2b059b80e49c0a086"><div class="ttname"><a href="namespacem__initial__condition.html#a5e999ad19f23f5f2b059b80e49c0a086">m_initial_condition::s_ellipse</a></div><div class="ttdeci">subroutine s_ellipse(patch_id)</div><div class="ttdoc">The elliptical patch is a 2D geometry. The geometry of the patch is well-defined when its centroid an...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01269">m_initial_condition.f90:1269</a></div></div>
<div class="ttc" id="namespacem__derived__types_html"><div class="ttname"><a href="namespacem__derived__types.html">m_derived_types</a></div><div class="ttdoc">This file contains the definitions of all of the custom-defined types used in the pre-process code...</div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00036">m_derived_types.f90:36</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a63d50d6771031b79117f2aba60e0cca3"><div class="ttname"><a href="namespacem__variables__conversion.html#a63d50d6771031b79117f2aba60e0cca3">m_variables_conversion::s_convert_primitive_to_conservative_variables</a></div><div class="ttdeci">subroutine s_convert_primitive_to_conservative_variables(q_prim_vf, q_cons_vf)</div><div class="ttdoc">Converts the primitive variables to the conservative ones. Used when initializing patches...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00409">m_variables_conversion.f90:409</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab73a1c5c3f6815695771323454db2a81"><div class="ttname"><a href="namespacem__global__parameters.html#ab73a1c5c3f6815695771323454db2a81">m_global_parameters::adv_idx</a></div><div class="ttdeci">type(int_bounds_info) adv_idx</div><div class="ttdoc">Indexes of first &amp; last advection eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00129">m_global_parameters.f90:129</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac040dbf547e6d5de8df08e864d8131e7"><div class="ttname"><a href="namespacem__global__parameters.html#ac040dbf547e6d5de8df08e864d8131e7">m_global_parameters::p</a></div><div class="ttdeci">integer p</div><div class="ttdoc">Number of cells in the x-, y- and z-coordinate directions. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00070">m_global_parameters.f90:70</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a99ba7e33a1870ac89386d376e0d20526"><div class="ttname"><a href="namespacem__global__parameters.html#a99ba7e33a1870ac89386d376e0d20526">m_global_parameters::dflt_real</a></div><div class="ttdeci">real(kind(0d0)), parameter dflt_real</div><div class="ttdoc">Default real value. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00055">m_global_parameters.f90:55</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_afef3f507e182798fcfd7aecc52878fc9"><div class="ttname"><a href="namespacem__initial__condition.html#afef3f507e182798fcfd7aecc52878fc9">m_initial_condition::s_perturb_sphere</a></div><div class="ttdeci">subroutine s_perturb_sphere()</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00870">m_initial_condition.f90:870</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ab329077796ad7579df0a96543263150d"><div class="ttname"><a href="namespacem__initial__condition.html#ab329077796ad7579df0a96543263150d">m_initial_condition::s_isentropic_vortex</a></div><div class="ttdeci">subroutine s_isentropic_vortex(patch_id)</div><div class="ttdoc">The isentropic vortex is a 2D geometry that may be used, for example, to generate an isentropic flow ...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01537">m_initial_condition.f90:1537</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_af451fa7762c859ef20552498fa6edb16"><div class="ttname"><a href="namespacem__global__parameters.html#af451fa7762c859ef20552498fa6edb16">m_global_parameters::alf_idx</a></div><div class="ttdeci">integer alf_idx</div><div class="ttdoc">Index of void fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00128">m_global_parameters.f90:128</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a224e30cb2d1e2e99f2c2c059a1227d49"><div class="ttname"><a href="namespacem__initial__condition.html#a224e30cb2d1e2e99f2c2c059a1227d49">m_initial_condition::cart_z</a></div><div class="ttdeci">real(kind(0d0)) cart_z</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00128">m_initial_condition.f90:128</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a2f0b96a5aef3925aa7e3cc816754e17e"><div class="ttname"><a href="namespacem__global__parameters.html#a2f0b96a5aef3925aa7e3cc816754e17e">m_global_parameters::num_fluids</a></div><div class="ttdeci">integer num_fluids</div><div class="ttdoc">Number of different fluids present in the flow. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00118">m_global_parameters.f90:118</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6a06981be6cdab78452a106009022aa4"><div class="ttname"><a href="namespacem__global__parameters.html#a6a06981be6cdab78452a106009022aa4">m_global_parameters::mass_v0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable mass_v0</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00205">m_global_parameters.f90:205</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a88d2e8debdc097d4d811fb67d6fbc880"><div class="ttname"><a href="namespacem__initial__condition.html#a88d2e8debdc097d4d811fb67d6fbc880">m_initial_condition::s_convert_cylindrical_to_spherical_coord</a></div><div class="ttdeci">subroutine s_convert_cylindrical_to_spherical_coord(cyl_x, cyl_y)</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00861">m_initial_condition.f90:861</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aaf315f1df492ccc9daaeee046f185bb5"><div class="ttname"><a href="namespacem__global__parameters.html#aaf315f1df492ccc9daaeee046f185bb5">m_global_parameters::x_cc</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable x_cc</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00085">m_global_parameters.f90:85</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ae83688439601a9ff9bad58f09357a721"><div class="ttname"><a href="namespacem__global__parameters.html#ae83688439601a9ff9bad58f09357a721">m_global_parameters::old_ic</a></div><div class="ttdeci">logical old_ic</div><div class="ttdoc">Use existing IC data. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00059">m_global_parameters.f90:59</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4dac2e4ead915635e0c6c33af87be01b"><div class="ttname"><a href="namespacem__global__parameters.html#a4dac2e4ead915635e0c6c33af87be01b">m_global_parameters::sys_size</a></div><div class="ttdeci">integer sys_size</div><div class="ttdoc">Number of unknowns in the system of equations. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00121">m_global_parameters.f90:121</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adc35ba450a192812db36f1d6659d64e6"><div class="ttname"><a href="namespacem__global__parameters.html#adc35ba450a192812db36f1d6659d64e6">m_global_parameters::mpp_lim</a></div><div class="ttdeci">logical mpp_lim</div><div class="ttdoc">Alpha limiter. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00120">m_global_parameters.f90:120</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a7ab7ae2808ac3b52319477860c6dbf80"><div class="ttname"><a href="namespacem__initial__condition.html#a7ab7ae2808ac3b52319477860c6dbf80">m_initial_condition::smooth_coeff</a></div><div class="ttdeci">real(kind(0d0)) smooth_coeff</div><div class="ttdoc">These variables are analogous in both meaning and use to the similarly named components in the ic_pat...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00097">m_initial_condition.f90:97</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a9c54a1e384e94493914688f9a2a2cf14"><div class="ttname"><a href="namespacem__initial__condition.html#a9c54a1e384e94493914688f9a2a2cf14">m_initial_condition::s_rectangle</a></div><div class="ttdeci">subroutine s_rectangle(patch_id)</div><div class="ttdoc">The rectangular patch is a 2D geometry that may be used, for example, in creating a solid boundary...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01402">m_initial_condition.f90:1402</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a6cf2e92cfc3b519fb6da6fe9e88fab31"><div class="ttname"><a href="namespacem__global__parameters.html#a6cf2e92cfc3b519fb6da6fe9e88fab31">m_global_parameters::model_eqns</a></div><div class="ttdeci">integer model_eqns</div><div class="ttdoc">Multicomponent flow model. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00117">m_global_parameters.f90:117</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a0d9d1bcde238177f0beb7684e252aa69"><div class="ttname"><a href="namespacem__initial__condition.html#a0d9d1bcde238177f0beb7684e252aa69">m_initial_condition::length_z</a></div><div class="ttdeci">real(kind(0d0)) length_z</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00093">m_initial_condition.f90:93</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a98ddabe1c45996064589ca24ce5d8fe3"><div class="ttname"><a href="namespacem__global__parameters.html#a98ddabe1c45996064589ca24ce5d8fe3">m_global_parameters::perturb_sph</a></div><div class="ttdeci">logical perturb_sph</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00146">m_global_parameters.f90:146</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9a425d1bd91d1765043adf8410b98bf7"><div class="ttname"><a href="namespacem__global__parameters.html#a9a425d1bd91d1765043adf8410b98bf7">m_global_parameters::bub_idx</a></div><div class="ttdeci">type(bub_bounds_info) bub_idx</div><div class="ttdoc">Indexes of first &amp; last bubble variable eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00131">m_global_parameters.f90:131</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aca427fa4af7501277f10bf96977a9766"><div class="ttname"><a href="namespacem__initial__condition.html#aca427fa4af7501277f10bf96977a9766">m_initial_condition::z_centroid</a></div><div class="ttdeci">real(kind(0d0)) z_centroid</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00092">m_initial_condition.f90:92</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aaae7053fde0b060e39db9f943f000389"><div class="ttname"><a href="namespacem__initial__condition.html#aaae7053fde0b060e39db9f943f000389">m_initial_condition::z_boundary</a></div><div class="ttdeci">type(bounds_info) z_boundary</div><div class="ttdoc">These variables combine the centroid and length parameters associated with a particular patch to yiel...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00103">m_initial_condition.f90:103</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4ecdedaf3db880f8d71dbefc816322f8"><div class="ttname"><a href="namespacem__global__parameters.html#a4ecdedaf3db880f8d71dbefc816322f8">m_global_parameters::gamma_idx</a></div><div class="ttdeci">integer gamma_idx</div><div class="ttdoc">Index of specific heat ratio func. eqn. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00132">m_global_parameters.f90:132</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a51a6afec0ff2f62c62b6cf86bd2c16e4"><div class="ttname"><a href="namespacem__initial__condition.html#a51a6afec0ff2f62c62b6cf86bd2c16e4">m_initial_condition::radius</a></div><div class="ttdeci">real(kind(0d0)) radius</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00094">m_initial_condition.f90:94</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a71a9905eff9a292e2fc61b0e25e47db0"><div class="ttname"><a href="namespacem__initial__condition.html#a71a9905eff9a292e2fc61b0e25e47db0">m_initial_condition::cart_y</a></div><div class="ttdeci">real(kind(0d0)) cart_y</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00128">m_initial_condition.f90:128</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a03d80b7b8ee41e5b16d996b46a605706"><div class="ttname"><a href="namespacem__initial__condition.html#a03d80b7b8ee41e5b16d996b46a605706">m_initial_condition::c</a></div><div class="ttdeci">real(kind(0d0)) c</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00110">m_initial_condition.f90:110</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_abcd86e737c47247631a1fb95c1764b00"><div class="ttname"><a href="namespacem__initial__condition.html#abcd86e737c47247631a1fb95c1764b00">m_initial_condition::x_boundary</a></div><div class="ttdeci">type(bounds_info) x_boundary</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00103">m_initial_condition.f90:103</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a44e267143646437278341b252110443b"><div class="ttname"><a href="namespacem__initial__condition.html#a44e267143646437278341b252110443b">m_initial_condition::eta</a></div><div class="ttdeci">real(kind(0d0)) eta</div><div class="ttdoc">In the case that smoothing of patch boundaries is enabled and the boundary between two adjacent patch...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00116">m_initial_condition.f90:116</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_adf36787dd781f2f28d1b49d06116c401"><div class="ttname"><a href="namespacem__initial__condition.html#adf36787dd781f2f28d1b49d06116c401">m_initial_condition::smooth_patch_id</a></div><div class="ttdeci">integer smooth_patch_id</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00096">m_initial_condition.f90:96</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_adfaf902b37292b91750274e26989e8e6"><div class="ttname"><a href="namespacem__global__parameters.html#adfaf902b37292b91750274e26989e8e6">m_global_parameters::logic_grid</a></div><div class="ttdeci">integer, dimension(:,:,:), allocatable logic_grid</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00210">m_global_parameters.f90:210</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a3151c58d3a628c7ac8aff34bce727867"><div class="ttname"><a href="namespacem__initial__condition.html#a3151c58d3a628c7ac8aff34bce727867">m_initial_condition::s_assign_patch_primitive_variables</a></div><div class="ttdeci">procedure(s_assign_patch_xxxxx_primitive_variables), pointer s_assign_patch_primitive_variables</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00134">m_initial_condition.f90:134</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac6ef72ca6aa7a22e60c864df25559892"><div class="ttname"><a href="namespacem__global__parameters.html#ac6ef72ca6aa7a22e60c864df25559892">m_global_parameters::e_idx</a></div><div class="ttdeci">integer e_idx</div><div class="ttdoc">Index of total energy equation. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00127">m_global_parameters.f90:127</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a0024bfbe15f4f49cb2a5a2c574d89e19"><div class="ttname"><a href="namespacem__initial__condition.html#a0024bfbe15f4f49cb2a5a2c574d89e19">m_initial_condition::s_assign_patch_species_primitive_variables</a></div><div class="ttdeci">subroutine s_assign_patch_species_primitive_variables(patch_id, j, k, l)</div><div class="ttdoc">This subroutine assigns the species primitive variables of the patch designated by the patch_id...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00528">m_initial_condition.f90:528</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aae2170af8a68c7dcdd91910aad867ef4"><div class="ttname"><a href="namespacem__global__parameters.html#aae2170af8a68c7dcdd91910aad867ef4">m_global_parameters::pref</a></div><div class="ttdeci">real(kind(0d0)) pref</div><div class="ttdoc">Reference parameters for Tait EOS. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00188">m_global_parameters.f90:188</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a293bc6a9ccf7a197d8a5f0cfc3988584"><div class="ttname"><a href="namespacem__global__parameters.html#a293bc6a9ccf7a197d8a5f0cfc3988584">m_global_parameters::mom_idx</a></div><div class="ttdeci">type(int_bounds_info) mom_idx</div><div class="ttdoc">Indexes of first &amp; last momentum eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00126">m_global_parameters.f90:126</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a49ed82b4f9548cd8166844888028c8cd"><div class="ttname"><a href="namespacem__initial__condition.html#a49ed82b4f9548cd8166844888028c8cd">m_initial_condition::length_y</a></div><div class="ttdeci">real(kind(0d0)) length_y</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00093">m_initial_condition.f90:93</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a6cef3dccb0374a24cb372bd7d4c0b43f"><div class="ttname"><a href="namespacem__initial__condition.html#a6cef3dccb0374a24cb372bd7d4c0b43f">m_initial_condition::y_centroid</a></div><div class="ttdeci">real(kind(0d0)) y_centroid</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00092">m_initial_condition.f90:92</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a0fb096d74052e49545e6ec72b3c2a114"><div class="ttname"><a href="namespacem__initial__condition.html#a0fb096d74052e49545e6ec72b3c2a114">m_initial_condition::epsilon</a></div><div class="ttdeci">real(kind(0d0)) epsilon</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00095">m_initial_condition.f90:95</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html_a589fffc2fe084855ea9e86935f1916b1"><div class="ttname"><a href="namespacem__variables__conversion.html#a589fffc2fe084855ea9e86935f1916b1">m_variables_conversion::s_convert_conservative_to_primitive_variables</a></div><div class="ttdeci">subroutine s_convert_conservative_to_primitive_variables(q_cons_vf, q_prim_vf)</div><div class="ttdoc">Converts the conservative variables to the primitive ones. </div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00298">m_variables_conversion.f90:298</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_af834c631376de6906fb6b002df70ce49"><div class="ttname"><a href="namespacem__initial__condition.html#af834c631376de6906fb6b002df70ce49">m_initial_condition::s_cylinder</a></div><div class="ttdeci">subroutine s_cylinder(patch_id)</div><div class="ttdoc">The cylindrical patch is a 3D geometry that may be used, for example, in setting up a cylindrical sol...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l02290">m_initial_condition.f90:2290</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html"><div class="ttname"><a href="namespacem__initial__condition.html">m_initial_condition</a></div><div class="ttdoc">This module provides a platform that is analagous to constructive solid geometry techniques and in th...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00046">m_initial_condition.f90:46</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a51f30d0a86584bdc757c22ebf7993e88"><div class="ttname"><a href="namespacem__initial__condition.html#a51f30d0a86584bdc757c22ebf7993e88">m_initial_condition::s_sweep_plane</a></div><div class="ttdeci">subroutine s_sweep_plane(patch_id)</div><div class="ttdoc">The swept plane patch is a 3D geometry that may be used, for example, in creating a solid boundary...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l02405">m_initial_condition.f90:2405</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ac72422e5f77149bd32cf0cfd01a36544"><div class="ttname"><a href="namespacem__global__parameters.html#ac72422e5f77149bd32cf0cfd01a36544">m_global_parameters::n</a></div><div class="ttdeci">integer n</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00069">m_global_parameters.f90:69</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1097b95561b65a9035e5f9218de577f9"><div class="ttname"><a href="namespacem__global__parameters.html#a1097b95561b65a9035e5f9218de577f9">m_global_parameters::pb0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable pb0</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00205">m_global_parameters.f90:205</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aa61b446189c2c88bb9261649f4b594b3"><div class="ttname"><a href="namespacem__initial__condition.html#aa61b446189c2c88bb9261649f4b594b3">m_initial_condition::beta</a></div><div class="ttdeci">real(kind(0d0)) beta</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00095">m_initial_condition.f90:95</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a524f37de8423b7943c22c5d105eda922"><div class="ttname"><a href="namespacem__initial__condition.html#a524f37de8423b7943c22c5d105eda922">m_initial_condition::s_ellipsoid</a></div><div class="ttdeci">subroutine s_ellipsoid(patch_id)</div><div class="ttdoc">The ellipsoidal patch is a 3D geometry. The geometry of the patch is well-defined when its centroid a...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01326">m_initial_condition.f90:1326</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_abb87c531b4d42302dd22863b95a7cdb2"><div class="ttname"><a href="namespacem__initial__condition.html#abb87c531b4d42302dd22863b95a7cdb2">m_initial_condition::s_3d_analytical</a></div><div class="ttdeci">subroutine s_3d_analytical(patch_id)</div><div class="ttdoc">This patch assigns the primitive variables as analytical functions such that the code can be verified...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01859">m_initial_condition.f90:1859</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a5e346daa48cf24534ceca2f656a57255"><div class="ttname"><a href="namespacem__global__parameters.html#a5e346daa48cf24534ceca2f656a57255">m_global_parameters::num_patches</a></div><div class="ttdeci">integer num_patches</div><div class="ttdoc">Number of patches composing initial condition. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00169">m_global_parameters.f90:169</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_ab5fc97fce88eefa124865cab08aa2250"><div class="ttname"><a href="namespacem__global__parameters.html#ab5fc97fce88eefa124865cab08aa2250">m_global_parameters::patch_icpp</a></div><div class="ttdeci">type(ic_patch_parameters), dimension(num_patches_max) patch_icpp</div><div class="ttdoc">Database of the initial condition patch parameters (icpp) for each of the patches employed in the con...</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00171">m_global_parameters.f90:171</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ab669c9fbfa80cdc9139ea45f293b7f49"><div class="ttname"><a href="namespacem__initial__condition.html#ab669c9fbfa80cdc9139ea45f293b7f49">m_initial_condition::y_boundary</a></div><div class="ttdeci">type(bounds_info) y_boundary</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00103">m_initial_condition.f90:103</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a944c63abd61afab021ab664246f80495"><div class="ttname"><a href="namespacem__initial__condition.html#a944c63abd61afab021ab664246f80495">m_initial_condition::s_finalize_initial_condition_module</a></div><div class="ttdeci">subroutine s_finalize_initial_condition_module()</div><div class="ttdoc">Deallocation procedures for the module. </div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l02477">m_initial_condition.f90:2477</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a585a72037bbffe12e8d4512a57f52418"><div class="ttname"><a href="namespacem__global__parameters.html#a585a72037bbffe12e8d4512a57f52418">m_global_parameters::r0</a></div><div class="ttdeci">real(kind(0d0)), dimension(:), allocatable r0</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00195">m_global_parameters.f90:195</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a8d670f2f984167bae71b7b3f12d0908a"><div class="ttname"><a href="namespacem__global__parameters.html#a8d670f2f984167bae71b7b3f12d0908a">m_global_parameters::polytropic</a></div><div class="ttdeci">logical polytropic</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00201">m_global_parameters.f90:201</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a07a665ff41297455ac2da7b54243bac5"><div class="ttname"><a href="namespacem__initial__condition.html#a07a665ff41297455ac2da7b54243bac5">m_initial_condition::s_initialize_initial_condition_module</a></div><div class="ttdeci">subroutine s_initialize_initial_condition_module()</div><div class="ttdoc">Computation of parameters, allocation procedures, and/or any other tasks needed to properly setup the...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00651">m_initial_condition.f90:651</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aa74a70029e3ec0fd3225b369e7c5443e"><div class="ttname"><a href="namespacem__initial__condition.html#aa74a70029e3ec0fd3225b369e7c5443e">m_initial_condition::s_generate_initial_condition</a></div><div class="ttdeci">subroutine s_generate_initial_condition()</div><div class="ttdoc">This subroutine peruses the patches and depending on the type of geometry associated with a particula...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00715">m_initial_condition.f90:715</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ad9935d4b9c2f6a7af08f3630681d0c1a"><div class="ttname"><a href="namespacem__initial__condition.html#ad9935d4b9c2f6a7af08f3630681d0c1a">m_initial_condition::q_prim_vf</a></div><div class="ttdeci">type(scalar_field), dimension(:), allocatable q_prim_vf</div><div class="ttdoc">primitive variables </div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00086">m_initial_condition.f90:86</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a9eb3789b90381530338a223c99cf1090"><div class="ttname"><a href="namespacem__global__parameters.html#a9eb3789b90381530338a223c99cf1090">m_global_parameters::internalenergies_idx</a></div><div class="ttdeci">type(int_bounds_info) internalenergies_idx</div><div class="ttdoc">Indexes of first &amp; last internal energy eqns. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00130">m_global_parameters.f90:130</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a2fa2c238e1c0c522aeecada3f6cc314d"><div class="ttname"><a href="namespacem__initial__condition.html#a2fa2c238e1c0c522aeecada3f6cc314d">m_initial_condition::alf_sum</a></div><div class="ttdeci">type(scalar_field) alf_sum</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00090">m_initial_condition.f90:90</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ab66e3b04024a8ae7327857b1b265bc27"><div class="ttname"><a href="namespacem__initial__condition.html#ab66e3b04024a8ae7327857b1b265bc27">m_initial_condition::s_perturb_surrounding_flow</a></div><div class="ttdeci">subroutine s_perturb_surrounding_flow()</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00922">m_initial_condition.f90:922</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_aee38c9d03e9195858a93ec611b605f33"><div class="ttname"><a href="namespacem__global__parameters.html#aee38c9d03e9195858a93ec611b605f33">m_global_parameters::m</a></div><div class="ttdeci">integer m</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00068">m_global_parameters.f90:68</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_add2d4033abdced8536200ef739ab379b"><div class="ttname"><a href="namespacem__global__parameters.html#add2d4033abdced8536200ef739ab379b">m_global_parameters::perturb_flow</a></div><div class="ttdeci">logical perturb_flow</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00144">m_global_parameters.f90:144</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aba65d4cbd29f3b8eda828037c7215e2d"><div class="ttname"><a href="namespacem__initial__condition.html#aba65d4cbd29f3b8eda828037c7215e2d">m_initial_condition::sph_phi</a></div><div class="ttdeci">real(kind(0d0)) sph_phi</div><div class="ttdoc">Variables to be used to hold cell locations in Cartesian coordinates if 3D simulation is using cylind...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00129">m_initial_condition.f90:129</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_a3be32c8ee8a7dffae734d063200471e8"><div class="ttname"><a href="namespacem__initial__condition.html#a3be32c8ee8a7dffae734d063200471e8">m_initial_condition::s_line_segment</a></div><div class="ttdeci">subroutine s_line_segment(patch_id)</div><div class="ttdoc">The line segment patch is a 1D geometry that may be used, for example, in creating a Riemann problem...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00968">m_initial_condition.f90:968</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a21765a90c01d221524670d1344b126cd"><div class="ttname"><a href="namespacem__global__parameters.html#a21765a90c01d221524670d1344b126cd">m_global_parameters::pi</a></div><div class="ttdeci">real(kind(0d0)), parameter pi</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00213">m_global_parameters.f90:213</a></div></div>
<div class="ttc" id="namespacem__variables__conversion_html"><div class="ttname"><a href="namespacem__variables__conversion.html">m_variables_conversion</a></div><div class="ttdoc">This module consists of subroutines used in the conversion of the conservative variables into the pri...</div><div class="ttdef"><b>Definition:</b> <a href="m__variables__conversion_8f90_source.html#l00038">m_variables_conversion.f90:38</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_abebd95d9d0271fbda40f47f75a2d829b"><div class="ttname"><a href="namespacem__global__parameters.html#abebd95d9d0271fbda40f47f75a2d829b">m_global_parameters::adv_alphan</a></div><div class="ttdeci">logical adv_alphan</div><div class="ttdoc">Advection of the last volume fraction. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00119">m_global_parameters.f90:119</a></div></div>
<div class="ttc" id="structm__derived__types_1_1bounds__info_html"><div class="ttname"><a href="structm__derived__types_1_1bounds__info.html">m_derived_types::bounds_info</a></div><div class="ttdoc">Derived type adding beginning (beg) and end bounds info as attributes. </div><div class="ttdef"><b>Definition:</b> <a href="m__derived__types_8f90_source.html#l00063">m_derived_types.f90:63</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ac414f08eb31dad32ed313767d214df72"><div class="ttname"><a href="namespacem__initial__condition.html#ac414f08eb31dad32ed313767d214df72">m_initial_condition::s_assign_patch_mixture_primitive_variables</a></div><div class="ttdeci">subroutine s_assign_patch_mixture_primitive_variables(patch_id, j, k, l)</div><div class="ttdoc">This subroutine assigns the mixture primitive variables of the patch designated by the patch_id...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00159">m_initial_condition.f90:159</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_af17f90ba4a3878feb6e38bc8d66cb950"><div class="ttname"><a href="namespacem__initial__condition.html#af17f90ba4a3878feb6e38bc8d66cb950">m_initial_condition::s_spherical_harmonic</a></div><div class="ttdeci">subroutine s_spherical_harmonic(patch_id)</div><div class="ttdoc">This patch generates the shape of the spherical harmonics as a perturbation to a perfect sphere...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01981">m_initial_condition.f90:1981</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_abd7cee461afabc01b81373e4be5a20c7"><div class="ttname"><a href="namespacem__initial__condition.html#abd7cee461afabc01b81373e4be5a20c7">m_initial_condition::s_assign_patch_species_primitive_variables_bubbles</a></div><div class="ttdeci">subroutine s_assign_patch_species_primitive_variables_bubbles(patch_id, j, k, l)</div><div class="ttdoc">This subroutine assigns the species primitive variables. This follows s_assign_patch_species_primitiv...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l00277">m_initial_condition.f90:277</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_aea2bf07e8890b1a108f2f891609174c9"><div class="ttname"><a href="namespacem__initial__condition.html#aea2bf07e8890b1a108f2f891609174c9">m_initial_condition::s_3dvarcircle</a></div><div class="ttdeci">subroutine s_3dvarcircle(patch_id)</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01208">m_initial_condition.f90:1208</a></div></div>
<div class="ttc" id="namespacem__initial__condition_html_ab056c04c30f55423904517abe61ebd99"><div class="ttname"><a href="namespacem__initial__condition.html#ab056c04c30f55423904517abe61ebd99">m_initial_condition::s_sweep_line</a></div><div class="ttdeci">subroutine s_sweep_line(patch_id)</div><div class="ttdoc">The swept line patch is a 2D geometry that may be used, for example, in creating a solid boundary...</div><div class="ttdef"><b>Definition:</b> <a href="m__initial__condition_8f90_source.html#l01476">m_initial_condition.f90:1476</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a1c242fb70db5a2c91c0997b37bcffd6a"><div class="ttname"><a href="namespacem__global__parameters.html#a1c242fb70db5a2c91c0997b37bcffd6a">m_global_parameters::perturb_flow_fluid</a></div><div class="ttdeci">integer perturb_flow_fluid</div><div class="ttdoc">Fluid to be perturbed with perturb_flow flag. </div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00145">m_global_parameters.f90:145</a></div></div>
<div class="ttc" id="namespacem__global__parameters_html_a4a22ed160838f8fbe6bd506f334b8815"><div class="ttname"><a href="namespacem__global__parameters.html#a4a22ed160838f8fbe6bd506f334b8815">m_global_parameters::bubbles</a></div><div class="ttdeci">logical bubbles</div><div class="ttdef"><b>Definition:</b> <a href="m__global__parameters_8f90_source.html#l00196">m_global_parameters.f90:196</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_218ca2ea05193636ddecee9f98bb8f51.html">pre_process_code</a></li><li class="navelem"><a class="el" href="m__initial__condition_8f90.html">m_initial_condition.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
